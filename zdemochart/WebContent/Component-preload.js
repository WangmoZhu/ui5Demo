/**
* This file was auto-generated by SAP Web IDE build and includes all
* the source files required by SAPUI5 runtime for performance optimization.
* PLEASE DO NOT EDIT THIS FILE!! Changes will be overwritten the next time the build is run.
*/
jQuery.sap.registerPreloadedModules({
	"version": "2.0",
	"name": "ZAPI_VIEW/Component-preload",
	"modules": {
		"ZAPI_VIEW/Component.js": "/* =========================================================== */\r\n/* App 公用组件控制器实现                                      */\r\n/* =========================================================== */\r\nsap.ui.define([\"sap/ui/core/UIComponent\",\r\n\t\t\t   \"sap/ui/model/resource/ResourceModel\",\r\n\t   \t       \"sap/ui/model/odata/v2/ODataModel\",\r\n\t\t\t   \"sap/ui/Device\",\r\n\t\t\t   \"./controller/messages\",\r\n\t\t\t   \"./model/models\"\r\n], function(UIComponent, ResourceModel, ODataModel, Device, messages, models) {\r\n\t// 严格JS 模式\r\n\t\"use strict\";\r\n\treturn UIComponent.extend(\"ZAPI_VIEW.Component\", {\r\n\t\t//---元数据\r\n\t\tmetadata : { \r\n\t\t\t// config : {fullWidth:true},\r\n\t\t\tmanifest:\"json\"\r\n\r\n\t\t},\r\n\r\n\t\t//---初始化方法\r\n\t\tinit : function() {\r\n\t        \r\n\t        // 设置设备模型\r\n\t\t\tthis.setModel(models.createDeviceModel(), \"device\");\r\n\t\t\t\r\n\t\t\t// 设置FLP模型\r\n\t\t\tthis.setModel(models.createFLPModel(), \"FLP\");\r\n        \t\r\n        \t// 设置FLP模型\r\n\t\t\tthis.setModel(models.createImage(), \"imageModel\");\r\n\t\t\t\r\n\t\t\t// 设置本地模型\r\n\t\t\tthis.setModel(models.createLocalModel());\r\n            \r\n            //---本地资源model路径获取\r\n\t\t\t//var sRootPath = jQuery.sap.getModulePath(\"ZTR18_3135_1010\");\r\n\t\t    //\tthis.setModel(models.createResourceModel(sRootPath, mConfig.resourceBundle), \"i18n\");\r\n\t\t\t//---页面跳转初始化\r\n\t\t\tUIComponent.prototype.init.apply(this, arguments);\r\n\t\t\tthis.getRouter().initialize();\r\n\t\t},\r\n\t\t\r\n\t\t// 退出后销毁事件\r\n\t\tdestroy : function() {\r\n\t\t\tthis.getModel().destroy();\r\n\t\t\tthis.getModel(\"i18n\").destroy();    // 本地测试注释\r\n\t\t\tthis.getModel(\"FLP\").destroy();     // 本地测试注释\r\n\t\t\tthis.getModel(\"device\").destroy();  // 本地测试注释\r\n\t\t\tthis.getModel(\"OData\").destroy();   // 本地测试注释\r\n\t\t\tUIComponent.prototype.destroy.apply(this, arguments);\r\n\t\t}\r\n\t}); \r\n});",
		"ZAPI_VIEW/view/view5.view.xml": "<mvc:View xmlns:mvc=\"sap.ui.core.mvc\" xmlns:table=\"sap.ui.table\" xmlns:unified=\"sap.ui.unified\" xmlns=\"sap.m\"\r\n\txmlns:custom=\"http://schemas.sap.com/sapui5/extension/sap.ui.core.CustomData/1\" controllerName=\"ZAPI_VIEW.controller.view5\"\r\n\tdisplayBlock=\"true\">\r\n\t<App>\r\n\t\t<pages>\r\n\t\t\t<Page title=\"人脸识别\">\r\n\t\t\t\t<content>\r\n\t\t\t\t\t<Image src=\"{/image5Set/np_table/0/Image}\" densityAware=\"false\" width=\"100%\"></Image>\r\n\t\t\t\t</content>\r\n\t\t\t\t<footer>\r\n\t\t\t\t\t<Toolbar width=\"100%\">\r\n\t\t\t\t\t\t<content>\r\n\t\t\t\t\t\t\t<unified:FileUploader buttonOnly=\"true\" buttonText=\"上传识别 \" sameFilenameAllowed=\"true\" multiple=\"true\" id=\"fileUploader\"\r\n\t\t\t\t\t\t\t\tfileType=\"zip,png,jpeg,jpg,bmp,tiff,tif\" icon=\"{imageModel>/path}/camera.png\"\r\n\t\t\t\t\t\t\t\tmimeType=\"application/x-zip-compressed,application/zip,application/octet-stream,image/png,image/jpg,image/jpeg,image/bmp,image/tiff\"\r\n\t\t\t\t\t\t\t\ttypeMissmatch=\"fileTypeMissmatch\" change=\"onPressImagehuawer\" custom:mode=\"xhr\"></unified:FileUploader>\r\n\t\t\t\t\t\t</content>\r\n\t\t\t\t\t</Toolbar>\r\n\t\t\t\t</footer>\r\n\t\t\t</Page>\r\n\t\t</pages>\r\n\t</App>\r\n</mvc:View>",
		"ZAPI_VIEW/view/view2.view.xml": "<mvc:View xmlns:mvc=\"sap.ui.core.mvc\" xmlns:table=\"sap.ui.table\" xmlns:unified=\"sap.ui.unified\" xmlns=\"sap.m\" xmlns:f=\"sap.ui.layout.form\"\r\n\txmlns:l=\"sap.ui.layout\" xmlns:core=\"sap.ui.core\" xmlns:custom=\"http://schemas.sap.com/sapui5/extension/sap.ui.core.CustomData/1\"\r\n\tcontrollerName=\"ZAPI_VIEW.controller.view2\" displayBlock=\"true\">\r\n\t<App>\r\n\t\t<pages>\r\n\t\t\t<Page title=\"送货单扫描\">\r\n\t\t\t\t<content>\r\n\t\t\t\t\t<!--\t<ScrollContainer height=\"50%\" width=\"50%\" horizontal=\"true\" vertical=\"true\" focusable=\"true\">\r\n\t\t\t\t\t\t<Image src=\"{/image3Set/np_table/0/Image}\" densityAware=\"false\" width=\"100%\"></Image>\r\n\t\t\t\t\t</ScrollContainer>-->\r\n\t\t\t\t\t<!--\t\t\t\t\t<Panel expandable=\"true\" expanded=\"true\" headerText=\"抬头\" width=\"auto\">\r\n\t\t\t\t\t\t<f:Form editable=\"true\">\r\n\t\t\t\t\t\t\t<f:layout>\r\n\t\t\t\t\t\t\t\t<f:ResponsiveGridLayout labelSpanL=\"4\" labelSpanM=\"4\" emptySpanL=\"1\" emptySpanM=\"1\" columnsL=\"2\" columnsM=\"2\"/>\r\n\t\t\t\t\t\t\t</f:layout>\r\n\t\t\t\t\t\t\t<f:formContainers>\r\n\t\t\t\t\t\t\t\t<f:FormContainer>\r\n\t\t\t\t\t\t\t\t\t<f:formElements>\r\n\t\t\t\t\t\t\t\t\t\t<f:FormElement>\r\n\t\t\t\t\t\t\t\t\t\t\t<f:fields>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<l:HorizontalLayout>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Label text=\"公司名称:\" width=\"6em\"/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Text text=\"{/recognitionSet/Type}\"/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</l:HorizontalLayout>\r\n\t\t\t\t\t\t\t\t\t\t\t</f:fields>\r\n\t\t\t\t\t\t\t\t\t\t</f:FormElement>\r\n\t\t\t\t\t\t\t\t\t\t<f:FormElement>\r\n\t\t\t\t\t\t\t\t\t\t\t<f:fields>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<l:HorizontalLayout>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Label text=\"电话:\" width=\"6em\"/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Text text=\"{/recognitionSet/CheckCode}\"/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</l:HorizontalLayout>\r\n\t\t\t\t\t\t\t\t\t\t\t</f:fields>\r\n\t\t\t\t\t\t\t\t\t\t</f:FormElement>\r\n\t\t\t\t\t\t\t\t\t\t<f:FormElement>\r\n\t\t\t\t\t\t\t\t\t\t\t<f:fields>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<l:HorizontalLayout>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Label text=\"收货单位:\" width=\"6em\"/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Text text=\"{/recognitionSet/IssueDate}\"/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</l:HorizontalLayout>\r\n\t\t\t\t\t\t\t\t\t\t\t</f:fields>\r\n\t\t\t\t\t\t\t\t\t\t</f:FormElement>\r\n\t\t\t\t\t\t\t\t\t\t<f:FormElement>\r\n\t\t\t\t\t\t\t\t\t\t\t<f:fields>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<l:HorizontalLayout>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Label text=\"日期:\" width=\"6em\"/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Text text=\"{/recognitionSet/SubtotalAmount}\"/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</l:HorizontalLayout>\r\n\t\t\t\t\t\t\t\t\t\t\t</f:fields>\r\n\t\t\t\t\t\t\t\t\t\t</f:FormElement>\r\n\t\t\t\t\t\t\t\t\t\t<f:FormElement>\r\n\t\t\t\t\t\t\t\t\t\t\t<f:fields>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<l:HorizontalLayout>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Label text=\"金额合计:\" width=\"6em\"/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Text text=\"{/recognitionSet/Total}\"/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</l:HorizontalLayout>\r\n\t\t\t\t\t\t\t\t\t\t\t</f:fields>\r\n\t\t\t\t\t\t\t\t\t\t</f:FormElement>\r\n\t\t\t\t\t\t\t\t\t</f:formElements>\r\n\t\t\t\t\t\t\t\t</f:FormContainer>\r\n\t\t\t\t\t\t\t\t<f:FormContainer>\r\n\t\t\t\t\t\t\t\t\t<f:FormElement>\r\n\t\t\t\t\t\t\t\t\t\t<f:fields>\r\n\t\t\t\t\t\t\t\t\t\t\t<l:HorizontalLayout>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<Label text=\"地址:\" width=\"6em\"/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<Text text=\"{/recognitionSet/Code}\"/>\r\n\t\t\t\t\t\t\t\t\t\t\t</l:HorizontalLayout>\r\n\t\t\t\t\t\t\t\t\t\t</f:fields>\r\n\t\t\t\t\t\t\t\t\t</f:FormElement>\r\n\t\t\t\t\t\t\t\t\t<f:FormElement>\r\n\t\t\t\t\t\t\t\t\t\t<f:fields>\r\n\t\t\t\t\t\t\t\t\t\t\t<l:HorizontalLayout>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<Label text=\"传真:\" width=\"6em\"/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<Text text=\"{/recognitionSet/Number}\"/>\r\n\t\t\t\t\t\t\t\t\t\t\t</l:HorizontalLayout>\r\n\t\t\t\t\t\t\t\t\t\t</f:fields>\r\n\t\t\t\t\t\t\t\t\t</f:FormElement>\r\n\t\t\t\t\t\t\t\t\t<f:FormElement>\r\n\t\t\t\t\t\t\t\t\t\t<f:fields>\r\n\t\t\t\t\t\t\t\t\t\t\t<l:HorizontalLayout>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<Label text=\"联系地址:\" width=\"6em\"/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<Text text=\"{/recognitionSet/EncryptionBlock}\"/>\r\n\t\t\t\t\t\t\t\t\t\t\t</l:HorizontalLayout>\r\n\t\t\t\t\t\t\t\t\t\t</f:fields>\r\n\t\t\t\t\t\t\t\t\t</f:FormElement>\r\n\t\t\t\t\t\t\t\t\t<f:FormElement>\r\n\t\t\t\t\t\t\t\t\t\t<f:fields>\r\n\t\t\t\t\t\t\t\t\t\t\t<l:HorizontalLayout>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<Label text=\"联系电话:\" width=\"6em\"/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<Text text=\"{/recognitionSet/SubtotalTax}\"/>\r\n\t\t\t\t\t\t\t\t\t\t\t</l:HorizontalLayout>\r\n\t\t\t\t\t\t\t\t\t\t</f:fields>\r\n\t\t\t\t\t\t\t\t\t</f:FormElement>\r\n\t\t\t\t\t\t\t\t</f:FormContainer>\r\n\t\t\t\t\t\t\t</f:formContainers>\r\n\t\t\t\t\t\t</f:Form>\r\n\t\t\t\t\t</Panel>-->\r\n\t\t\t\t\t<f:Form editable=\"true\">\r\n\t\t\t\t\t\t<f:layout>\r\n\t\t\t\t\t\t\t<f:ResponsiveGridLayout labelSpanL=\"4\" labelSpanM=\"4\" emptySpanL=\"1\" emptySpanM=\"1\" columnsL=\"2\" columnsM=\"2\"/>\r\n\t\t\t\t\t\t</f:layout>\r\n\t\t\t\t\t\t<f:formContainers>\r\n\t\t\t\t\t\t\t<f:FormContainer>\r\n\t\t\t\t\t\t\t\t<f:formElements>\r\n\t\t\t\t\t\t\t\t\t<f:FormElement>\r\n\t\t\t\t\t\t\t\t\t\t<f:fields>\r\n\t\t\t\t\t\t\t\t\t\t\t<l:HorizontalLayout>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<Label text=\"供应商名称:\" width=\"6em\"/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<Text text=\"{/recognitionSet/Name1}\"/>\r\n\t\t\t\t\t\t\t\t\t\t\t</l:HorizontalLayout>\r\n\t\t\t\t\t\t\t\t\t\t</f:fields>\r\n\t\t\t\t\t\t\t\t\t</f:FormElement>\r\n\t\t\t\t\t\t\t\t</f:formElements>\r\n\t\t\t\t\t\t\t</f:FormContainer>\r\n\t\t\t\t\t\t</f:formContainers>\r\n\t\t\t\t\t</f:Form>\r\n\t\t\t\t\t<!--<Panel expandable=\"true\" expanded=\"true\" headerText=\"明细\" width=\"auto\">-->\r\n\t\t\t\t\t<Table items=\"{/recognitionSet/np_recognitionitem}\" selectionMode=\"Single\" visibleRowCount=\"5\" id=\"Table1\">\r\n\t\t\t\t\t\t<columns>\r\n\t\t\t\t\t\t\t<!--\t\t\t\t\t\t\t\t<Column hAlign=\"Center\" vAlign=\"Center\">\r\n\t\t\t\t\t\t\t\t\t<Text text=\"序号\"/>\r\n\t\t\t\t\t\t\t\t</Column>-->\r\n\t\t\t\t\t\t\t<Column hAlign=\"Center\" vAlign=\"Center\">\r\n\t\t\t\t\t\t\t\t<Text text=\"物料名称\"/>\r\n\t\t\t\t\t\t\t</Column>\r\n\t\t\t\t\t\t\t<!--\t\t\t\t\t\t\t\t<Column hAlign=\"Center\" vAlign=\"Center\">\r\n\t\t\t\t\t\t\t\t\t<Text text=\"规格\"/>\r\n\t\t\t\t\t\t\t\t</Column>-->\r\n\t\t\t\t\t\t\t<Column  hAlign=\"Center\" vAlign=\"Center\">\r\n\t\t\t\t\t\t\t\t<Text text=\"单位\"/>\r\n\t\t\t\t\t\t\t</Column>\r\n\t\t\t\t\t\t\t<Column  hAlign=\"Center\" vAlign=\"Center\">\r\n\t\t\t\t\t\t\t\t<Text text=\"数量\"/>\r\n\t\t\t\t\t\t\t</Column>\r\n\t\t\t\t\t\t\t<!--\t\t\t\t\t\t\t\t<Column minScreenWidth=\"Tablet\" demandPopin=\"true\" popinDisplay=\"Inline\">\r\n\t\t\t\t\t\t\t\t\t<Text text=\"单价\"/>\r\n\t\t\t\t\t\t\t\t</Column>\r\n\t\t\t\t\t\t\t\t<Column minScreenWidth=\"Tablet\" demandPopin=\"true\" popinDisplay=\"Inline\">\r\n\t\t\t\t\t\t\t\t\t<Text text=\"金额\"/>\r\n\t\t\t\t\t\t\t\t</Column>\r\n\t\t\t\t\t\t\t\t<Column minScreenWidth=\"Tablet\" demandPopin=\"true\" popinDisplay=\"Inline\">\r\n\t\t\t\t\t\t\t\t\t<Text text=\"备注\"/>\r\n\t\t\t\t\t\t\t\t</Column>-->\r\n\t\t\t\t\t\t</columns>\r\n\t\t\t\t\t\t<items>\r\n\t\t\t\t\t\t\t<ColumnListItem>\r\n\t\t\t\t\t\t\t\t<cells>\r\n\t\t\t\t\t\t\t\t\t<Text text=\"{Maktx}\"/>\r\n\t\t\t\t\t\t\t\t\t<Text text=\"{Meins}\"/>\r\n\t\t\t\t\t\t\t\t\t<Text text=\"{Menge}\"/>\r\n\t\t\t\t\t\t\t\t\t<!--\t\t\t\t\t\t\t\t\t\t<Text text=\"{ZminPr}\"/>\r\n\t\t\t\t\t\t\t\t\t\t<Text text=\"{Zkykc}\"/>\r\n\t\t\t\t\t\t\t\t\t\t<Text text=\"{ZjckcDes}\"/>\r\n\t\t\t\t\t\t\t\t\t\t<Text text=\"{Zrjxl}\"/>\r\n\t\t\t\t\t\t\t\t\t\t<Text text=\"{SZzppnum}\"/>-->\r\n\t\t\t\t\t\t\t\t</cells>\r\n\t\t\t\t\t\t\t</ColumnListItem>\r\n\t\t\t\t\t\t</items>\r\n\t\t\t\t\t</Table>\r\n\t\t\t\t\t<!--\t\t\t\t\t\t<table:Table rows=\"{/recognitionSet/np_invoiceinvoice_item/}\" enableBusyIndicator=\"true\" selectionMode=\"Single\" visibleRowCount=\"5\">\r\n\t\t\t\t\t\t\t<table:columns>\r\n\t\t\t\t\t\t\t\t<table:Column sortProperty=\"label\" filterProperty=\"label\">\r\n\t\t\t\t\t\t\t\t\t<Label text=\"货物或应税劳务、服务名称\"/>\r\n\t\t\t\t\t\t\t\t\t<table:template>\r\n\t\t\t\t\t\t\t\t\t\t<Text text=\"{Name}\"/>\r\n\t\t\t\t\t\t\t\t\t</table:template>\r\n\t\t\t\t\t\t\t\t</table:Column>\r\n\t\t\t\t\t\t\t\t<table:Column sortProperty=\"\" filterProperty=\"\">\r\n\t\t\t\t\t\t\t\t\t<Label text=\"规格型号\"/>\r\n\t\t\t\t\t\t\t\t\t<table:template>\r\n\t\t\t\t\t\t\t\t\t\t<Text text=\"{Specification}\"/>\r\n\t\t\t\t\t\t\t\t\t</table:template>\r\n\t\t\t\t\t\t\t\t</table:Column>\r\n\t\t\t\t\t\t\t\t<table:Column sortProperty=\"\" filterProperty=\"\">\r\n\t\t\t\t\t\t\t\t\t<Label text=\"单位\"/>\r\n\t\t\t\t\t\t\t\t\t<table:template>\r\n\t\t\t\t\t\t\t\t\t\t<Text text=\"{Unit}\"/>\r\n\t\t\t\t\t\t\t\t\t</table:template>\r\n\t\t\t\t\t\t\t\t</table:Column>\r\n\t\t\t\t\t\t\t\t<table:Column sortProperty=\"\" filterProperty=\"\">\r\n\t\t\t\t\t\t\t\t\t<Label text=\"数量\"/>\r\n\t\t\t\t\t\t\t\t\t<table:template>\r\n\t\t\t\t\t\t\t\t\t\t<Text text=\"{Quantity}\"/>\r\n\t\t\t\t\t\t\t\t\t</table:template>\r\n\t\t\t\t\t\t\t\t</table:Column>\r\n\t\t\t\t\t\t\t\t<table:Column sortProperty=\"\" filterProperty=\"\">\r\n\t\t\t\t\t\t\t\t\t<Label text=\"单价\"/>\r\n\t\t\t\t\t\t\t\t\t<table:template>\r\n\t\t\t\t\t\t\t\t\t\t<Text text=\"{UnitPrice}\"/>\r\n\t\t\t\t\t\t\t\t\t</table:template>\r\n\t\t\t\t\t\t\t\t</table:Column>\r\n\t\t\t\t\t\t\t\t<table:Column sortProperty=\"\" filterProperty=\"\">\r\n\t\t\t\t\t\t\t\t\t<Label text=\"金额\"/>\r\n\t\t\t\t\t\t\t\t\t<table:template>\r\n\t\t\t\t\t\t\t\t\t\t<Text text=\"{Amount}\"/>\r\n\t\t\t\t\t\t\t\t\t</table:template>\r\n\t\t\t\t\t\t\t\t</table:Column>\r\n\t\t\t\t\t\t\t\t<table:Column sortProperty=\"\" filterProperty=\"\">\r\n\t\t\t\t\t\t\t\t\t<Label text=\"税率\"/>\r\n\t\t\t\t\t\t\t\t\t<table:template>\r\n\t\t\t\t\t\t\t\t\t\t<Text text=\"{TaxRate}\"/>\r\n\t\t\t\t\t\t\t\t\t</table:template>\r\n\t\t\t\t\t\t\t\t</table:Column>\r\n\t\t\t\t\t\t\t\t<table:Column sortProperty=\"\" filterProperty=\"\">\r\n\t\t\t\t\t\t\t\t\t<Label text=\"税额\"/>\r\n\t\t\t\t\t\t\t\t\t<table:template>\r\n\t\t\t\t\t\t\t\t\t\t<Text text=\"{Tax}\"/>\r\n\t\t\t\t\t\t\t\t\t</table:template>\r\n\t\t\t\t\t\t\t\t</table:Column>\r\n\t\t\t\t\t\t\t</table:columns>\r\n\t\t\t\t\t\t</table:Table>-->\r\n\t\t\t\t\t<!--</Panel>-->\r\n\t\t\t\t</content>\r\n\t\t\t\t<footer>\r\n\t\t\t\t\t<Bar>\r\n\t\t\t\t\t\t<contentLeft>\r\n\t\t\t\t\t\t\t<unified:FileUploader buttonOnly=\"true\" buttonText=\"上传送货单\" sameFilenameAllowed=\"true\" multiple=\"true\" id=\"fileUploader\"\r\n\t\t\t\t\t\t\t\tfileType=\"zip,png,jpeg,jpg,bmp,tiff,tif\" icon=\"{imageModel>/path}/camera.png\"\r\n\t\t\t\t\t\t\t\tmimeType=\"application/x-zip-compressed,application/zip,application/octet-stream,image/png,image/jpg,image/jpeg,image/bmp,image/tiff\"\r\n\t\t\t\t\t\t\t\ttypeMissmatch=\"fileTypeMissmatch\" change=\"onPressImagehuawer\" custom:mode=\"xhr\"></unified:FileUploader>\r\n\t\t\t\t\t\t</contentLeft>\r\n\t\t\t\t\t\t<contentRight>\r\n\t\t\t\t\t\t\t<Button width=\"8em\" text=\"过账 \" type=\"Emphasized\" visible=\"true\" press=\"opPressPost\" level=\"H2\"/>\r\n\t\t\t\t\t\t\t<!--<Button width=\"8em\" text=\"验证 \" type=\"Emphasized\" visible=\"true\" press=\"dialogPress\" level=\"H2\"/>-->\r\n\t\t\t\t\t\t</contentRight>\r\n\t\t\t\t\t</Bar>\r\n\t\t\t\t</footer>\r\n\t\t\t</Page>\r\n\t\t</pages>\r\n\t</App>\r\n</mvc:View>",
		"ZAPI_VIEW/view/view6.view.xml": "<!--<mvc:View xmlns:mvc=\"sap.ui.core.mvc\" xmlns:table=\"sap.ui.table\" xmlns:unified=\"sap.ui.unified\" xmlns=\"sap.m\" xmlns:lab=\"openui5.camera\"-->\r\n<!--\txmlns:custom=\"http://schemas.sap.com/sapui5/extension/sap.ui.core.CustomData/1\" controllerName=\"ZAPI_VIEW.controller.view6\"-->\r\n<!--\tdisplayBlock=\"true\">-->\r\n<!--\t<App>-->\r\n<!--\t\t<pages enableScrolling=\"false\">-->\r\n<!--\t\t\t<Page title=\"拍照 \" enableScrolling=\"false\">-->\r\n<!--\t\t\t\t<content>-->\r\n<!--\t\t\t\t\t<Image src=\"{/temp/Image}\" class=\"Image2\" densityAware=\"false\"></Image>-->\r\n<!--\t\t\t\t\t<lab:Camera id=\"idCamera\" snapshot=\"onSnapshot\" visible=\"{/image6Set/visible1}\"/>-->\r\n<!--\t\t\t\t</content>-->\r\n<!--\t\t\t\t<footer>-->\r\n<!--\t\t\t\t\t<Toolbar width=\"100%\">-->\r\n<!--\t\t\t\t\t\t<content>-->\r\n<!--\t\t\t\t\t\t\t<Button press=\"onPressImagehuawer\" text=\"拍摄 \" icon=\"{imageModel>/path}/camera.png\"></Button>-->\r\n<!--\t\t\t\t\t\t</content>-->\r\n<!--\t\t\t\t\t</Toolbar>-->\r\n<!--\t\t\t\t</footer>-->\r\n<!--\t\t\t</Page>-->\r\n<!--\t\t</pages>-->\r\n<!--\t</App>-->\r\n<!--</mvc:View>-->\r\n<mvc:View\r\n\theight=\"100%\"\r\n\txmlns:mvc=\"sap.ui.core.mvc\"\r\n\txmlns:lab=\"openui5.camera\"\r\n\tcontrollerName=\"ZAPI_VIEW.controller.view6\"\r\n\txmlns=\"sap.m\">\r\n\t<Page visible=\"{/temp/visible2}\"> \r\n\t\t<lab:Camera id=\"idCamera\" snapshot=\"onSnapshot\" />\r\n\t</Page>\r\n\t<Page visible=\"{/temp/visible1}\">\r\n\t\t<Image src=\"{/temp/Image}\" class=\"Image2\"/>\r\n\t</Page>\r\n\t<Button press=\"onPressImagehuawer\" text=\"拍摄 \" icon=\"{imageModel>/path}/camera.png\"></Button>\r\n</mvc:View>",
		"ZAPI_VIEW/view/view4.view.xml": "<mvc:View xmlns:mvc=\"sap.ui.core.mvc\" xmlns:table=\"sap.ui.table\" xmlns:unified=\"sap.ui.unified\" xmlns=\"sap.m\"\r\n\txmlns:custom=\"http://schemas.sap.com/sapui5/extension/sap.ui.core.CustomData/1\" controllerName=\"ZAPI_VIEW.controller.view4\"\r\n\tdisplayBlock=\"true\">\r\n\t<App>\r\n\t\t<pages>\r\n\t\t\t<Page title=\"录入图片\">\r\n\t\t\t\t<content>\r\n\t\t\t\t\t<!--<ScrollContainer height=\"50%\" width=\"50%\" horizontal=\"true\" vertical=\"true\" focusable=\"true\">-->\r\n\t\t\t\t\t<!--\t<Image src=\"{/image1Set/np_table/0/Image}\" densityAware=\"false\" width=\"100%\"></Image>-->\r\n\t\t\t\t\t<!--</ScrollContainer>-->\r\n\t\t\t\t\t<Image src=\"{/image4Set/np_table/0/Image}\" densityAware=\"false\" width=\"100%\"></Image>\r\n\t\t\t\t</content>\r\n\t\t\t\t<footer>\r\n\t\t\t\t\t<Toolbar width=\"100%\">\r\n\t\t\t\t\t\t<content>\r\n\t\t\t\t\t\t\t<unified:FileUploader buttonOnly=\"true\" buttonText=\"上传照片 \" sameFilenameAllowed=\"true\" multiple=\"true\" id=\"fileUploader\"\r\n\t\t\t\t\t\t\t\tfileType=\"zip,png,jpeg,jpg,bmp,tiff,tif\" icon=\"{imageModel>/path}/camera.png\"\r\n\t\t\t\t\t\t\t\tmimeType=\"application/x-zip-compressed,application/zip,application/octet-stream,image/png,image/jpg,image/jpeg,image/bmp,image/tiff\"\r\n\t\t\t\t\t\t\t\ttypeMissmatch=\"fileTypeMissmatch\" change=\"onPressImagehuawer\" custom:mode=\"xhr\"></unified:FileUploader>\r\n\t\t\t\t\t\t</content>\r\n\t\t\t\t\t</Toolbar>\r\n\t\t\t\t</footer>\r\n\t\t\t</Page>\r\n\t\t</pages>\r\n\t</App>\r\n</mvc:View>",
		"ZAPI_VIEW/view/view1.view.xml": "<mvc:View xmlns:mvc=\"sap.ui.core.mvc\" xmlns:table=\"sap.ui.table\" xmlns:unified=\"sap.ui.unified\" xmlns=\"sap.m\"\r\n\txmlns:custom=\"http://schemas.sap.com/sapui5/extension/sap.ui.core.CustomData/1\" controllerName=\"ZAPI_VIEW.controller.view1\"\r\n\tdisplayBlock=\"true\">\r\n\t<App>\r\n\t\t<pages>\r\n\t\t\t<Page title=\"图片识别\">\r\n\t\t\t\t<content>\r\n\t\t\t\t\t<ScrollContainer height=\"50%\" width=\"50%\" horizontal=\"true\" vertical=\"true\" focusable=\"true\">\r\n\t\t\t\t\t\t<Image src=\"{/image1Set/np_table/0/Image}\" densityAware=\"false\" width=\"100%\"></Image>\r\n\t\t\t\t\t</ScrollContainer>\r\n\t\t\t\t\t<table:Table rows=\"{/image1Set/np_res/}\" enableBusyIndicator=\"true\" selectionMode=\"Single\" visibleRowCount=\"5\">\r\n\t\t\t\t\t\t<table:columns>\r\n\t\t\t\t\t\t\t<table:Column sortProperty=\"label\" filterProperty=\"label\">\r\n\t\t\t\t\t\t\t\t<Label text=\"参考\"/>\r\n\t\t\t\t\t\t\t\t<table:template>\r\n\t\t\t\t\t\t\t\t\t<Text text=\"{path:'Tag',formatter:'.formatter1'}\"/>\r\n\t\t\t\t\t\t\t\t</table:template>\r\n\t\t\t\t\t\t\t</table:Column>\r\n\t\t\t\t\t\t\t<table:Column sortProperty=\"score\" filterProperty=\"score\">\r\n\t\t\t\t\t\t\t\t<Label text=\"相似度\"/>\r\n\t\t\t\t\t\t\t\t<table:template>\r\n\t\t\t\t\t\t\t\t\t<Text text=\"{Confidence}\"/>\r\n\t\t\t\t\t\t\t\t</table:template>\r\n\t\t\t\t\t\t\t</table:Column>\r\n\t\t\t\t\t\t</table:columns>\r\n\t\t\t\t\t</table:Table>\r\n\t\t\t\t</content>\r\n\t\t\t\t<footer>\r\n\t\t\t\t\t<Toolbar width=\"100%\">\r\n\t\t\t\t\t\t<content>\r\n\t\t\t\t\t\t\t<unified:FileUploader buttonOnly=\"true\" buttonText=\"上传图片 \" sameFilenameAllowed=\"true\" multiple=\"true\" id=\"fileUploader\"\r\n\t\t\t\t\t\t\t\tfileType=\"zip,png,jpeg,jpg,bmp,tiff,tif\" icon=\"{imageModel>/path}/camera.png\"\r\n\t\t\t\t\t\t\t\tmimeType=\"application/x-zip-compressed,application/zip,application/octet-stream,image/png,image/jpg,image/jpeg,image/bmp,image/tiff\"\r\n\t\t\t\t\t\t\t\ttypeMissmatch=\"fileTypeMissmatch\" change=\"onPressImagehuawer\" custom:mode=\"xhr\"></unified:FileUploader>\r\n\t\t\t\t\t\t</content>\r\n\t\t\t\t\t</Toolbar>\r\n\t\t\t\t</footer>\r\n\t\t\t</Page>\r\n\t\t</pages>\r\n\t</App>\r\n</mvc:View>",
		"ZAPI_VIEW/view/Dialog.fragment.xml": "<core:FragmentDefinition xmlns=\"sap.m\" xmlns:lab=\"openui5.camera\" xmlns:core=\"sap.ui.core\">\r\n\t<Dialog id=\"opDialog\" title=\"\">\r\n\t\t<content>\r\n\t\t\t<lab:Camera id=\"idCamera\" snapshot=\"onSnapshot\" visible=\"{/temp/visible1}\"/>\r\n\t\t</content>\r\n\t\t<content>\r\n\t\t\t<Image src=\"{/temp/Image}\" class=\"Image2\" visible=\"{/temp/visible2}\"/>\r\n\t\t</content>\r\n\t\t<buttons>\r\n\t\t\t<Button  type=\"Emphasized\" text=\"重新拍照 \" press=\"reButton\"/>\r\n\t\t\t<Button  type=\"Emphasized\" text=\"取消 \" press=\"onCancelAction\"/>\r\n\t\t</buttons>\r\n\t</Dialog>\r\n</core:FragmentDefinition>",
		"ZAPI_VIEW/view/view7.view.xml": "<mvc:View xmlns:mvc=\"sap.ui.core.mvc\" xmlns:table=\"sap.ui.table\" xmlns:unified=\"sap.ui.unified\" xmlns=\"sap.m\"   xmlns:lab=\"openui5.camera\"\r\n\txmlns:custom=\"http://schemas.sap.com/sapui5/extension/sap.ui.core.CustomData/1\" controllerName=\"ZAPI_VIEW.controller.view7\"\r\n\tdisplayBlock=\"true\">\r\n\t<App>\r\n\t\t<pages enableScrolling=\"false\">\r\n\t\t\t<Page title=\"语音识别 \" enableScrolling=\"false\">\r\n\t\t\t\t<content>\r\n\t\t\t\t</content>\r\n\t\t\t\t<footer>\r\n\t\t\t\t\t<Toolbar width=\"100%\">\r\n\t\t\t\t\t\t<content>\r\n\t\t\t\t\t\t\t<Button press =\"onPressImagehuawer\" text=\"语音识别 \" icon=\"{imageModel>/path}/camera.png\"></Button>\r\n\t\t\t\t\t\t</content>\r\n\t\t\t\t\t</Toolbar>\r\n\t\t\t\t</footer>\r\n\t\t\t</Page>\r\n\t\t</pages>\r\n\t\t\t</App>\r\n</mvc:View>",
		"ZAPI_VIEW/controller/view3.controller.js": "/* ======================================== */\r\n/* helloWorld MVC 中control 实现            */\r\n/* ======================================== */\r\nsap.ui.define([\"./BaseController\",\r\n\t\"sap/ui/model/json/JSONModel\",\r\n\t\"sap/ui/model/Filter\",\r\n\t\"./designMode\",\r\n\t\"sap/ui/model/FilterOperator\",\r\n\t\"sap/m/MessageToast\",\r\n\t\"sap/m/MessageBox\",\r\n\t'sap/ui/model/SimpleType',\r\n\t'sap/ui/model/ValidateException',\r\n\t\"./messages\"\r\n], function(BaseController, JSONModel, designMode, Filter, FilterOperator, MessageToast, MessageBox, SimpleType, ValidateException,\r\n\tmessages) {\r\n\t\"use strict\";\r\n\r\n\treturn BaseController.extend(\"ZAPI_VIEW.controller.view3\", {\r\n\r\n\t\t/* ======================================== */\r\n\t\t/* lifecycle methods                        */\r\n\t\t/* ======================================== */\r\n\t\tonInit: function() {\r\n\t\t\tthis._ODataModel = this.getModel(\"OData\");\r\n\t\t\t//this._ResourceBundle = this.getModel( \"i18n\" ).getResourceBundle();\r\n\t\t\tthis._JSONModel = this.getModel();\r\n\t\t},\r\n\r\n\t\tonAfterRendering: function() {\r\n\r\n\t\t\tif (!this._oDialog) {\r\n\t\t\t\tthis._oDialog = sap.ui.xmlfragment(\"ZAPI_VIEW.view.Dialog\", this);\r\n\t\t\t\t// designMode.syncStyleClass(this._oSubControllerForPost._oParentView, this._oSubControllerForPost._oDialog);\r\n\t\t\t}\r\n\r\n\t\t\tvar invoiceSet = {\r\n\t\t\t\tnp_invoiceimage: [],\r\n\t\t\t\tnp_invoiceinvoice_item: []\r\n\t\t\t};\r\n\r\n\t\t\tthis._JSONModel.setProperty(\"/invoiceSet\", invoiceSet);\r\n\t\t},\r\n\r\n\t\tonPressImagehuawer: function(oControlEvent) {\r\n\r\n\t\t\tvar invoiceSet = {\r\n\t\t\t\tnp_invoiceimage: [{\r\n\t\t\t\t\t\"Image\": \"\"\r\n\t\t\t\t}],\r\n\t\t\t\tnp_invoiceinvoice_item: []\r\n\t\t\t};\r\n\r\n\t\t\tthis._JSONModel.setProperty(\"/invoiceSet\", invoiceSet);\r\n\r\n\t\t\tthis.setBusy(true);\r\n\t\t\tthis._JSONModel.setProperty(\"/busy\", true);\r\n\t\t\tvar oFile = this.getView().byId(\"fileUploader\");\r\n\t\t\t// 为空选择文件提示\r\n\t\t\tif (!oFile.getValue()) {\r\n\t\t\t\tmessages.showText(\"请选择文件\");\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\t// 文件DOM \r\n\t\t\tvar that = this;\r\n\t\t\tvar domRef = oFile.getFocusDomRef();\r\n\t\t\tvar reader = new FileReader();\r\n\t\t\tvar file = domRef.files[0];\r\n\t\t\treader.readAsDataURL(file);\r\n\t\t\tvar image = \"\";\r\n\t\t\treader.that = this;\r\n\t\t\treader.onload = function(e) {\r\n\t\t\t\t// alert(1);\r\n\t\t\t\timage = e.target.result;\r\n\t\t\t\tthat._JSONModel.setProperty(\"/invoiceSet/np_invoiceimage/0/Image\", image);\r\n\t\t\t\tthat.upload();\r\n\t\t\t};\r\n\t\t},\r\n\r\n\t\tupload: function(oControlEvent) {\r\n\r\n\t\t\tvar oRequest = this._JSONModel.getData().invoiceSet;\r\n\t\t\toRequest.Guid = \"\";\r\n\t\t\toRequest.np_invoiceimage = !oRequest.np_invoiceimage ? [] : oRequest.np_invoiceimage;\r\n\t\t\toRequest.np_invoiceinvoice_item = !oRequest.np_invoiceinvoice_item ? [] : oRequest.np_invoiceinvoice_item;\r\n\t\t\tvar sUrl = \"/invoiceSet\";\r\n\t\t\tvar mParameters = {\r\n\t\t\t\tsuccess: function(oData, response) {\r\n\t\t\t\t\tvar localData = this._JSONModel.getData();\r\n\t\t\t\t\tlocalData.invoiceSet = oData;\r\n\t\t\t\t\tlocalData.invoiceSet.np_invoiceimage = oData.np_invoiceimage != null ? oData.np_invoiceimage : null;\r\n\t\t\t\t\tlocalData.invoiceSet.np_invoiceinvoice_item = oData.np_invoiceinvoice_item != null ? oData.np_invoiceinvoice_item.results :\r\n\t\t\t\t\t\tnull;\r\n\t\t\t\t\tthis._JSONModel.setProperty(\"/\", localData, false);\r\n\t\t\t\t\tthis.setBusy(false);\r\n\t\t\t\t\tthis._JSONModel.setProperty(\"/busy\", false);\r\n\t\t\t\t}.bind(this),\r\n\t\t\t\terror: function(oError) {\r\n\t\t\t\t\tthis.setBusy(false);\r\n\t\t\t\t\tthis._JSONModel.setProperty(\"/busy\", false);\r\n\t\t\t\t}.bind(this)\r\n\t\t\t};\r\n\t\t\tthis._ODataModel.create(sUrl, oRequest, mParameters);\r\n\t\t},\r\n\r\n\t\topPressPost: function() {\r\n\r\n\t\t\tvar Guid = this._JSONModel.getProperty(\"/invoiceSet/Guid\");\r\n\t\t\tvar oRequest = this._JSONModel.getData().invoice_miro_postSet;\r\n\t\t\toRequest.Guid = Guid;\r\n\t\t\toRequest.np_message = !oRequest.np_message ? [] : oRequest.np_message;\r\n\t\t\tvar sUrl = \"/invoice_miro_postSet\";\r\n\t\t\tvar mParameters = {\r\n\t\t\t\tsuccess: function(oData, response) {\r\n\t\t\t\t\tvar localData = this._JSONModel.getData();\r\n\t\t\t\t\tlocalData.invoice_miro_postSet = oData;\r\n\t\t\t\t\tlocalData.invoice_miro_postSet.np_message = oData.np_message != null ? oData.np_message.results : null;\r\n\t\t\t\t\tthis._JSONModel.setProperty(\"/\", localData, false);\r\n\t\t\t\t\tthis.setBusy(false);\r\n\t\t\t\t\tthis._JSONModel.setProperty(\"/busy\", false);\r\n\r\n\t\t\t\t\tvar message = this._JSONModel.getProperty(\"/invoice_miro_postSet/np_message\");\r\n\t\t\t\t\tif (message.length > 0) {\r\n\t\t\t\t\t\tif (message[0].Type == \"S\") {\r\n\t\t\t\t\t\t\tmessages.showInformation(message[0].Message);\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tmessages.showWarning(message[0].Message);\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t}.bind(this),\r\n\t\t\t\terror: function(oError) {\r\n\t\t\t\t\tthis.setBusy(false);\r\n\t\t\t\t\tthis._JSONModel.setProperty(\"/busy\", false);\r\n\t\t\t\t}.bind(this)\r\n\t\t\t};\r\n\t\t\tthis._ODataModel.create(sUrl, oRequest, mParameters);\r\n\t\t},\r\n\r\n\t\tonExit: function() {\r\n\t\t\tif (this._oDialog) {\r\n\t\t\t\tthis._oDialog.destroy();\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tdialogPress: function(oEvent) {\r\n\t\t\tvar content1 = this._oDialog.getContent()[0];\r\n\t\t\tvar content2 = this._oDialog.getContent()[1];\r\n\t\t\tcontent1.setVisible(true);\r\n\t\t\tcontent2.setVisible(false);\r\n\t\t\tthis._oDialog.open();\r\n\t\t},\r\n\r\n\t\tonCancelAction: function() {\r\n\t\t\tvar oCamera = this._oDialog.getContent()[0];\r\n\t\t\toCamera.rerender();\r\n\t\t\toCamera.stopCamera();\r\n\t\t\tthis._oDialog.close();\r\n\t\t},\r\n\r\n\t\tonSnapshot: function(oEvent) {\r\n\t\t\tvar oCamera = this._oDialog.getContent()[0];\r\n\t\t\toCamera.rerender();\r\n\t\t\toCamera.stopCamera();\r\n\t\t\t// this._JSONModel.setProperty(\"/temp/Image\", oEvent.getParameter(\"image\"));\r\n\t\t\tvar content1 = this._oDialog.getContent()[0];\r\n\t\t\tvar content2 = this._oDialog.getContent()[1];\r\n\t\t\tcontent1.setVisible(false);\r\n\t\t\tcontent2.setVisible(true);\r\n\t\t\tcontent2.setSrc(oEvent.getParameter(\"image\"));\r\n\t\t\tvar Image = oEvent.getParameter(\"image\");\r\n\t\t\tImage = Image.replace(/data:image\\/.*;base64,/, '');\r\n\t\t\tthis._JSONModel.setProperty(\"/vat_faceSet/np_vat_faceimage/0/Image\", Image);\r\n\t\t\tvar oRequest = this._JSONModel.getData().vat_faceSet;\r\n\t\t\tvar sUrl = \"/vat_faceSet\";\r\n\t\t\tvar mParameters = {\r\n\t\t\t\tsuccess: function(oData, response) {\r\n\t\t\t\t\tvar localData = this._JSONModel.getData();\r\n\t\t\t\t\tlocalData.vat_faceSet = oData;\r\n\t\t\t\t\tlocalData.vat_faceSet.np_vat_faceimage = [{\r\n\t\t\t\t\t\t\"Image\": \"\"\r\n\t\t\t\t\t}];\r\n\t\t\t\t\tthis._JSONModel.setProperty(\"/\", localData, false);\r\n\t\t\t\t\tthis.setBusy(false);\r\n\t\t\t\t\tthis._JSONModel.setProperty(\"/busy\", false);\r\n\r\n\t\t\t\t\tif (localData.vat_faceSet.MsgType == \"S\") {\r\n\t\t\t\t\t\tmessages.showInformation(localData.vat_faceSet.Msg);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tmessages.showWarning(localData.vat_faceSet.Msg);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}.bind(this),\r\n\t\t\t\terror: function(oError) {\r\n\t\t\t\t\tthis.setBusy(false);\r\n\t\t\t\t\tthis._JSONModel.setProperty(\"/busy\", false);\r\n\t\t\t\t}.bind(this)\r\n\t\t\t};\r\n\t\t\tthis._ODataModel.create(sUrl, oRequest, mParameters);\r\n\t\t\t// messages.showInformation(\"通过验证 \");\r\n\t\t},\r\n\r\n\t\treButton: function() {\r\n\t\t\tvar oCamera = this._oDialog.getContent()[0];\r\n\t\t\toCamera.rerender();\r\n\t\t\toCamera.stopCamera();\r\n\t\t\tthis._oDialog.close();\r\n\t\t\tvar content1 = this._oDialog.getContent()[0];\r\n\t\t\tvar content2 = this._oDialog.getContent()[1];\r\n\t\t\tcontent1.setVisible(true);\r\n\t\t\tcontent2.setVisible(false);\r\n\t\t\tthis._oDialog.open();\r\n\t\t}\r\n\r\n\t});\r\n});",
		"ZAPI_VIEW/controller/App.controller.js": "/* =========================================================== */\r\n/* App MVC中 control 实现（App 控制器实现）                    */\r\n/* =========================================================== */\r\nsap.ui.define([\"./BaseController\",\r\n\t\"./designMode\",\r\n\t\"sap/ui/model/json/JSONModel\"\r\n], function(BaseController, designMode, JSONModel) {\r\n\t//---JS 严格模式\r\n\t\"use strict\";\r\n\t//--- 基于BaseController 扩展\r\n\treturn BaseController.extend(\"ZAPI_VIEW.controller.App\", {\r\n\r\n\t\t/* =========================================================== */\r\n\t\t/* lifecycle methods 应用程序初始化                            */\r\n\t\t/* =========================================================== */\r\n\t\t //onInit : function() {\r\n\t\t //\t// this.getView().addStyleClass(designMode.getCompactCozyClass());\r\n\t\t //}\r\n\t\tonBeforeRendering: function() {\r\n\t\t\tthis.navTo(this.getRouterID());\r\n\t\t}\r\n\t});\r\n});",
		"ZAPI_VIEW/controller/view4.controller.js": "/* ======================================== */\r\n/* helloWorld MVC 中control 实现            */\r\n/* ======================================== */\r\nsap.ui.define([\"./BaseController\",\r\n\t\"sap/ui/model/json/JSONModel\",\r\n\t\"sap/ui/model/Filter\",\r\n\t\"sap/ui/model/FilterOperator\",\r\n\t\"sap/m/MessageToast\",\r\n\t\"sap/m/MessageBox\",\r\n\t'sap/ui/model/SimpleType',\r\n\t'sap/ui/model/ValidateException',\r\n\t\"./messages\"\r\n], function(BaseController, JSONModel, Filter, FilterOperator, MessageToast, MessageBox, SimpleType, ValidateException, messages) {\r\n\t\"use strict\";\r\n\r\n\treturn BaseController.extend(\"ZAPI_VIEW.controller.view4\", {\r\n\r\n\t\t/* ======================================== */\r\n\t\t/* lifecycle methods                        */\r\n\t\t/* ======================================== */\r\n\t\tonInit: function() {\r\n\t\t\tthis._ODataModel = this.getModel(\"OData\");\r\n\t\t\t//this._ResourceBundle = this.getModel( \"i18n\" ).getResourceBundle();\r\n\t\t\tthis._JSONModel = this.getModel();\r\n\r\n\t\t},\r\n\r\n\t\tonAfterRendering: function() {\r\n\t\t\r\n\t\t\tvar sUrl = \"/zdataSet(Name1='1',Password='1',Name2='1')\";\r\n\t\t\t// this._JSONModel.setProperty(\"/busy\", true);\r\n\t\t\t// this.setBusy(true);\r\n\t\t\tvar mParameters = {\r\n\t\t\t\tsuccess: function(oData, response) {\r\n\t\t\t\t\tvar localData = this._JSONModel.getData();\r\n\t\t\t\t\tthis._JSONModel.setProperty(\"/zdataSet\", oData);\r\n\t\t\t\t\tthis._JSONModel.setProperty(\"/busy\", false);\r\n\t\t\t\t\tthis.setBusy(false);\r\n\t\t\t\t}.bind(this),\r\n\t\t\t\terror: function(oError) {\r\n\t\t\t\t\tmessages.showODataErrorText(oError);\r\n\t\t\t\t\tthis.setBusy(false);\r\n\t\t\t\t\tthis._JSONModel.setProperty(\"/busy\", false);\r\n\t\t\t\t}.bind(this)\r\n\t\t\t};\r\n\t\t\tthis._ODataModel.read(sUrl, mParameters);\r\n\t\t},\r\n\r\n\t\tonPressImagehuawer: function(oControlEvent) {\r\n\t\t\tvar image4Set = {\r\n\t\t\t\tnp_table: [{\r\n\t\t\t\t\t\"Image\": \"\"\r\n\t\t\t\t}]\r\n\t\t\t};\r\n\t\t\tthis._JSONModel.setProperty(\"/image4Set\", image4Set);\r\n\t\t\tthis.setBusy(true);\r\n\t\t\tthis._JSONModel.setProperty(\"/busy\", true);\r\n\t\t\tvar oFile = this.getView().byId(\"fileUploader\");\r\n\t\t\t// 为空选择文件提示\r\n\t\t\tif (!oFile.getValue()) {\r\n\t\t\t\tmessages.showText(\"请选择文件\");\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\t// 文件DOM \r\n\t\t\tvar that = this;\r\n\t\t\tvar domRef = oFile.getFocusDomRef();\r\n\t\t\tvar reader = new FileReader();\r\n\t\t\tvar file = domRef.files[0];\r\n\t\t\treader.readAsDataURL(file);\r\n\t\t\tvar image = \"\";\r\n\t\t\treader.that = this;\r\n\t\t\treader.onload = function(e) {\r\n\t\t\t\t// alert(1);\r\n\t\t\t\timage = e.target.result;\r\n\t\t\t\tthat._JSONModel.setProperty(\"/image4Set/np_table/0/Image\", image);\r\n\t\t\t\tthat.upload();\r\n\t\t\t};\r\n\r\n\t\t\t//\tthis._JSONModel.setProperty(\"/image1Set/np_table/0/Image\",image);\r\n\t\t\t//\tthis.upload();\r\n\t\t},\r\n\r\n\t\tupload: function(oControlEvent) {\r\n\t\t\tvar zdataSet = this._JSONModel.getProperty(\"/zdataSet\");\r\n\t\t\tthis._JSONModel.setProperty(\"/image4Set/Name1\", zdataSet.Name1);\r\n\t\t\tvar oRequest = this._JSONModel.getData().image4Set;\r\n\t\t\toRequest.np_table = !oRequest.np_table ? [] : oRequest.np_table;\r\n\t\t\tvar sUrl = \"/image4Set\";\r\n\t\t\tvar mParameters = {\r\n\t\t\t\tsuccess: function(oData, response) {\r\n\t\t\t\t\tvar localData = this._JSONModel.getData();\r\n\t\t\t\t\tlocalData.image4Set = oData;\r\n\t\t\t\t\tlocalData.image4Set.np_table = oData.np_table != null ? oData.np_table.results : null;\r\n\t\t\t\t\tthis._JSONModel.setProperty(\"/\", localData, false);\r\n\t\t\t\t\tthis.setBusy(false);\r\n\t\t\t\t\tthis._JSONModel.setProperty(\"/busy\", false);\r\n\t\t\t\t\tif(localData.image4Set.Type == \"S\"){\r\n\t\t\t\t\t\tmessages.showInformation(\"上传成功\");\r\n\t\t\t\t\t}else{\r\n\t\t\t\t\t\tmessages.showWarning(\"上传失败 \");\r\n\t\t\t\t\t}\r\n\t\t\t\t}.bind(this),\r\n\t\t\t\terror: function(oError) {\r\n\t\t\t\t\tthis.setBusy(false);\r\n\t\t\t\t\tthis._JSONModel.setProperty(\"/busy\", false);\r\n\t\t\t\t}.bind(this)\r\n\t\t\t};\r\n\t\t\tthis._ODataModel.create(sUrl, oRequest, mParameters);\r\n\t\t}\r\n\r\n\t});\r\n});",
		"ZAPI_VIEW/controller/main.controller.js": "/* ======================================== */\r\n/* helloWorld MVC 中control 实现            */\r\n/* ======================================== */\r\nsap.ui.define([\"./BaseController\",\r\n\t\"sap/ui/model/json/JSONModel\",\r\n\t\"sap/ui/model/Filter\",\r\n\t\"sap/ui/model/FilterOperator\",\r\n\t\"sap/m/MessageToast\",\r\n\t\"sap/m/MessageBox\",\r\n\t'sap/ui/model/SimpleType',\r\n\t'sap/ui/model/ValidateException',\r\n\t\"./messages\"\r\n], function(BaseController, JSONModel, Filter, FilterOperator, MessageToast, MessageBox, SimpleType, ValidateException, messages) {\r\n\t\"use strict\";\r\n\r\n\treturn BaseController.extend(\"ZAPI_VIEW.controller.main\", {\r\n\r\n\t\t/* ======================================== */\r\n\t\t/* lifecycle methods                        */\r\n\t\t/* ======================================== */\r\n\t\tonInit: function() {\r\n\t\t\tthis._ODataModel = this.getModel(\"OData\");\r\n\t\t\t//this._ResourceBundle = this.getModel( \"i18n\" ).getResourceBundle();\r\n\t\t\tthis._JSONModel = this.getModel();\r\n\r\n\t\t},\r\n\r\n\t\tonPress1: function() {\r\n\t\t\tvar image1Set = {\r\n\t\t\t\tnp_res: [],\r\n\t\t\t\tnp_table: [{\r\n\t\t\t\t\t\"Image\": \"\"\r\n\t\t\t\t}]\r\n\t\t\t};\r\n\t\t\tthis._JSONModel.setProperty(\"/image1Set\", image1Set);\r\n\t\t\tthis.getRouter().navTo(\"view1\");\r\n\t\t},\r\n\r\n\t\tonPress2: function() {\r\n\t\t\tvar image2Set = {\r\n\t\t\t\tnp_res: [],\r\n\t\t\t\tnp_table: [{\r\n\t\t\t\t\t\"Image\": \"\"\r\n\t\t\t\t}]\r\n\t\t\t};\r\n\t\t\tthis._JSONModel.setProperty(\"/image2Set\", image2Set);\r\n\t\t\tthis.getRouter().navTo(\"view2\");\r\n\t\t},\r\n\r\n\t\tonPress3: function() {\r\n\t\t\tvar image3Set = {\r\n\t\t\t\tnp_res: [],\r\n\t\t\t\tnp_table: [{\r\n\t\t\t\t\t\"Image\": \"\"\r\n\t\t\t\t}]\r\n\t\t\t};\r\n\t\t\tthis._JSONModel.setProperty(\"/image3Set\", image3Set);\r\n\t\t\tthis.getRouter().navTo(\"view3\");\r\n\t\t},\r\n\r\n\t\tonPress4: function() {\r\n\t\t\tvar image4Set = {\r\n\t\t\t\tnp_table: [{\r\n\t\t\t\t\t\"Image\": \"\"\r\n\t\t\t\t}]\r\n\t\t\t};\r\n\t\t\tthis._JSONModel.setProperty(\"/image4Set\", image4Set);\r\n\t\t\tthis.getRouter().navTo(\"view4\");\r\n\t\t},\r\n\r\n\t\tonPress5: function() {\r\n\t\t\tvar image5Set = {\r\n\t\t\t\tnp_table: [{\r\n\t\t\t\t\t\"Image\": \"\"\r\n\t\t\t\t}]\r\n\t\t\t};\r\n\t\t\tthis._JSONModel.setProperty(\"/image5Set\", image5Set);\r\n\t\t\tthis.getRouter().navTo(\"view5\");\r\n\t\t},\r\n\t\tonPress6: function() {\r\n\t\t\tvar image6Set = {\r\n\t\t\t\tnp_table: [{\r\n\t\t\t\t\t\"Image\": \"\"\r\n\t\t\t\t}]\r\n\t\t\t};\r\n\t\t\tthis._JSONModel.setProperty(\"/image6Set\", image6Set);\r\n\t\t\tthis._JSONModel.setProperty(\"/image6Set/visible1\", true);\r\n\t\t\tthis._JSONModel.setProperty(\"/image6Set/visible2\", false);\r\n\t\t\tthis.getRouter().navTo(\"view6\");\r\n\t\t},\r\n\t\tonPress7: function() {\r\n\t\t\tthis.getRouter().navTo(\"view7\");\r\n\t\t}\r\n\t});\r\n});",
		"ZAPI_VIEW/controller/view5.controller.js": "/* ======================================== */\r\n/* helloWorld MVC 中control 实现            */\r\n/* ======================================== */\r\nsap.ui.define([\"./BaseController\",\r\n\t\"sap/ui/model/json/JSONModel\",\r\n\t\"sap/ui/model/Filter\",\r\n\t\"sap/ui/model/FilterOperator\",\r\n\t\"sap/m/MessageToast\",\r\n\t\"sap/m/MessageBox\",\r\n\t'sap/ui/model/SimpleType',\r\n\t'sap/ui/model/ValidateException',\r\n\t\"./messages\"\r\n], function(BaseController, JSONModel, Filter, FilterOperator, MessageToast, MessageBox, SimpleType, ValidateException, messages) {\r\n\t\"use strict\";\r\n\r\n\treturn BaseController.extend(\"ZAPI_VIEW.controller.view5\", {\r\n\r\n\t\t/* ======================================== */\r\n\t\t/* lifecycle methods                        */\r\n\t\t/* ======================================== */\r\n\t\tonInit: function() {\r\n\t\t\tthis._ODataModel = this.getModel(\"OData\");\r\n\t\t\t//this._ResourceBundle = this.getModel( \"i18n\" ).getResourceBundle();\r\n\t\t\tthis._JSONModel = this.getModel();\r\n\r\n\t\t},\r\n\r\n\t\tonAfterRendering: function() {\r\n\t\t\r\n\t\t\tvar sUrl = \"/zdataSet(Name1='1',Password='1',Name2='1')\";\r\n\t\t\t// this._JSONModel.setProperty(\"/busy\", true);\r\n\t\t\t// this.setBusy(true);\r\n\t\t\tvar mParameters = {\r\n\t\t\t\tsuccess: function(oData, response) {\r\n\t\t\t\t\tvar localData = this._JSONModel.getData();\r\n\t\t\t\t\tthis._JSONModel.setProperty(\"/zdataSet\", oData);\r\n\t\t\t\t\tthis._JSONModel.setProperty(\"/busy\", false);\r\n\t\t\t\t\tthis.setBusy(false);\r\n\t\t\t\t}.bind(this),\r\n\t\t\t\terror: function(oError) {\r\n\t\t\t\t\tmessages.showODataErrorText(oError);\r\n\t\t\t\t\tthis.setBusy(false);\r\n\t\t\t\t\tthis._JSONModel.setProperty(\"/busy\", false);\r\n\t\t\t\t}.bind(this)\r\n\t\t\t};\r\n\t\t\tthis._ODataModel.read(sUrl, mParameters);\r\n\t\t},\r\n\r\n\t\tonPressImagehuawer: function(oControlEvent) {\r\n\t\t\tvar image5Set = {\r\n\t\t\t\tnp_table: [{\r\n\t\t\t\t\t\"Image\": \"\"\r\n\t\t\t\t}]\r\n\t\t\t};\r\n\t\t\tthis._JSONModel.setProperty(\"/image5Set\", image5Set);\r\n\t\t\tthis.setBusy(true);\r\n\t\t\tthis._JSONModel.setProperty(\"/busy\", true);\r\n\t\t\tvar oFile = this.getView().byId(\"fileUploader\");\r\n\t\t\t// 为空选择文件提示\r\n\t\t\tif (!oFile.getValue()) {\r\n\t\t\t\tmessages.showText(\"请选择文件\");\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\t// 文件DOM \r\n\t\t\tvar that = this;\r\n\t\t\tvar domRef = oFile.getFocusDomRef();\r\n\t\t\tvar reader = new FileReader();\r\n\t\t\tvar file = domRef.files[0];\r\n\t\t\treader.readAsDataURL(file);\r\n\t\t\tvar image = \"\";\r\n\t\t\treader.that = this;\r\n\t\t\treader.onload = function(e) {\r\n\t\t\t\t// alert(1);\r\n\t\t\t\timage = e.target.result;\r\n\t\t\t\tthat._JSONModel.setProperty(\"/image5Set/np_table/0/Image\", image);\r\n\t\t\t\tthat.upload();\r\n\t\t\t};\r\n\r\n\t\t\t//\tthis._JSONModel.setProperty(\"/image1Set/np_table/0/Image\",image);\r\n\t\t\t//\tthis.upload();\r\n\t\t},\r\n\r\n\t\tupload: function(oControlEvent) {\r\n\t\t\tvar zdataSet = this._JSONModel.getProperty(\"/zdataSet\");\r\n\t\t\tthis._JSONModel.setProperty(\"/image5Set/Name1\", zdataSet.Name1);\r\n\t\t\tthis._JSONModel.setProperty(\"/image5Set/Name2\", zdataSet.Name2);\r\n\t\t\tthis._JSONModel.setProperty(\"/image5Set/Password\", zdataSet.Password);\r\n\t\t\tthis._JSONModel.setProperty(\"/image5Set/Token\", zdataSet.Token);\r\n\t\t\tvar oRequest = this._JSONModel.getData().image5Set;\r\n\t\t\toRequest.np_table = !oRequest.np_table ? [] : oRequest.np_table;\r\n\t\t\tvar sUrl = \"/image5Set\";\r\n\t\t\tvar mParameters = {\r\n\t\t\t\tsuccess: function(oData, response) {\r\n\t\t\t\t\tvar localData = this._JSONModel.getData();\r\n\t\t\t\t\tlocalData.image5Set = oData;\r\n\t\t\t\t\tlocalData.image5Set.np_table = oData.np_table != null ? oData.np_table.results : null;\r\n\t\t\t\t\tthis._JSONModel.setProperty(\"/\", localData, false);\r\n\t\t\t\t\tthis.setBusy(false);\r\n\t\t\t\t\tthis._JSONModel.setProperty(\"/busy\", false);\r\n\t\t\t\t\tif(localData.image5Set.Type == \"S\"){\r\n\t\t\t\t\t\tmessages.showInformation(localData.image5Set.Message);\r\n\t\t\t\t\t}else{\r\n\t\t\t\t\t\tmessages.showWarning(localData.image5Set.Message);\r\n\t\t\t\t\t}\r\n\t\t\t\t}.bind(this),\r\n\t\t\t\terror: function(oError) {\r\n\t\t\t\t\tthis.setBusy(false);\r\n\t\t\t\t\tthis._JSONModel.setProperty(\"/busy\", false);\r\n\t\t\t\t}.bind(this)\r\n\t\t\t};\r\n\t\t\tthis._ODataModel.create(sUrl, oRequest, mParameters);\r\n\t\t}\r\n\r\n\t});\r\n});",
		"ZAPI_VIEW/controller/messages.js": "/* =========================================================== */\r\n/* 消息控制器（消息函数功能实现包）                            */\r\n/* =========================================================== */\r\nsap.ui.define(['sap/m/MessagePopover',\r\n\t'sap/m/MessagePopoverItem',\r\n\t\"sap/m/Button\",\r\n\t\"sap/m/Bar\",\r\n\t\"sap/m/MessageBox\",\r\n\t\"sap/m/MessageToast\",\r\n\t\"sap/ui/model/json/JSONModel\",\r\n\t\"./designMode\"\r\n], function(MessagePopover, MessagePopoverItem, Button, Bar, MessageBox, MessageToast, JSONModel, designMode) {\r\n\t// 严格JS 模式\r\n\t\"use strict\";\r\n\r\n\t//---解析错误消息\r\n\tfunction fnParseError(oParameter) {\r\n\t\tvar sMessage = \"\",\r\n\t\t\tsDetails = \"\",\r\n\t\t\toParameters = null,\r\n\t\t\toError = {};\r\n\t\toParameters = oParameter.getParameters ? oParameter.getParameters() : oParameter;\r\n\t\tsMessage = oParameters.message || oParameters.response.message;\r\n\t\tsDetails = oParameters.responseText || oParameters.response.responseText;\r\n\r\n\t\tif (jQuery.sap.startsWith(sDetails || \"\", \"{\\\"error\\\":\")) {\r\n\t\t\tvar oErrModel = new JSONModel();\r\n\t\t\toErrModel.setJSON(sDetails);\r\n\t\t\tsMessage = oErrModel.getProperty(\"/error/message/value\");\r\n\t\t}\r\n\r\n\t\toError.sDetails = sDetails;\r\n\t\toError.sMessage = sMessage;\r\n\t\treturn oError;\r\n\t}\r\n\r\n\t//---创建左上角消息按钮\r\n\tfunction createMessagePopover(oContext, oEvent) {\r\n\t\tif (!oContext._MessagePopover) {\r\n\t\t\tvar oMessageTemplate = new MessagePopoverItem({\r\n\t\t\t\ttype: '{type}',\r\n\t\t\t\ttitle: '{title}',\r\n\t\t\t\tdescription: '{description}',\r\n\t\t\t\tsubtitle: '{subtitle}'\r\n\t\t\t});\r\n\r\n\t\t\toContext._MessagePopover = new MessagePopover({\r\n\t\t\t\titems: {\r\n\t\t\t\t\tpath: '/messages/content',\r\n\t\t\t\t\ttemplate: oMessageTemplate\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t\toContext.getView().addDependent(oContext._MessagePopover);\r\n\t\toContext._MessagePopover.setModel(oContext._JSONModel);\r\n\t\toContext._MessagePopover.openBy(oEvent.getSource());\r\n\r\n\t}\r\n\r\n\t//---整体返回\r\n\treturn {\r\n\r\n\t\t//---处理转换OData错误消息\r\n\t\tconvertODataErrorMessage: function(oContext) {\r\n\t\t\tvar aReturn = this.getODataReturns(oContext.oError);\r\n\t\t\toContext._JSONModel.setProperty(\"/returns\", aReturn, false);\r\n\t\t\t// 调用转换消息处理事件\r\n\t\t\tthis.convertMessage(oContext, \"/returns\");\r\n\t\t},\r\n\r\n\t\t//---处理转换消息事件\r\n\t\tconvertMessage: function(oContext, sPath) {\r\n\r\n\t\t\tvar aMessageInData = oContext._JSONModel.getProperty(sPath);\r\n\t\t\tif (aMessageInData == null) {\r\n\t\t\t\taMessageInData = [];\r\n\t\t\t}\r\n\r\n\t\t\tvar aMessageItems = [];\r\n\t\t\tvar iCounterE = 0;\r\n\r\n\t\t\tfor (var i = 0; i < aMessageInData.length; i++) {\r\n\t\t\t\tvar oMessageItem = {\r\n\t\t\t\t\ttype: {\r\n\t\t\t\t\t\t\"A\": sap.ui.core.MessageType.Error,\r\n\t\t\t\t\t\t\"E\": sap.ui.core.MessageType.Error,\r\n\t\t\t\t\t\t\"W\": sap.ui.core.MessageType.Warning,\r\n\t\t\t\t\t\t\"S\": sap.ui.core.MessageType.Success,\r\n\t\t\t\t\t\t\"I\": sap.ui.core.MessageType.Information\r\n\t\t\t\t\t}[aMessageInData[i].Type] || \"\",\r\n\t\t\t\t\ttitle: aMessageInData[i].Message,\r\n\t\t\t\t\tsubtitle: aMessageInData[i].Parameter + aMessageInData[i].Field + aMessageInData[i].MessageV1,\r\n\t\t\t\t\tdescription: aMessageInData[i].Id + aMessageInData[i].Number + \"-\" + aMessageInData[i].MessageV2\r\n\t\t\t\t};\r\n\t\t\t\tif (oMessageItem.type == \"Error\") {\r\n\t\t\t\t\tiCounterE = parseInt(iCounterE) + 1;\r\n\t\t\t\t}\r\n\t\t\t\taMessageItems.push(oMessageItem);\r\n\t\t\t}\r\n\r\n\t\t\tvar oMessage = {\r\n\t\t\t\tbuttonWidth: aMessageItems.length > 0 ? \"5em\" : \"0em\",\r\n\t\t\t\tcounter: aMessageItems.length,\r\n\t\t\t\tcontent: aMessageItems,\r\n\t\t\t\tcounterE: iCounterE\r\n\t\t\t};\r\n\t\t\toContext._JSONModel.setProperty(\"/messages\", oMessage, false);\r\n\r\n\t\t},\r\n\r\n\t\t//---获取OData消息返回集\r\n\t\tgetODataReturns: function(oParameter) {\r\n\t\t\tvar oErrro = fnParseError(oParameter);\r\n\t\t\tvar sDetails = oErrro.sDetails;\r\n\t\t\tvar aErrorDetails = [];\r\n\t\t\tvar oReturn = {\r\n\t\t\t\tField: \"\",\r\n\t\t\t\tId: \"00\",\r\n\t\t\t\tLogMsgNo: \"000000\",\r\n\t\t\t\tLogNo: \"\",\r\n\t\t\t\tMessage: oErrro.sMessage,\r\n\t\t\t\tMessageV1: \"\",\r\n\t\t\t\tMessageV2: \"\",\r\n\t\t\t\tMessageV3: \"\",\r\n\t\t\t\tMessageV4: \"\",\r\n\t\t\t\tNumber: \"999\",\r\n\t\t\t\tParameter: \"\",\r\n\t\t\t\tRow: 0,\r\n\t\t\t\tSystem: \"\",\r\n\t\t\t\tType: \"E\"\r\n\t\t\t};\r\n\t\t\tvar sReturn, aReturn, oErrModel;\r\n\t\t\tif (jQuery.sap.startsWith(sDetails || \"\", \"{\\\"error\\\":\")) {\r\n\t\t\t\toErrModel = new JSONModel();\r\n\t\t\t\toErrModel.setJSON(sDetails);\r\n\t\t\t\taErrorDetails = oErrModel.getProperty(\"/error/innererror/errordetails\");\r\n\t\t\t}\r\n\r\n\t\t\tfor (var i = 0; i < aErrorDetails.length; i++) {\r\n\t\t\t\tif (aErrorDetails[i].target == \"exceptions\") {\r\n\t\t\t\t\tsReturn = aErrorDetails[i].message;\r\n\t\t\t\t\toErrModel.setJSON(sReturn);\r\n\t\t\t\t\taReturn = oErrModel.getProperty(\"/EXCEPTIONS\");\r\n\t\t\t\t\treturn aReturn;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif (!aReturn) {\r\n\t\t\t\taReturn = [];\r\n\t\t\t}\r\n\t\t\tif (aReturn && aReturn.length == 0) {\r\n\t\t\t\taReturn.push(oReturn);\r\n\t\t\t\treturn aReturn;\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\t//---展示错误消息\r\n\t\tshowODataError: function(oParameter, sTitle) {\r\n\t\t\tvar oErrorDetails = fnParseError(oParameter);\r\n\t\t\tMessageBox.show(oErrorDetails.sMessage, {\r\n\t\t\t\ticon: MessageBox.Icon.ERROR,\r\n\t\t\t\ttitle: sTitle,\r\n\t\t\t\tdetails: oErrorDetails.sDetails,\r\n\t\t\t\tactions: MessageBox.Action.CLOSE,\r\n\t\t\t\tonClose: null,\r\n\t\t\t\tstyleClass: designMode.getCompactCozyClass()\r\n\t\t\t});\r\n\t\t},\r\n\r\n\t\t//---消息文本及位置展示格式\r\n\t\tshowODataErrorText: function(oError) {\r\n\t\t\tMessageToast.show(fnParseError(oError).sMessage, {\r\n\t\t\t\twidth: \"20em\",\r\n\t\t\t\tmy: sap.ui.core.Popup.Dock.CenterCenter,\r\n\t\t\t\tat: sap.ui.core.Popup.Dock.CenterCenter\r\n\t\t\t});\r\n\t\t},\r\n\r\n\t\t//---错误类信息弹框\r\n\t\tshowError: function(sText) {\r\n\t\t\tMessageBox.error(sText, {\r\n\t\t\t\tstyleClass: designMode.getCompactCozyClass()\r\n\t\t\t});\r\n\t\t},\r\n\r\n\t\t//---警告类信息弹框\r\n\t\tshowWarning: function(sText) {\r\n\t\t\tMessageBox.warning(sText, {\r\n\t\t\t\tstyleClass: designMode.getCompactCozyClass()\r\n\t\t\t});\r\n\t\t},\r\n\r\n\t\t//---信息类信息弹框类\r\n\t\tshowInformation: function(sText) {\r\n\t\t\tMessageBox.information(sText, {\r\n\t\t\t\tstyleClass: designMode.getCompactCozyClass()\r\n\t\t\t});\r\n\t\t},\r\n\r\n\t\t//---Toast形式展示消息\r\n\t\tshowText: function(sText) {\r\n\t\t\tMessageToast.show(sText, {\r\n\t\t\t\twidth: \"20em\",\r\n\t\t\t\tmy: sap.ui.core.Popup.Dock.Center,\r\n\t\t\t\tat: sap.ui.core.Popup.Dock.Center\r\n\t\t\t});\r\n\t\t},\r\n\r\n\t\t//---展示消息按钮\r\n\t\tshowMessagePopover: function(oContext, oEvent) {\r\n\t\t\tcreateMessagePopover(oContext, oEvent);\r\n\t\t},\r\n\r\n\t\t//---创建消息按钮\r\n\t\tcreateMessageButton: function(oContext) {\r\n\r\n\t\t\tvar oView = oContext.getView();\r\n\t\t\tif (oView.getMetadata()._sClassName != \"sap.ui.core.mvc.XMLView\") {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tif (!oView.getContent() || oView.getContent().length == 0) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tif (oView.getContent()[0].getMetadata()._sClassName != \"sap.m.Page\") {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tvar oPage = oView.getContent()[0];\r\n\t\t\tvar oBlankBar = new Bar();\r\n\t\t\tvar oBlankButton = new Button({\r\n\t\t\t\twidth: \"0em\"\r\n\t\t\t});\r\n\r\n\t\t\tif (oPage.getCustomHeader() == null) {\r\n\t\t\t\toPage.addAggregation(\"customHeader\", oBlankBar);\r\n\t\t\t}\r\n\t\t\tvar oCustHeader = oPage.getCustomHeader();\r\n\r\n\t\t\tif (!oContext._MessageButton) {\r\n\t\t\t\toContext._MessageButton = new Button({\r\n\t\t\t\t\ttext: \"{/messages/counter}\",\r\n\t\t\t\t\ttype: \"Emphasized\",\r\n\t\t\t\t\ticon: \"sap-icon://message-popup\",\r\n\t\t\t\t\twidth: \"{/messages/buttonWidth}\",\r\n\t\t\t\t\tvisible: true,\r\n\t\t\t\t\tpress: function(oEvent) {\r\n\t\t\t\t\t\tcreateMessagePopover(oContext, oEvent);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\toCustHeader.insertContentLeft(oContext._MessageButton, 0);\r\n\t\t\t\tif (oCustHeader.getContentMiddle().length == 0) {\r\n\t\t\t\t\toCustHeader.insertContentMiddle(oBlankButton, 0);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\t//---确认信息处理\r\n\t\tconfirmAction: function(sTitle, sText, sChannelId, sEventId, oContext) {\r\n\t\t\tMessageBox.confirm(sText, {\r\n\t\t\t\ttitle: sTitle,\r\n\t\t\t\ticon: MessageBox.Icon.WARNING,\r\n\t\t\t\tactions: [\r\n\t\t\t\t\tMessageBox.Action.YES, MessageBox.Action.NO\r\n\t\t\t\t],\r\n\t\t\t\tonClose: function(sResult) {\r\n\t\t\t\t\toContext._result = sResult;\r\n\t\t\t\t\t// 发布事件\r\n\t\t\t\t\toContext.getEventBus().publish(sChannelId, sEventId, oContext);\r\n\t\t\t\t},\r\n\t\t\t\tstyleClass: designMode.getCompactCozyClass()\r\n\t\t\t});\r\n\t\t}\r\n\t};\r\n});",
		"ZAPI_VIEW/controller/view7.controller.js": "/* ======================================== */\r\n/* helloWorld MVC 中control 实现            */\r\n/* ======================================== */\r\nsap.ui.define([\"./BaseController\",\r\n\t\"sap/ui/model/json/JSONModel\",\r\n\t\"sap/ui/model/Filter\",\r\n\t\"sap/ui/model/FilterOperator\",\r\n\t\"sap/m/MessageToast\",\r\n\t\"sap/m/MessageBox\",\r\n\t'sap/ui/model/SimpleType',\r\n\t'sap/ui/model/ValidateException',\r\n\t\"./messages\"\r\n], function(BaseController, JSONModel, Filter, FilterOperator, MessageToast, MessageBox, SimpleType, ValidateException, messages) {\r\n\t\"use strict\";\r\n\r\n\treturn BaseController.extend(\"ZAPI_VIEW.controller.view7\", {\r\n\r\n\t\t/* ======================================== */\r\n\t\t/* lifecycle methods                        */\r\n\t\t/* ======================================== */\r\n\t\tonInit: function() {\r\n\t\t\tthis._ODataModel = this.getModel(\"OData\");\r\n\t\t\t//this._ResourceBundle = this.getModel( \"i18n\" ).getResourceBundle();\r\n\t\t\tthis._JSONModel = this.getModel();\r\n\t\t\t\r\n\t\t},\r\n\t\tonSnapshot: function(oEvent) {\r\n\t\t\tvar oCamera = this.getView().byId(\"idCamera\");\r\n\t\t\toCamera.rerender();\r\n\t\t\toCamera.stopCamera();\r\n\t\t\tthis._JSONModel.setProperty(\"/image6Set/np_table/0/Image\", oEvent.getParameter(\"image\"));\r\n\t\t\tthis._JSONModel.setProperty(\"/image6Set/visible1\", false);\r\n\t\t\tthis._JSONModel.setProperty(\"/image6Set/visible2\", true);\r\n\t\t},\r\n\r\n\t\tonPressImagehuawer: function(oEvent) {\r\n\t\t\t// this._JSONModel.setProperty(\"/image6Set/np_table/0/Image\", \"\");\r\n\t\t\t// var oCamera = this.getView().byId(\"idCamera\");\r\n\t\t\t// oCamera.onAfterRendering();\r\n\t\t\t// this._JSONModel.setProperty(\"/image6Set/visible1\", true);\r\n\t\t\t// this._JSONModel.setProperty(\"/image6Set/visible2\", false);\r\n\t\t\tvar audio = newAudio('audio_file.mp3');\r\n\t\t\taudio.play();\r\n\t\t}\r\n\r\n\t});\r\n});",
		"ZAPI_VIEW/controller/view2.controller.js": "/* ======================================== */\r\n/* helloWorld MVC 中control 实现            */\r\n/* ======================================== */\r\nsap.ui.define([\"./BaseController\",\r\n\t\"sap/ui/model/json/JSONModel\",\r\n\t\"sap/ui/model/Filter\",\r\n\t\"sap/ui/model/FilterOperator\",\r\n\t\"sap/m/MessageToast\",\r\n\t\"sap/m/MessageBox\",\r\n\t'sap/ui/model/SimpleType',\r\n\t'sap/ui/model/ValidateException',\r\n\t\"./messages\"\r\n], function(BaseController, JSONModel, Filter, FilterOperator, MessageToast, MessageBox, SimpleType, ValidateException, messages) {\r\n\t\"use strict\";\r\n\r\n\treturn BaseController.extend(\"ZAPI_VIEW.controller.view2\", {\r\n\r\n\t\t/* ======================================== */\r\n\t\t/* lifecycle methods                        */\r\n\t\t/* ======================================== */\r\n\t\tonInit: function() {\r\n\t\t\tthis._ODataModel = this.getModel(\"OData\");\r\n\t\t\t//this._ResourceBundle = this.getModel( \"i18n\" ).getResourceBundle();\r\n\t\t\tthis._JSONModel = this.getModel();\r\n\r\n\t\t},\r\n\r\n\t\tonAfterRendering: function() {\r\n\r\n\t\t},\r\n\r\n\t\tonPressImagehuawer: function(oControlEvent) {\r\n\t\t\tvar recognitionSet = {\r\n\t\t\t\tnp_recognitionimage: [{\r\n\t\t\t\t\t\"Image\": \"\"\r\n\t\t\t\t}],\r\n\t\t\t\tnp_recognitionitem: []\r\n\t\t\t};\r\n\r\n\t\t\tthis._JSONModel.setProperty(\"/recognitionSet\", recognitionSet);\r\n\t\t\tthis.setBusy(true);\r\n\t\t\tthis._JSONModel.setProperty(\"/busy\", true);\r\n\t\t\tvar oFile = this.getView().byId(\"fileUploader\");\r\n\t\t\t// 为空选择文件提示\r\n\t\t\tif (!oFile.getValue()) {\r\n\t\t\t\tmessages.showText(\"请选择文件\");\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\t// 文件DOM \r\n\t\t\tvar that = this;\r\n\t\t\tvar domRef = oFile.getFocusDomRef();\r\n\t\t\tvar reader = new FileReader();\r\n\t\t\tvar file = domRef.files[0];\r\n\t\t\treader.readAsDataURL(file);\r\n\t\t\tvar image = \"\";\r\n\t\t\treader.that = this;\r\n\t\t\treader.onload = function(e) {\r\n\t\t\t\t// alert(1);\r\n\t\t\t\timage = e.target.result;\r\n\t\t\t\tvar Image = image.replace(/data:image\\/.*;base64,/, '');\r\n\t\t\t\tthat._JSONModel.setProperty(\"/recognitionSet/np_recognitionimage/0/Image\", Image);\r\n\t\t\t\tthat.upload();\r\n\t\t\t};\r\n\t\t},\r\n\r\n\t\tupload: function(oControlEvent) {\r\n\r\n\t\t\tvar oRequest = this._JSONModel.getData().recognitionSet;\r\n\t\t\toRequest.np_recognitionimage = !oRequest.np_recognitionimage ? [] : oRequest.np_recognitionimage;\r\n\t\t\toRequest.np_recognitionitem = !oRequest.np_recognitionitem ? [] : oRequest.np_recognitionitem;\r\n\t\t\tvar sUrl = \"/recognitionSet\";\r\n\t\t\tvar mParameters = {\r\n\t\t\t\tsuccess: function(oData, response) {\r\n\t\t\t\t\tvar localData = this._JSONModel.getData();\r\n\t\t\t\t\tlocalData.recognitionSet = oData;\r\n\t\t\t\t\tlocalData.recognitionSet.np_recognitionimage = oData.np_recognitionimage != null ? oData.np_recognitionimage.results : null;\r\n\t\t\t\t\tlocalData.recognitionSet.np_recognitionitem = oData.np_recognitionitem != null ? oData.np_recognitionitem.results : null;\r\n\t\t\t\t\tthis._JSONModel.setProperty(\"/\", localData, false);\r\n\t\t\t\t\t// if (localData.recognitionSet.MsgType == \"S\") {\r\n\t\t\t\t\t// \tmessages.showInformation(localData.recognitionSet.Msg);\r\n\t\t\t\t\t// } else {\r\n\t\t\t\t\t// \tmessages.showWarning(localData.recognitionSet.Msg);\r\n\t\t\t\t\t// }\r\n\t\t\t\t\tthis.setBusy(false);\r\n\t\t\t\t\tthis._JSONModel.setProperty(\"/busy\", false);\r\n\t\t\t\t}.bind(this),\r\n\t\t\t\terror: function(oError) {\r\n\t\t\t\t\tthis.setBusy(false);\r\n\t\t\t\t\tthis._JSONModel.setProperty(\"/busy\", false);\r\n\t\t\t\t}.bind(this)\r\n\t\t\t};\r\n\t\t\tthis._ODataModel.create(sUrl, oRequest, mParameters);\r\n\t\t},\r\n\r\n\t\topPressPost: function() {\r\n\t\t\tthis.setBusy(true);\r\n\t\t\tthis._JSONModel.setProperty(\"/busy\", true);\r\n\t\t\tvar Guid = this._JSONModel.getProperty(\"/recognitionSet/Guid\");\r\n\t\t\t// var oRequest = this._JSONModel.getData().np_recognitionitem;\r\n\t\t\t// oRequest.Guid = Guid;\r\n\t\t\t// oRequest.np_Delivery_post = !oRequest.np_Delivery_post ? [] : oRequest.np_Delivery_post;\r\n\t\t\tvar oRequest = {\r\n\t\t\t\tGuid: Guid,\r\n\t\t\t\tnp_Delivery_post: []\r\n\t\t\t};\r\n\t\t\tvar sUrl = \"/Delivery_postSet\";\r\n\t\t\tvar mParameters = {\r\n\t\t\t\tsuccess: function(oData, response) {\r\n\t\t\t\t\tvar localData = this._JSONModel.getData();\r\n\t\t\t\t\tlocalData.Delivery_postSet = oData;\r\n\t\t\t\t\tlocalData.Delivery_postSet.np_Delivery_post = oData.np_Delivery_post != null ? oData.np_Delivery_post.results : null;\r\n\t\t\t\t\tthis._JSONModel.setProperty(\"/\", localData, false);\r\n\t\t\t\t\tthis.setBusy(false);\r\n\t\t\t\t\tthis._JSONModel.setProperty(\"/busy\", false);\r\n\r\n\t\t\t\t\tvar message = this._JSONModel.getProperty(\"/Delivery_postSet/np_Delivery_post\");\r\n\t\t\t\t\tif (message.length > 0) {\r\n\t\t\t\t\t\tif (message[0].Type == \"S\") {\r\n\t\t\t\t\t\t\tmessages.showInformation(message[0].Message);\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tmessages.showWarning(message[0].Message);\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t}.bind(this),\r\n\t\t\t\terror: function(oError) {\r\n\t\t\t\t\tthis.setBusy(false);\r\n\t\t\t\t\tthis._JSONModel.setProperty(\"/busy\", false);\r\n\t\t\t\t}.bind(this)\r\n\t\t\t};\r\n\t\t\tthis._ODataModel.create(sUrl, oRequest, mParameters);\r\n\t\t}\r\n\r\n\t});\r\n});",
		"ZAPI_VIEW/controller/BaseController.js": "/* =========================================================== */\r\n/* 公用控制器（基础函数功能实现包）                            */\r\n/* =========================================================== */\r\nsap.ui.define([\"sap/ui/core/mvc/Controller\",\r\n\t\"sap/ui/core/UIComponent\",\r\n\t\"sap/ui/core/routing/History\",\r\n\t\"../model/formatter\"\r\n], function(Controller, UIComponent, History, formatter) {\r\n\t//---JS 严格模式\r\n\t\"use strict\";\r\n\r\n\treturn Controller.extend(\"ZAPI_VIEW.controller.BaseController\", {\r\n\r\n\t\t//---格式  \r\n\t\tformatter: formatter,\r\n\r\n\t\t//---获取EventBus\r\n\t\tgetEventBus: function() {\r\n\t\t\treturn this.getOwnerComponent().getEventBus();\r\n\t\t},\r\n\r\n\t\t//---获取Router(路由实例)\r\n\t\tgetRouter: function() {\r\n\t\t\treturn UIComponent.getRouterFor(this);\r\n\t\t},\r\n\r\n\t\t//---获取RouterId(路由Id)\r\n\t\tgetRouterID: function() {\r\n\t\t\tvar oHC = this.getRouter().oHashChanger;\r\n\t\t\tif (oHC.privgetCurrentShellHash) {\r\n\t\t\t\tvar sHash = oHC.privgetCurrentShellHash().hash;\r\n\t\t\t\tvar s = oHC.privstripLeadingHash(sHash).split(\"-\")[0];\r\n\t\t\t\ts = s && s === \"Shell-home\" ? null : s;\r\n\t\t\t\treturn s;\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t//---跳转\r\n\t\tnavTo: function(sName) {\r\n\t\t\treturn sName == null ? null : this.getRouter().navTo(sName);\r\n\t\t},\r\n\r\n\t\t//---获取模型\r\n\t\tgetModel: function(sName) {\r\n\t\t\treturn this.getView().getModel(sName) || this.getOwnerComponent().getModel(sName);\r\n\t\t},\r\n\r\n\t\t// 获取OData元数据\r\n\t\tgetODataMetadata: function(sName) {\r\n\t\t\tif (sName == \"\") {\r\n\t\t\t\treturn null;\r\n\t\t\t}\r\n\t\t\tvar oMetaData = this.getModel().getProperty(\"/ODataMetadata\");\r\n\t\t\treturn oMetaData[sName];\r\n\t\t},\r\n\r\n\t\t//---获取OData服务EntityType\r\n\t\tgetEntityTypeByName: function(sODataName, sEntityTypeName) {\r\n\t\t\tif (!this.getODataMetadata(sODataName)) {\r\n\t\t\t\treturn null;\r\n\t\t\t}\r\n\t\t\treturn this.getODataMetadata(sODataName)._getEntityTypeByName(sEntityTypeName);\r\n\t\t},\r\n\r\n\t\t//---设置模型\r\n\t\tsetModel: function(oModel, sName) {\r\n\t\t\treturn this.getView().setModel(oModel, sName);\r\n\t\t},\r\n\r\n\t\t//---获取资源包\r\n\t\tgetResourceBundle: function() {\r\n\t\t\treturn this.getOwnerComponent().getModel(\"i18n\").getResourceBundle();\r\n\t\t},\r\n\r\n\t\t//---设置busy状态\r\n\t\tsetBusy: function(b) {\r\n\t\t\tthis.getModel().setProperty(\"/appProperties/busy\", b);\r\n\t\t},\r\n\r\n\t\t//---设置bcode的值(同步方式)\r\n\t\tsetbcode: function(v) {\r\n\t\t\tthis.getModel().setProperty(\"/appProperties/bcode\", v, false);\r\n\t\t},\r\n\r\n\t\t//---获取bcode的值\r\n\t\tgetbcode: function(v) {\r\n\t\t\treturn this.getModel().getProperty(\"/appProperties/bcode\");\r\n\t\t},\r\n\r\n\t\t//---设置fcode的值(同步方式)\r\n\t\tsetfcode: function(v) {\r\n\t\t\tthis.getModel().setProperty(\"/appProperties/fcode\", v, false);\r\n\t\t},\r\n\r\n\t\t//---是否是E类型消息\r\n\t\tisError: function(oContext) {\r\n\t\t\tvar iCounterE = oContext.getModel().getProperty(\"/messages/counterE\");\r\n\t\t\treturn iCounterE > 0 ? true : false;\r\n\t\t},\r\n\r\n\t\t//---页面左上角message按钮弹框\r\n\t\topenMessagePopover: function(oContext) {\r\n\t\t\tif (oContext._MessageButton && this.isError(oContext)) {\r\n\t\t\t\toContext._MessageButton.firePress();\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t//---返回消息处理\r\n\t\tupdateObligatory: function() {\r\n\t\t\tvar oObligatory = {};\r\n\t\t\tvar aReturn = this.getModel().getProperty(\"/returns\");\r\n\t\t\tfor (var i = 0; i < aReturn.length; i++) {\r\n\t\t\t\tif (aReturn[i].MessageV1 != \"\" && aReturn[i].Type == \"E\") {\r\n\r\n\t\t\t\t\tvar oR = {\r\n\t\t\t\t\t\tId: aReturn[i].Id,\r\n\t\t\t\t\t\tLogMsgNo: aReturn[i].LogMsgNo,\r\n\t\t\t\t\t\tLogNo: aReturn[i].LogNo,\r\n\t\t\t\t\t\tMessage: aReturn[i].Message,\r\n\t\t\t\t\t\tMessageV1: aReturn[i].MessageV1,\r\n\t\t\t\t\t\tMessageV2: aReturn[i].MessageV2,\r\n\t\t\t\t\t\tMessageV3: aReturn[i].MessageV3,\r\n\t\t\t\t\t\tMessageV4: aReturn[i].MessageV4,\r\n\t\t\t\t\t\tNumber: aReturn[i].Number,\r\n\t\t\t\t\t\tRow: aReturn[i].Row,\r\n\t\t\t\t\t\tSystem: aReturn[i].System\r\n\t\t\t\t\t};\r\n\r\n\t\t\t\t\tif (aReturn[i].MessageV2 != \"\") {\r\n\t\t\t\t\t\tif (!oObligatory[aReturn[i].MessageV1]) {\r\n\t\t\t\t\t\t\toObligatory[aReturn[i].MessageV1] = {};\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\toObligatory[aReturn[i].MessageV1][aReturn[i].MessageV2] = oR;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (aReturn[i].MessageV2 == \"\") {\r\n\t\t\t\t\t\toObligatory[aReturn[i].MessageV1] = oR;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tthis.getModel().setProperty(\"/verReturn\", oObligatory, false);\r\n\r\n\t\t},\r\n\r\n\t\t//---清除组件上必输错误状态标记\r\n\t\tclearInputRequiredErrorStatus: function(oEvent) {\r\n\t\t\tvar sRootPath = \"/verReturn\";\r\n\t\t\tvar sPath = oEvent.getSource().getBinding(\"valueState\").sPath;\r\n\t\t\tif (sPath == \"\") {\r\n\t\t\t\tvar aBindings = oEvent.getSource().getBinding(\"valueState\").aBindings;\r\n\t\t\t\tsPath = aBindings[0].sPath + \"/\" + aBindings[1].oValue;\r\n\t\t\t}\r\n\t\t\tvar oVerReturn = this._JSONModel.getProperty(sRootPath);\r\n\t\t\tsPath = sPath.replace(sRootPath + \"/\", \"\");\r\n\t\t\tvar aKey = sPath.split(\"/\", 2);\r\n\t\t\tif (aKey.length == 1) {\r\n\t\t\t\tdelete oVerReturn[aKey[0]];\r\n\t\t\t}\r\n\t\t\tif (aKey.length == 2) {\r\n\t\t\t\tdelete oVerReturn[aKey[0]][aKey[1]];\r\n\t\t\t\t// 表格中错误状态无法自动置空，需强制清理\r\n\t\t\t\toEvent.getSource().setValueState(\"None\");\r\n\t\t\t}\r\n\t\t\tthis._JSONModel.setProperty(sRootPath, oVerReturn, false);\r\n\t\t},\r\n\r\n\t\t//---获取页面的聚合内容\r\n\t\tgetPage: function() {\r\n\t\t\tvar oView = this.getView();\r\n\t\t\tif (oView.getMetadata()._sClassName != \"sap.ui.core.mvc.XMLView\") {\r\n\t\t\t\treturn null;\r\n\t\t\t}\r\n\t\t\tif (!oView.getContent() || oView.getContent().length == 0) {\r\n\t\t\t\treturn null;\r\n\t\t\t}\r\n\t\t\tif (oView.getContent()[0].getMetadata()._sClassName != \"sap.m.Page\") {\r\n\t\t\t\treturn null;\r\n\t\t\t}\r\n\t\t\treturn oView.getContent()[0];\r\n\t\t},\r\n\r\n\t\t//---生成32位随机数\r\n\t\tcreateGUID: function() {\r\n\t\t\tvar g = \"\";\r\n\t\t\tvar i = 32;\r\n\t\t\twhile (i--) {\r\n\t\t\t\tg += Math.floor(Math.random() * 16.0).toString(16);\r\n\t\t\t}\r\n\t\t\treturn g;\r\n\t\t},\r\n\r\n\t\t//---重写克隆方法\r\n\t\tclone: function(obj, sub) {\r\n\t\t\tvar o;\r\n\t\t\tif (obj.constructor == Object) {\r\n\t\t\t\to = new obj.constructor();\r\n\t\t\t} else {\r\n\t\t\t\to = new obj.constructor(obj.valueOf());\r\n\t\t\t}\r\n\t\t\tfor (var key in obj) {\r\n\t\t\t\tif (o[key] != obj[key]) {\r\n\t\t\t\t\tif (typeof(obj[key]) == 'object') {\r\n\t\t\t\t\t\to[key] = this.clone(obj[key]);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\to[key] = obj[key];\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\to.toString = obj.toString;\r\n\t\t\to.valueOf = obj.valueOf;\r\n\t\t\treturn o;\r\n\t\t},\r\n\r\n\t\t//---返回事件\r\n\t\tonNavBack: function() {\r\n\t\t\tif (History.getInstance().getPreviousHash() !== undefined) {\r\n\t\t\t\thistory.go(-1);\r\n\t\t\t} else {\r\n\t\t\t\tthis.getRouter().navTo(\"\", {}, true);\r\n\t\t\t}\r\n\t\t}\r\n\t});\r\n});",
		"ZAPI_VIEW/controller/designMode.js": "/* =========================================================== */\r\n/* 设计模式                                                    */\r\n/* =========================================================== */\r\nsap.ui.define([\"sap/ui/Device\"], function(Device) {\r\n\t//---严格JS 模式\r\n\t\"use strict\";\r\n\r\n\t// 定义 设备支持的UI样式(舒适/紧密)类，特殊说明：此处所有设备设置为紧密型UI样式\r\n\t//\tvar sCompactCozyClass = Device.support.touch ? \"sapUiSizeCozy\" : \"sapUiSizeCompact\";\r\n\tvar sCompactCozyClass = \"sapUiSizeCompact\";\r\n\r\n\treturn {\r\n\t\t//---获取 设备UI样式类\r\n\t\tgetCompactCozyClass: function() {\r\n\t\t\treturn sCompactCozyClass;\r\n\t\t},\r\n\r\n\t\t//---引用jQuery.sap.syncStyleClass()方法\r\n\t\tsyncStyleClass: function(oView, oControl) {\r\n\t\t\tjQuery.sap.syncStyleClass(sCompactCozyClass, oView, oControl);\r\n\t\t}\r\n\t};\r\n});",
		"ZAPI_VIEW/controller/view6.controller.js": "/* ======================================== */\r\n/* helloWorld MVC 中control 实现            */\r\n/* ======================================== */\r\nsap.ui.define([\"./BaseController\",\r\n\t\"sap/ui/model/json/JSONModel\",\r\n\t\"sap/ui/model/Filter\",\r\n\t\"sap/ui/model/FilterOperator\",\r\n\t\"sap/m/MessageToast\",\r\n\t\"sap/m/MessageBox\",\r\n\t'sap/ui/model/SimpleType',\r\n\t'sap/ui/model/ValidateException',\r\n\t\"./messages\"\r\n], function(BaseController, JSONModel, Filter, FilterOperator, MessageToast, MessageBox, SimpleType, ValidateException, messages) {\r\n\t\"use strict\";\r\n\r\n\treturn BaseController.extend(\"ZAPI_VIEW.controller.view6\", {\r\n\r\n\t\t/* ======================================== */\r\n\t\t/* lifecycle methods                        */\r\n\t\t/* ======================================== */\r\n\t\tonInit: function() {\r\n\t\t\tthis._ODataModel = this.getModel(\"OData\");\r\n\t\t\t//this._ResourceBundle = this.getModel( \"i18n\" ).getResourceBundle();\r\n\t\t\tthis._JSONModel = this.getModel();\r\n\r\n\t\t},\r\n\t\tonSnapshot: function(oEvent) {\r\n\t\t\tvar oCamera = this.getView().byId(\"idCamera\");\r\n\t\t\toCamera.rerender();\r\n\t\t\toCamera.stopCamera();\r\n\t\t\tthis._JSONModel.setProperty(\"/temp/Image\", oEvent.getParameter(\"image\"));\r\n\t\t\tthis._JSONModel.setProperty(\"/temp/visible1\", true);\r\n\t\t\tthis._JSONModel.setProperty(\"/temp/visible2\", false);\r\n\t\t},\r\n\r\n\t\tonPressImagehuawer: function(oEvent) {\r\n\t\t\tthis._JSONModel.setProperty(\"/temp/Image\", \"\");\r\n\t\t\tvar oCamera = this.getView().byId(\"idCamera\");\r\n\t\t\toCamera.onAfterRendering();\r\n\t\t\tthis._JSONModel.setProperty(\"/temp/visible1\", false);\r\n\t\t\tthis._JSONModel.setProperty(\"/temp/visible2\", true);\r\n\t\t}\r\n\r\n\t});\r\n});",
		"ZAPI_VIEW/view/App.view.xml": "<!-- App视图：\r\n     1.xmlns 声明 xml 命名空间，sap.ui.layout、sap.ui.cor.mvc、sap.ui.core、sap.m,\r\n            说明xmlns:mvc 其中 mvc 为别名，后续使用中会使用前缀(别名)加标签方式指定标签来源；\r\n     2.controllerName 指定控制器文件，ZTR18_3135_3003.controller.App;\r\n     3.App 标签使用;\r\n-->\r\n<mvc:View xmlns=\"sap.m\" xmlns:mvc=\"sap.ui.core.mvc\" controllerName=\"ZAPI_VIEW.controller.App\"  busy=\"{/busy}\">\r\n\t<App id=\"appNavContainer\" backgroundImage=\"\" backgroundOpacity=\"0.3\"/>\r\n</mvc:View>",
		"ZAPI_VIEW/model/formatter.js": "/* =========================================================== */\r\n/* App 格式实现（Utility for formatting values）               */\r\n/* =========================================================== */\r\nsap.ui.define([\r\n\t\t\"sap/ui/core/format/DateFormat\", \"sap/ui/core/format/NumberFormat\", \"sap/ui/core/Component\"\r\n], function(DateFormat, NumberFormat, Component) {\r\n\t\"use strict\";\r\n\r\n\t// 获取资源包\r\n\tfunction fnGetBundle(oControl) {\r\n\t\treturn (oControl.getModel(\"i18n\") || sap.ui.component(Component.getOwnerIdFor(oControl)).getModel(\"i18n\"))\r\n\t\t\t\t.getResourceBundle();\r\n\t}\r\n\r\n\tvar fnDateAgoFormatter = DateFormat.getDateInstance({\r\n\t\tstyle : \"medium\",\r\n\t\tstrictParsing : true,\r\n\t\trelative : true }), fnAmountFormatter = NumberFormat.getCurrencyInstance(), fnDeliveryDateFormatter = DateFormat\r\n\t\t\t.getDateInstance({\r\n\t\t\t\tstyle : \"medium\" });\r\n\r\n\tvar me = {\r\n\r\n\t  // 转换UIC配置\r\n\t\tconvertUIC : function(aUIC) {\r\n\t\t\tif (!jQuery.isArray(aUIC)) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tvar oUIC = {};\r\n\t\t\tfor (var i = 0; i < aUIC.length; i++) {\r\n\t\t\t\tvar sAttr = aUIC[i].Ueid;\r\n\t\t\t\toUIC[sAttr] = {\r\n\t\t\t\t\tSetf : aUIC[i].Setf,\r\n\t\t\t\t\tVisible : aUIC[i].Visible,\r\n\t\t\t\t\tEditable : aUIC[i].Editable,\r\n\t\t\t\t\tRequire : aUIC[i].Require };\r\n\t\t\t}\r\n\t\t\treturn oUIC;\r\n\t\t},\r\n\r\n\t\t// 设置元素VER属性(Visible,Editable,Require)\r\n\t\tsetElementVER : function(v) {\r\n\t\t\tif (v) {\r\n\t\t\t\treturn v;\r\n\t\t\t}\r\n\t\t\treturn false;\r\n\t\t},\r\n\r\n\t\t// 设置元素状态属性(valueState)\r\n\t\tsetElementVERvS : function(r) {\r\n\t\t\tif (r) {\r\n\t\t\t\treturn \"Error\";\r\n\t\t\t}\r\n\t\t\treturn \"None\";\r\n\t\t},\r\n\r\n\t\t// 设置Table表上元素VERS属性(Visible,Editable,Require,valueState)\r\n\t\tsetElementTVERvS : function(r, g) {\r\n\t\t\tif (r && r[g]) {\r\n\t\t\t\treturn \"Error\";\r\n\t\t\t}\r\n\t\t\treturn \"None\";\r\n\t\t},\r\n\t\t\r\n\t\t// 日期格式化\r\n\t\tdateString : function(value){\r\n\t\t\tif (value != \"\" && value != null){\r\n\t\t\tvar year = value.substring(0,4);\r\n\t\t\tvar month = value.substring(4,6);\r\n\t\t\tvar day = value.substring(6,8);\r\n\t\t\treturn year+\"-\"+month+\"-\"+day;\r\n\t\t\t}else{\r\n\t\t\t\treturn value;\r\n\t\t\t}\r\n\t\t},\r\n\t\t\r\n\t\t// 时间格式化\r\n\t\ttimeString : function(value){\r\n\t\t\tif (value != \"\" && value != null){\r\n\t\t\tvar hour = value.substring(0,2);\r\n\t\t\tvar minute = value.substring(2,4);\r\n\t\t\tvar seconds = value.substring(4,6);\r\n\t\t\treturn hour+\":\"+minute + \":\"+seconds;\r\n\t\t\t}else{\r\n\t\t\t\treturn value;\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t// 去后导零\r\n\t\tdeleteRightZero : function(v)// 去后导零\r\n\t\t{\r\n\t\t\tif (v === null || v === undefined || v === 0 || v === \"0\") {\r\n\t\t\t\tv = 0;\r\n\t\t\t}\r\n\t\t\treturn parseFloat(v);\r\n\t\t},\r\n\r\n\t\t// 去前导零\r\n\t\tdeleteLeftZero : function(v)// 去前导零\r\n\t\t{\r\n\t\t\tif (v === null || v === undefined || v === 0 || v === \"0\") {\r\n\t\t\t\tv = \"0\";\r\n\t\t\t}\r\n\t\t\treturn v.replace(/^0+/, \"\");\r\n\t\t},\r\n\r\n\t\t// 展示信息\r\n\t\tshowMessage : function(v) {\r\n\t\t\tif (v > 0) {\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t\treturn false;\r\n\t\t},\r\n\r\n\t\tdaysAgo : function(dDate) {\r\n\t\t\tif (!dDate) {\r\n\t\t\t\treturn \"\";\r\n\t\t\t}\r\n\t\t\treturn fnDateAgoFormatter.format(dDate);\r\n\t\t},\r\n\t\t\r\n\t\t// 时间格式化\r\n\t\tcustomTime : function(value) {\r\n\t\t\tif (value && value.ms) {\r\n\t\t\t\tvar timeFormat = sap.ui.core.format.DateFormat.getTimeInstance({\r\n\t\t\t\t\tpattern : \"HH:mm:ss\" });\r\n\t\t\t\tvar TZOffsetMs = new Date(0).getTimezoneOffset() * 60 * 1000;\r\n\t\t\t\tvar timeStr = timeFormat.format(new Date(value.ms + TZOffsetMs));\r\n\r\n\t\t\t\treturn timeStr;\r\n\t\t\t}\r\n\t\t},\r\n\t\t\r\n\t\t// 当前日期格式成string类型\r\n\t\tyyyymmdd : function(day){\r\n\t\t\tvar mm = day.getMonth() + 1 ;\r\n\t\t\tvar dd = day.getDate();\r\n\t\t\treturn [day.getFullYear(),\r\n\t\t\t\t\t(mm > 9 ? '' : '0') + mm,\r\n\t\t\t\t\t(dd > 9 ? '' : '0') + dd].join('');\r\n\t\t},\r\n\t\t\r\n\t\t// 日期格式化\r\n\t\tdate : function(value) {\r\n\t\t\tif (value) {\r\n\t\t\t\tvar oDateFormat = sap.ui.core.format.DateFormat.getDateTimeInstance({\r\n\t\t\t\t\tpattern : \"yyyy-MM-dd\" });\r\n\t\t\t\treturn oDateFormat.format(new Date(value));\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\treturn value;\r\n\t\t\t}\r\n\t\t},\r\n\t\t\r\n\t\t\r\n\t\tcheckBoxSelected : function(v) {\r\n\t\t\treturn Boolean(v);\r\n\t\t},\r\n\r\n\t\tgetElementVER : function(v) {\r\n\t\t\tif (v) {\r\n\t\t\t\treturn v;\r\n\t\t\t}\r\n\t\t\treturn false;\r\n\t\t},\r\n\r\n\t\tgetElementVERvS : function(r) {\r\n\t\t\tif (r) {\r\n\t\t\t\treturn \"Error\";\r\n\t\t\t}\r\n\t\t\treturn \"None\";\r\n\t\t},\r\n\r\n\t\tgetElementTVERvS : function(r, g) {\r\n\t\t\tif (r[g] != undefined) {\r\n\t\t\t\treturn \"Error\";\r\n\t\t\t}\r\n\t\t\treturn \"None\";\r\n\t\t},\r\n\r\n\t };\r\n\r\n\treturn me;\r\n});",
		"ZAPI_VIEW/controller/view1.controller.js": "/* ======================================== */\r\n/* helloWorld MVC 中control 实现            */\r\n/* ======================================== */\r\nsap.ui.define([\"./BaseController\",\r\n\t\"sap/ui/model/json/JSONModel\",\r\n\t\"sap/ui/model/Filter\",\r\n\t\"sap/ui/model/FilterOperator\",\r\n\t\"sap/m/MessageToast\",\r\n\t\"sap/m/MessageBox\",\r\n\t'sap/ui/model/SimpleType',\r\n\t'sap/ui/model/ValidateException',\r\n\t\"./messages\"\r\n], function(BaseController, JSONModel, Filter, FilterOperator, MessageToast, MessageBox, SimpleType, ValidateException, messages) {\r\n\t\"use strict\";\r\n\r\n\treturn BaseController.extend(\"ZAPI_VIEW.controller.view1\", {\r\n\r\n\t\t/* ======================================== */\r\n\t\t/* lifecycle methods                        */\r\n\t\t/* ======================================== */\r\n\t\tonInit: function() {\r\n\t\t\tthis._ODataModel = this.getModel(\"OData\");\r\n\t\t\t//this._ResourceBundle = this.getModel( \"i18n\" ).getResourceBundle();\r\n\t\t\tthis._JSONModel = this.getModel();\r\n\r\n\t\t},\r\n\r\n\t\tonAfterRendering: function() {\r\n\r\n\t\t\tvar sUrl = \"/zdataSet(Name1='1',Password='1',Name2='1')\";\r\n\t\t\t// this._JSONModel.setProperty(\"/busy\", true);\r\n\t\t\t// this.setBusy(true);\r\n\t\t\tvar mParameters = {\r\n\t\t\t\tsuccess: function(oData, response) {\r\n\t\t\t\t\tvar localData = this._JSONModel.getData();\r\n\t\t\t\t\tthis._JSONModel.setProperty(\"/zdataSet\", oData);\r\n\t\t\t\t\tthis._JSONModel.setProperty(\"/busy\", false);\r\n\t\t\t\t\tthis.setBusy(false);\r\n\t\t\t\t}.bind(this),\r\n\t\t\t\terror: function(oError) {\r\n\t\t\t\t\tmessages.showODataErrorText(oError);\r\n\t\t\t\t\tthis.setBusy(false);\r\n\t\t\t\t\tthis._JSONModel.setProperty(\"/busy\", false);\r\n\t\t\t\t}.bind(this)\r\n\t\t\t};\r\n\t\t\tthis._ODataModel.read(sUrl, mParameters);\r\n\t\t},\r\n\t\tformatter1: function(str) {\r\n\r\n\t\t\tif (str && str.length > 0) {\r\n\t\t\t\tstr = str.replace(/(\\\\u)(\\w{1,4})/gi, function($0) {\r\n\t\t\t\t\treturn (String.fromCharCode(parseInt((escape($0).replace(/(%5Cu)(\\w{1,4})/g, \"$2\")), 16)));\r\n\t\t\t\t});\r\n\t\t\t\tstr = str.replace(/(&#x)(\\w{1,4});/gi, function($0) {\r\n\t\t\t\t\treturn String.fromCharCode(parseInt(escape($0).replace(/(%26%23x)(\\w{1,4})(%3B)/g, \"$2\"), 16));\r\n\t\t\t\t});\r\n\t\t\t\tstr = str.replace(/(&#)(\\d{1,6});/gi, function($0) {\r\n\t\t\t\t\treturn String.fromCharCode(parseInt(escape($0).replace(/(%26%23)(\\d{1,6})(%3B)/g, \"$2\")));\r\n\t\t\t\t});\r\n\r\n\t\t\t\treturn str;\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tonPressImagehuawer: function(oControlEvent) {\r\n\t\t\tvar image1Set = {\r\n\t\t\t\tnp_res: [],\r\n\t\t\t\tnp_table: [{\r\n\t\t\t\t\t\"Image\": \"\"\r\n\t\t\t\t}]\r\n\t\t\t};\r\n\t\t\tthis._JSONModel.setProperty(\"/image1Set\", image1Set);\r\n\t\t\tthis.setBusy(true);\r\n\t\t\tthis._JSONModel.setProperty(\"/busy\", true);\r\n\t\t\tvar oFile = this.getView().byId(\"fileUploader\");\r\n\t\t\t// 为空选择文件提示\r\n\t\t\tif (!oFile.getValue()) {\r\n\t\t\t\tmessages.showText(\"请选择文件\");\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\t// 文件DOM \r\n\t\t\tvar that = this;\r\n\t\t\tvar domRef = oFile.getFocusDomRef();\r\n\t\t\tvar reader = new FileReader();\r\n\t\t\tvar file = domRef.files[0];\r\n\t\t\treader.readAsDataURL(file);\r\n\t\t\tvar image = \"\";\r\n\t\t\treader.that = this;\r\n\t\t\treader.onload = function(e) {\r\n\t\t\t\t// alert(1);\r\n\t\t\t\timage = e.target.result;\r\n\t\t\t\tthat._JSONModel.setProperty(\"/image1Set/np_table/0/Image\", image);\r\n\t\t\t\tthat.upload();\r\n\t\t\t};\r\n\r\n\t\t\t//\tthis._JSONModel.setProperty(\"/image1Set/np_table/0/Image\",image);\r\n\t\t\t//\tthis.upload();\r\n\t\t},\r\n\r\n\t\tupload: function(oControlEvent) {\r\n\t\t\tvar zdataSet = this._JSONModel.getProperty(\"/zdataSet\");\r\n\t\t\tthis._JSONModel.setProperty(\"/image1Set/Name1\", zdataSet.Name1);\r\n\t\t\tthis._JSONModel.setProperty(\"/image1Set/Name2\", zdataSet.Name2);\r\n\t\t\tthis._JSONModel.setProperty(\"/image1Set/Password\", zdataSet.Password);\r\n\t\t\tthis._JSONModel.setProperty(\"/image1Set/Token\", zdataSet.Token);\r\n\t\t\tvar oRequest = this._JSONModel.getData().image1Set;\r\n\t\t\toRequest.np_table = !oRequest.np_table ? [] : oRequest.np_table;\r\n\t\t\toRequest.np_res = !oRequest.np_res ? [] : oRequest.np_res;\r\n\t\t\tvar sUrl = \"/image1Set\";\r\n\t\t\tvar mParameters = {\r\n\t\t\t\tsuccess: function(oData, response) {\r\n\t\t\t\t\tvar localData = this._JSONModel.getData();\r\n\t\t\t\t\tlocalData.image1Set = oData;\r\n\t\t\t\t\tlocalData.image1Set.np_res = oData.np_res != null ? oData.np_res.results : null;\r\n\t\t\t\t\tlocalData.image1Set.np_table = oData.np_table != null ? oData.np_table.results : null;\r\n\t\t\t\t\tthis._JSONModel.setProperty(\"/\", localData, false);\r\n\t\t\t\t\tthis.setBusy(false);\r\n\t\t\t\t\tthis._JSONModel.setProperty(\"/busy\", false);\r\n\t\t\t\t}.bind(this),\r\n\t\t\t\terror: function(oError) {\r\n\t\t\t\t\tthis.setBusy(false);\r\n\t\t\t\t\tthis._JSONModel.setProperty(\"/busy\", false);\r\n\t\t\t\t}.bind(this)\r\n\t\t\t};\r\n\t\t\tthis._ODataModel.create(sUrl, oRequest, mParameters);\r\n\t\t}\r\n\r\n\t});\r\n});",
		"ZAPI_VIEW/thirdparty/openui5/camera/library-preload.js": "jQuery.sap.registerPreloadedModules({\r\n\t\"version\": \"2.0\",\r\n\t\"name\": \"openui5.camera.library-preload\",\r\n\t\"modules\": {\r\n\t\t\"Camera.js\": \"/*\\n * A simple UI5 control wrapping the HTML5 media API\\n * allowing the library user to easily take Pictures in javascript\\n * very easily. The control renders a Video preview element\\n * (technically a video html tag). When clicked the image is grabbed\\n * as a base64 encoded PNG. In the future would be nice to have the\\n * format configurable.\\n */\\nsap.ui.define([\\n    'jquery.sap.global',\\n    'sap/ui/core/Control'\\n],\\n              function(jQuery, Control) {\\n                  \\\"use strict\\\";\\n\\n                  /**\\n                   * Constructor for a new Camera control.\\n                   *\\n                   * @param {string} [sId] id for the new control, generated automatically if no id is given\\n                   * @param {object} [mSettings] initial settings for the new control\\n                   *\\n                   * @class\\n                   *\\n                   * @public\\n                   * @alias openui5.camera.Camera\\n                   */\\n                  var oCamera = Control.extend(\\\"openui5.camera.Camera\\\", {\\n                      /**\\n                       * Control API\\n                       */\\n                      metadata: {\\n                          properties: {\\n\\n                              /**\\n                               * Width of the preview window in pixels\\n                               */\\n                              \\\"width\\\": {\\n                                  type: \\\"string\\\",\\n                                  defaultValue: \\\"640\\\"\\n                              },\\n\\n                              /**\\n                               * Height of the preview window in pixels\\n                               */\\n                              \\\"height\\\": {\\n                                  type: \\\"string\\\",\\n                                  defaultValue: \\\"480\\\"\\n                              },\\n\\n                              /**\\n                               * Width of the video capture window in pixels\\n                               */\\n                              \\\"videoWidth\\\": {\\n                                  type: \\\"string\\\",\\n                                  defaultValue: \\\"1280\\\"\\n                              },\\n\\n                              /**\\n                               * Height of the video capture window in pixels\\n                               */\\n                              \\\"videoHeight\\\": {\\n                                  type: \\\"string\\\",\\n                                  defaultValue: \\\"960\\\"\\n                              }\\n                          },\\n                          events: {\\n                              /**\\n                               * Raised when the user clicks/taps the video preview.\\n                               * The event object contain a parameter called \\\"image\\\"\\n                               * which contains a base64 encoded png file. This is a\\n                               * string.\\n                               */\\n                              \\\"snapshot\\\": {}\\n                          }\\n                      },\\n\\n                      /**\\n                       * Lifecycle hook to initialize the control\\n                       */\\n                      init: function() {\\n                          var that = this;\\n                          this._displayingVideo = false; // Is the control displaying video at the moment?\\n                      },\\n\\n\\n                      /**\\n                       * Handler for when the user clicks the video preview.\\n                       * Fires the Snapshot event with the image inside.\\n                       **/\\n                      _onUserClickedVideo: function() {\\n                          var iVideoWidth = parseInt(this.getVideoWidth(), 10);\\n                          var iVideoHeight = parseInt(this.getVideoHeight(), 10);\\n                          if (this._displayingVideo) {\\n                              // Grab the picture from the video element\\n                              var oImage = this._takePicture(iVideoWidth, iVideoHeight);\\n                              // Send snapshot event with the image inside.\\n                              this.fireSnapshot({\\n                                  image: oImage\\n                              });\\n                          }\\n                      },\\n\\n\\n                      /**\\n                       * Takes a screenshot of the video element and returns its\\n                       * data in PNG format.\\n                       **/\\n                      _takePicture: function(width, height) {\\n                          var oCanvas = this._getCanvas();\\n                          var oVideo = this._getVideo();\\n                          var oImageData = null;\\n                          var context = oCanvas.getContext('2d');\\n                          if (width && height) {\\n                              context.drawImage(oVideo, 0, 0, width, height);\\n                              oImageData = oCanvas.toDataURL('image/png');\\n                          }\\n                          return oImageData;\\n                      },\\n\\n\\n                      /**\\n                       *\\n                       */\\n                      _getCanvas: function() {\\n                          return jQuery(\\\"canvas\\\", jQuery(\\\"#\\\" + this.getId())).get(0);\\n                      },\\n\\n\\n                      /**\\n                       *\\n                       */\\n                      _getVideo: function() {\\n                          return jQuery(\\\"video\\\", jQuery(\\\"#\\\" + this.getId())).get(0);\\n                      },\\n\\n\\n                      /**\\n                       *\\n                       */\\n                      stopCamera: function(){\\n                          this._displayingVideo = false;\\n                          if (this._stream){\\n                              this._stream.getVideoTracks().forEach( function(t){ t.stop(); });\\n                          }\\n                      },\\n\\n\\n                      /**\\n                       *\\n                       */\\n                      onAfterRendering: function() {\\n                          var that = this;\\n                          var oVideo = this._getVideo();\\n                          // Attach a click handler to the video element\\n                          if (oVideo && !oVideo.onclick){\\n                              oVideo.onclick = function(){\\n                                  that._onUserClickedVideo();\\n                              };\\n                          }\\n                          if (oVideo && !this._displayingVideo) {\\n                              // set the camera stream on the canvas.\\n                              // Ask the user for camera access.\\n                              navigator.mediaDevices.getUserMedia({\\n                                  video: { facingMode: \\\"environment\\\" }, // Back camera\\n                                  audio: false\\n                              })\\n                                  .then(function(stream) {\\n                                      // We have a camera. Let's store the stream for later use\\n                                      that._stream = stream;\\n                                      oVideo.srcObject = stream;\\n                                      oVideo.play();\\n                                      that._displayingVideo = true;\\n                                  })\\n                                  .catch(function(err) {\\n                                      jQuery.sap.log.error(\\\"Problems accessing the camera: \\\" + err);\\n                                  });\\n                          }\\n                      }\\n                  });\\n                  return oCamera;\\n              });\\n\",\r\n\t\t\"CameraRenderer.js\": \"sap.ui.define([],\\n\\t          function() {\\n\\t              \\\"use strict\\\";\\n\\n\\t              /**\\n\\t               * @namespace openui5.camera\\n\\t               */\\n\\t              var CameraRenderer = {};\\n\\n\\t              /**\\n\\t               * Renders the HTML for the control, using the provided {@link sap.ui.core.RenderManager}.\\n\\t               *\\n\\t               * @param {sap.ui.core.RenderManager} oRm RenderManager object\\n\\t               * @param {sap.ui.core.Control} oControl An object representation of the control that will be rendered\\n\\t               */\\n\\t              CameraRenderer.render = function(oRm, oControl) {\\n\\t\\t              oRm.write(\\\"<div\\\");\\n\\t\\t              oRm.writeControlData(oControl);\\n\\t\\t              oRm.writeClasses();\\n\\t\\t              oRm.writeStyles();\\n\\t\\t              oRm.write(\\\">\\\");\\n                      oRm.write(\\\"<div style='display: flex; flex-direction: row; align-items: center; justify-content: space-around;'>\\\");\\n                      oRm.write(\\n                          \\\"<video width='%w' height='%h' style='width: %pwpx; height: %phpx;'></video>\\\"\\n                              .replace(\\\"%w\\\", oControl.getVideoWidth())\\n                              .replace(\\\"%h\\\", oControl.getVideoHeight())\\n                              .replace(\\\"%pw\\\", oControl.getWidth())\\n                              .replace(\\\"%ph\\\", oControl.getHeight())\\n                      );\\n                      oRm.write(\\n                          \\\"<canvas width='%w' height='%h' style='display: none; width: %pwpx; height: %phpx;'></canvas>\\\"\\n                              .replace(\\\"%w\\\", oControl.getVideoWidth())\\n                              .replace(\\\"%h\\\", oControl.getVideoHeight())\\n                              .replace(\\\"%pw\\\", oControl.getWidth())\\n                              .replace(\\\"%ph\\\", oControl.getHeight()));\\n\\t\\t              oRm.write(\\\"</div>\\\");\\n\\t\\t              oRm.write(\\\"</div>\\\");\\n\\t              };\\n\\n\\t              return CameraRenderer;\\n\\n              }, /* bExport= */ true);\\n\",\r\n\t\t\"library.js\": \"/*!\\n * ${copyright}\\n */\\n\\n/**\\n * Initialization Code and shared classes of library it.designfuture.qrcode.\\n */\\nsap.ui.define([\\n\\t'jquery.sap.global',\\n\\t'sap/ui/core/library' // library dependency\\n],  function(jQuery, library) {\\n\\n\\t\\\"use strict\\\";\\n\\n\\t/**\\n\\t * Suite controls library.\\n\\t *\\n\\t * @namespace\\n\\t * @name openui5.camera\\n\\t * @author Tiago Almeida <jumpifzero@gmail.com>\\n\\t * @version ${version}\\n\\t * @public\\n\\t */\\n\\n\\t// delegate further initialization of this library to the Core\\n\\tsap.ui.getCore().initLibrary({\\n\\t\\tname : \\\"openui5.camera\\\",\\n\\t\\tnoLibraryCSS: true,\\n\\t\\tversion: \\\"${version}\\\",\\n\\t\\tdependencies : [\\\"sap.ui.core\\\", \\\"sap.m\\\"],\\n\\t\\ttypes: [],\\n\\t\\tinterfaces: [],\\n\\t\\tcontrols: [\\n\\t\\t\\t\\\"openui5.camera.Camera\\\"\\n\\t\\t],\\n\\t\\telements: []\\n\\t});\\n\\n\\treturn openui5.camera;\\n\\n}, /* bExport= */ false);\\n\"\r\n\t}\r\n});",
		"ZAPI_VIEW/thirdparty/openui5/camera/Camera.js": "/*\r\n * A simple UI5 control wrapping the HTML5 media API\r\n * allowing the library user to easily take Pictures in javascript\r\n * very easily. The control renders a Video preview element\r\n * (technically a video html tag). When clicked the image is grabbed\r\n * as a base64 encoded PNG. In the future would be nice to have the\r\n * format configurable.\r\n */\r\nsap.ui.define([\r\n    'jquery.sap.global',\r\n    'sap/ui/core/Control'\r\n],\r\n              function(jQuery, Control) {\r\n                  \"use strict\";\r\n\r\n                  /**\r\n                   * Constructor for a new Camera control.\r\n                   *\r\n                   * @param {string} [sId] id for the new control, generated automatically if no id is given\r\n                   * @param {object} [mSettings] initial settings for the new control\r\n                   *\r\n                   * @class\r\n                   *\r\n                   * @public\r\n                   * @alias openui5.camera.Camera\r\n                   */\r\n                  var oCamera = Control.extend(\"openui5.camera.Camera\", {\r\n                      /**\r\n                       * Control API\r\n                       */\r\n                      metadata: {\r\n                          properties: {\r\n\r\n                              /**\r\n                               * Width of the preview window in pixels\r\n                               */\r\n                              \"width\": {\r\n                                  type: \"string\",\r\n                                  defaultValue: \"640\"\r\n                              },\r\n\r\n                              /**\r\n                               * Height of the preview window in pixels\r\n                               */\r\n                              \"height\": {\r\n                                  type: \"string\",\r\n                                  defaultValue: \"480\"\r\n                              },\r\n\r\n                              /**\r\n                               * Width of the video capture window in pixels\r\n                               */\r\n                              \"videoWidth\": {\r\n                                  type: \"string\",\r\n                                  defaultValue: \"1280\"\r\n                              },\r\n\r\n                              /**\r\n                               * Height of the video capture window in pixels\r\n                               */\r\n                              \"videoHeight\": {\r\n                                  type: \"string\",\r\n                                  defaultValue: \"960\"\r\n                              }\r\n                          },\r\n                          events: {\r\n                              /**\r\n                               * Raised when the user clicks/taps the video preview.\r\n                               * The event object contain a parameter called \"image\"\r\n                               * which contains a base64 encoded png file. This is a\r\n                               * string.\r\n                               */\r\n                              \"snapshot\": {}\r\n                          }\r\n                      },\r\n\r\n                      /**\r\n                       * Lifecycle hook to initialize the control\r\n                       */\r\n                      init: function() {\r\n                          var that = this;\r\n                          this._displayingVideo = false; // Is the control displaying video at the moment?\r\n                      },\r\n\r\n\r\n                      /**\r\n                       * Handler for when the user clicks the video preview.\r\n                       * Fires the Snapshot event with the image inside.\r\n                       **/\r\n                      _onUserClickedVideo: function() {\r\n                          var iVideoWidth = parseInt(this.getVideoWidth(), 10);\r\n                          var iVideoHeight = parseInt(this.getVideoHeight(), 10);\r\n                          if (this._displayingVideo) {\r\n                              // Grab the picture from the video element\r\n                              var oImage = this._takePicture(iVideoWidth, iVideoHeight);\r\n                              // Send snapshot event with the image inside.\r\n                              this.fireSnapshot({\r\n                                  image: oImage\r\n                              });\r\n                          }\r\n                      },\r\n\r\n\r\n                      /**\r\n                       * Takes a screenshot of the video element and returns its\r\n                       * data in PNG format.\r\n                       **/\r\n                      _takePicture: function(width, height) {\r\n                          var oCanvas = this._getCanvas();\r\n                          var oVideo = this._getVideo();\r\n                          var oImageData = null;\r\n                          var context = oCanvas.getContext('2d');\r\n                          if (width && height) {\r\n                              context.drawImage(oVideo, 0, 0, width, height);\r\n                              oImageData = oCanvas.toDataURL('image/png');\r\n                          }\r\n                          return oImageData;\r\n                      },\r\n\r\n\r\n                      /**\r\n                       *\r\n                       */\r\n                      _getCanvas: function() {\r\n                          return jQuery(\"canvas\", jQuery(\"#\" + this.getId())).get(0);\r\n                      },\r\n\r\n\r\n                      /**\r\n                       *\r\n                       */\r\n                      _getVideo: function() {\r\n                          return jQuery(\"video\", jQuery(\"#\" + this.getId())).get(0);\r\n                      },\r\n\r\n\r\n                      /**\r\n                       *\r\n                       */\r\n                      stopCamera: function(){\r\n                          this._displayingVideo = false;\r\n                          if (this._stream){\r\n                              this._stream.getVideoTracks().forEach( function(t){ t.stop(); });\r\n                          }\r\n                      },\r\n\r\n\r\n                      /**\r\n                       *\r\n                       */\r\n                      onAfterRendering: function() {\r\n                          var that = this;\r\n                          var oVideo = this._getVideo();\r\n                          // Attach a click handler to the video element\r\n                          if (oVideo && !oVideo.onclick){\r\n                              oVideo.onclick = function(){\r\n                                  that._onUserClickedVideo();\r\n                              };\r\n                          }\r\n                          if (oVideo && !this._displayingVideo) {\r\n                              // set the camera stream on the canvas.\r\n                              // Ask the user for camera access.\r\n                              navigator.mediaDevices.getUserMedia({\r\n                                  video: { facingMode: \"environment\" }, // Back camera\r\n                                  audio: false\r\n                              })\r\n                                  .then(function(stream) {\r\n                                      // We have a camera. Let's store the stream for later use\r\n                                      that._stream = stream;\r\n                                      oVideo.srcObject = stream;\r\n                                      oVideo.play();\r\n                                      that._displayingVideo = true;\r\n                                  })\r\n                                  .catch(function(err) {\r\n                                      jQuery.sap.log.error(\"Problems accessing the camera: \" + err);\r\n                                  });\r\n                          }\r\n                      }\r\n                  });\r\n                  return oCamera;\r\n              });",
		"ZAPI_VIEW/view/view3.view.xml": "<mvc:View xmlns:mvc=\"sap.ui.core.mvc\" xmlns:table=\"sap.ui.table\" xmlns:unified=\"sap.ui.unified\" xmlns=\"sap.m\" xmlns:f=\"sap.ui.layout.form\"\r\n\txmlns:l=\"sap.ui.layout\" xmlns:core=\"sap.ui.core\" xmlns:custom=\"http://schemas.sap.com/sapui5/extension/sap.ui.core.CustomData/1\"\r\n\tcontrollerName=\"ZAPI_VIEW.controller.view3\" displayBlock=\"true\">\r\n\t<App>\r\n\t\t<pages>\r\n\t\t\t<Page title=\"发票扫描\">\r\n\t\t\t\t<content>\r\n\t\t\t\t\t<!--\t<ScrollContainer height=\"50%\" width=\"50%\" horizontal=\"true\" vertical=\"true\" focusable=\"true\">\r\n\t\t\t\t\t\t<Image src=\"{/image3Set/np_table/0/Image}\" densityAware=\"false\" width=\"100%\"></Image>\r\n\t\t\t\t\t</ScrollContainer>-->\r\n\t\t\t\t\t<Panel expandable=\"true\" expanded=\"true\" headerText=\"抬头\" width=\"auto\">\r\n\t\t\t\t\t\t<f:Form editable=\"true\">\r\n\t\t\t\t\t\t\t<f:layout>\r\n\t\t\t\t\t\t\t\t<f:ResponsiveGridLayout labelSpanL=\"4\" labelSpanM=\"4\" emptySpanL=\"1\" emptySpanM=\"1\" columnsL=\"2\" columnsM=\"2\"/>\r\n\t\t\t\t\t\t\t</f:layout>\r\n\t\t\t\t\t\t\t<f:formContainers>\r\n\t\t\t\t\t\t\t\t<f:FormContainer>\r\n\t\t\t\t\t\t\t\t\t<f:formElements>\r\n\t\t\t\t\t\t\t\t\t\t<f:FormElement label=\"增值税发票类型\">\r\n\t\t\t\t\t\t\t\t\t\t\t<f:fields>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<Text text=\"{/invoiceSet/Type}\"/>\r\n\t\t\t\t\t\t\t\t\t\t\t</f:fields>\r\n\t\t\t\t\t\t\t\t\t\t</f:FormElement>\r\n\t\t\t\t\t\t\t\t\t\t<f:FormElement label=\"发票代码\">\r\n\t\t\t\t\t\t\t\t\t\t\t<f:fields>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<Text text=\"{/invoiceSet/Code}\"/>\r\n\t\t\t\t\t\t\t\t\t\t\t</f:fields>\r\n\t\t\t\t\t\t\t\t\t\t</f:FormElement>\r\n\t\t\t\t\t\t\t\t\t\t<f:FormElement label=\"发票校验码\">\r\n\t\t\t\t\t\t\t\t\t\t\t<f:fields>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<Text text=\"{/invoiceSet/CheckCode}\"/>\r\n\t\t\t\t\t\t\t\t\t\t\t</f:fields>\r\n\t\t\t\t\t\t\t\t\t\t</f:FormElement>\r\n\t\t\t\t\t\t\t\t\t\t<f:FormElement label=\"发票号码\">\r\n\t\t\t\t\t\t\t\t\t\t\t<f:fields>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<Text text=\"{/invoiceSet/Number}\"/>\r\n\t\t\t\t\t\t\t\t\t\t\t</f:fields>\r\n\t\t\t\t\t\t\t\t\t\t</f:FormElement>\r\n\t\t\t\t\t\t\t\t\t\t<f:FormElement label=\"开票日期\">\r\n\t\t\t\t\t\t\t\t\t\t\t<f:fields>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<Text text=\"{/invoiceSet/IssueDate}\"/>\r\n\t\t\t\t\t\t\t\t\t\t\t</f:fields>\r\n\t\t\t\t\t\t\t\t\t\t</f:FormElement>\r\n\t\t\t\t\t\t\t\t\t\t<f:FormElement label=\"密码区\">\r\n\t\t\t\t\t\t\t\t\t\t\t<f:fields>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<Text text=\"{/invoiceSet/EncryptionBlock}\"/>\r\n\t\t\t\t\t\t\t\t\t\t\t</f:fields>\r\n\t\t\t\t\t\t\t\t\t\t</f:FormElement>\r\n\t\t\t\t\t\t\t\t\t\t<f:FormElement label=\"合计金额\">\r\n\t\t\t\t\t\t\t\t\t\t\t<f:fields>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<Text text=\"{/invoiceSet/SubtotalAmount}\"/>\r\n\t\t\t\t\t\t\t\t\t\t\t</f:fields>\r\n\t\t\t\t\t\t\t\t\t\t</f:FormElement>\r\n\t\t\t\t\t\t\t\t\t\t<f:FormElement label=\"合计税额\">\r\n\t\t\t\t\t\t\t\t\t\t\t<f:fields>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<Text text=\"{/invoiceSet/SubtotalTax}\"/>\r\n\t\t\t\t\t\t\t\t\t\t\t</f:fields>\r\n\t\t\t\t\t\t\t\t\t\t</f:FormElement>\r\n\t\t\t\t\t\t\t\t\t\t<f:FormElement label=\"价税合计\">\r\n\t\t\t\t\t\t\t\t\t\t\t<f:fields>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<Text text=\"{/invoiceSet/Total}\"/>\r\n\t\t\t\t\t\t\t\t\t\t\t</f:fields>\r\n\t\t\t\t\t\t\t\t\t\t</f:FormElement>\r\n\t\t\t\t\t\t\t\t\t</f:formElements>\r\n\t\t\t\t\t\t\t\t</f:FormContainer>\r\n\t\t\t\t\t\t\t\t<f:FormContainer>\r\n\t\t\t\t\t\t\t\t\t<f:FormElement label=\"购买方名称\">\r\n\t\t\t\t\t\t\t\t\t\t<f:fields>\r\n\t\t\t\t\t\t\t\t\t\t\t<Text text=\"{/invoiceSet/BuyerName}\"/>\r\n\t\t\t\t\t\t\t\t\t\t</f:fields>\r\n\t\t\t\t\t\t\t\t\t</f:FormElement>\r\n\t\t\t\t\t\t\t\t\t<f:FormElement label=\"购买方纳税人识别号\">\r\n\t\t\t\t\t\t\t\t\t\t<f:fields>\r\n\t\t\t\t\t\t\t\t\t\t\t<Text text=\"{/invoiceSet/BuyerId}\"/>\r\n\t\t\t\t\t\t\t\t\t\t</f:fields>\r\n\t\t\t\t\t\t\t\t\t</f:FormElement>\r\n\t\t\t\t\t\t\t\t\t<f:FormElement label=\"购买方地址、电话\">\r\n\t\t\t\t\t\t\t\t\t\t<f:fields>\r\n\t\t\t\t\t\t\t\t\t\t\t<Text text=\"{/invoiceSet/BuyerAddress}\"/>\r\n\t\t\t\t\t\t\t\t\t\t</f:fields>\r\n\t\t\t\t\t\t\t\t\t</f:FormElement>\r\n\t\t\t\t\t\t\t\t\t<f:FormElement label=\"购买方开户行及帐号\">\r\n\t\t\t\t\t\t\t\t\t\t<f:fields>\r\n\t\t\t\t\t\t\t\t\t\t\t<Text text=\"{/invoiceSet/BuyerBank}\"/>\r\n\t\t\t\t\t\t\t\t\t\t</f:fields>\r\n\t\t\t\t\t\t\t\t\t</f:FormElement>\r\n\t\t\t\t\t\t\t\t\t<f:FormElement label=\"销售方名称\">\r\n\t\t\t\t\t\t\t\t\t\t<f:fields>\r\n\t\t\t\t\t\t\t\t\t\t\t<Text text=\"{/invoiceSet/SellerName}\"/>\r\n\t\t\t\t\t\t\t\t\t\t</f:fields>\r\n\t\t\t\t\t\t\t\t\t</f:FormElement>\r\n\t\t\t\t\t\t\t\t\t<f:FormElement label=\"销售方纳税人识别号\">\r\n\t\t\t\t\t\t\t\t\t\t<f:fields>\r\n\t\t\t\t\t\t\t\t\t\t\t<Text text=\"{/invoiceSet/SellerId}\"/>\r\n\t\t\t\t\t\t\t\t\t\t</f:fields>\r\n\t\t\t\t\t\t\t\t\t</f:FormElement>\r\n\t\t\t\t\t\t\t\t\t<f:FormElement label=\"销售方地址、电话\">\r\n\t\t\t\t\t\t\t\t\t\t<f:fields>\r\n\t\t\t\t\t\t\t\t\t\t\t<Text text=\"{/invoiceSet/SellerAddress}\"/>\r\n\t\t\t\t\t\t\t\t\t\t</f:fields>\r\n\t\t\t\t\t\t\t\t\t</f:FormElement>\r\n\t\t\t\t\t\t\t\t\t<f:FormElement label=\"销售方开户行及帐号\">\r\n\t\t\t\t\t\t\t\t\t\t<f:fields>\r\n\t\t\t\t\t\t\t\t\t\t\t<Text text=\"{/invoiceSet/SellerBank}\"/>\r\n\t\t\t\t\t\t\t\t\t\t</f:fields>\r\n\t\t\t\t\t\t\t\t\t</f:FormElement>\r\n\t\t\t\t\t\t\t\t</f:FormContainer>\r\n\t\t\t\t\t\t\t</f:formContainers>\r\n\t\t\t\t\t\t</f:Form>\r\n\t\t\t\t\t</Panel>\r\n\t\t\t\t\t<Panel expandable=\"true\" expanded=\"true\" headerText=\"明细\" width=\"auto\">\r\n\t\t\t\t\t\t<table:Table rows=\"{/invoiceSet/np_invoiceinvoice_item/}\" enableBusyIndicator=\"true\" selectionMode=\"Single\" visibleRowCount=\"5\">\r\n\t\t\t\t\t\t\t<table:columns>\r\n\t\t\t\t\t\t\t\t<table:Column sortProperty=\"label\" filterProperty=\"label\">\r\n\t\t\t\t\t\t\t\t\t<Label text=\"货物或应税劳务、服务名称\"/>\r\n\t\t\t\t\t\t\t\t\t<table:template>\r\n\t\t\t\t\t\t\t\t\t\t<Text text=\"{Name}\"/>\r\n\t\t\t\t\t\t\t\t\t</table:template>\r\n\t\t\t\t\t\t\t\t</table:Column>\r\n\t\t\t\t\t\t\t\t<table:Column sortProperty=\"\" filterProperty=\"\">\r\n\t\t\t\t\t\t\t\t\t<Label text=\"规格型号\"/>\r\n\t\t\t\t\t\t\t\t\t<table:template>\r\n\t\t\t\t\t\t\t\t\t\t<Text text=\"{Specification}\"/>\r\n\t\t\t\t\t\t\t\t\t</table:template>\r\n\t\t\t\t\t\t\t\t</table:Column>\r\n\t\t\t\t\t\t\t\t<table:Column sortProperty=\"\" filterProperty=\"\">\r\n\t\t\t\t\t\t\t\t\t<Label text=\"单位\"/>\r\n\t\t\t\t\t\t\t\t\t<table:template>\r\n\t\t\t\t\t\t\t\t\t\t<Text text=\"{Unit}\"/>\r\n\t\t\t\t\t\t\t\t\t</table:template>\r\n\t\t\t\t\t\t\t\t</table:Column>\r\n\t\t\t\t\t\t\t\t<table:Column sortProperty=\"\" filterProperty=\"\">\r\n\t\t\t\t\t\t\t\t\t<Label text=\"数量\"/>\r\n\t\t\t\t\t\t\t\t\t<table:template>\r\n\t\t\t\t\t\t\t\t\t\t<Text text=\"{Quantity}\"/>\r\n\t\t\t\t\t\t\t\t\t</table:template>\r\n\t\t\t\t\t\t\t\t</table:Column>\r\n\t\t\t\t\t\t\t\t<table:Column sortProperty=\"\" filterProperty=\"\">\r\n\t\t\t\t\t\t\t\t\t<Label text=\"单价\"/>\r\n\t\t\t\t\t\t\t\t\t<table:template>\r\n\t\t\t\t\t\t\t\t\t\t<Text text=\"{UnitPrice}\"/>\r\n\t\t\t\t\t\t\t\t\t</table:template>\r\n\t\t\t\t\t\t\t\t</table:Column>\r\n\t\t\t\t\t\t\t\t<table:Column sortProperty=\"\" filterProperty=\"\">\r\n\t\t\t\t\t\t\t\t\t<Label text=\"金额\"/>\r\n\t\t\t\t\t\t\t\t\t<table:template>\r\n\t\t\t\t\t\t\t\t\t\t<Text text=\"{Amount}\"/>\r\n\t\t\t\t\t\t\t\t\t</table:template>\r\n\t\t\t\t\t\t\t\t</table:Column>\r\n\t\t\t\t\t\t\t\t<table:Column sortProperty=\"\" filterProperty=\"\">\r\n\t\t\t\t\t\t\t\t\t<Label text=\"税率\"/>\r\n\t\t\t\t\t\t\t\t\t<table:template>\r\n\t\t\t\t\t\t\t\t\t\t<Text text=\"{TaxRate}\"/>\r\n\t\t\t\t\t\t\t\t\t</table:template>\r\n\t\t\t\t\t\t\t\t</table:Column>\r\n\t\t\t\t\t\t\t\t<table:Column sortProperty=\"\" filterProperty=\"\">\r\n\t\t\t\t\t\t\t\t\t<Label text=\"税额\"/>\r\n\t\t\t\t\t\t\t\t\t<table:template>\r\n\t\t\t\t\t\t\t\t\t\t<Text text=\"{Tax}\"/>\r\n\t\t\t\t\t\t\t\t\t</table:template>\r\n\t\t\t\t\t\t\t\t</table:Column>\r\n\t\t\t\t\t\t\t</table:columns>\r\n\t\t\t\t\t\t</table:Table>\r\n\t\t\t\t\t</Panel>\r\n\t\t\t\t</content>\r\n\t\t\t\t<footer>\r\n\t\t\t\t\t<Bar>\r\n\t\t\t\t\t\t<contentLeft>\r\n\t\t\t\t\t\t\t\t<unified:FileUploader buttonOnly=\"true\" buttonText=\"上传发票\" sameFilenameAllowed=\"true\" multiple=\"true\" id=\"fileUploader\"\r\n\t\t\t\t\t\t\t\tfileType=\"zip,png,jpeg,jpg,bmp,tiff,tif\" icon=\"{imageModel>/path}/camera.png\"\r\n\t\t\t\t\t\t\t\tmimeType=\"application/x-zip-compressed,application/zip,application/octet-stream,image/png,image/jpg,image/jpeg,image/bmp,image/tiff\"\r\n\t\t\t\t\t\t\t\ttypeMissmatch=\"fileTypeMissmatch\" change=\"onPressImagehuawer\" custom:mode=\"xhr\"></unified:FileUploader>\r\n\t\t\t\t\t\t</contentLeft>\r\n\t\t\t\t\t\t<contentRight>\r\n\t\t\t\t\t\t\t<Button width=\"8em\" text=\"过账 \" type=\"Emphasized\" visible=\"true\" press=\"opPressPost\" level=\"H2\"/>\r\n\t\t\t\t\t\t\t<Button width=\"8em\" text=\"验证  \" type=\"Emphasized\" visible=\"true\" press=\"dialogPress\" level=\"H2\"/>\r\n\t\t\t\t\t\t</contentRight>\r\n\t\t\t\t\t</Bar>\r\n\t\t\t\t\r\n\t\t\t\t</footer>\r\n\t\t\t</Page>\r\n\t\t</pages>\r\n\t</App>\r\n</mvc:View>",
		"ZAPI_VIEW/model/poster.js": "/* =========================================================== */\r\n/* 主要 函数方法 实现                                                                               */\r\n/* =========================================================== */\r\nsap.ui.define([ \"sap/ui/model/Filter\",\r\n\t\t\t\t \"../controller/messages\",\r\n\t\t\t\t \"./models\",\r\n\t\t\t\t \"./formatter\"\r\n], function(Filter, messages, models, formatter) {\r\n\t\t\t\t\"use strict\";\r\n\r\n\t\t\t\treturn {\r\n\t\t\t\t\t// 前后台交互通用函数\r\n\t\t\t\t\tdoPost : function(oView, fnSuccess, fnError) {\r\n\t\t\t\t\t\tthis._Controller = oView.getController();\r\n\t\t\t\t\t\tthis._JSONModel = this._Controller.getModel();\r\n\t\t\t\t\t\tvar sBCode = this._JSONModel.getProperty(\"/appProperties/bcode\");\r\n\r\n\t\t\t\t\t\tvar f1 = \"postEAMWT\"; // 工作票数据交互处理函数\r\n\t\t\t\t\t\tvar f2 = \"postBEIJIAN\"; // 备件需求提报数据交互处理函数\r\n\t\t\t\t\t\tvar f4 = \"postDEFECT\"; // 缺陷登记数据交互处理函数\r\n\t\t\t\t\t\tvar f5 = \"postSHA\"; // 交接班日志数据交互处理函数\r\n\t\t\t\t\t\tvar f6 = \"postPTH\"; // 光伏工作票数据交互处理函数\r\n\t\t\t\t\t\tvar f7 = \"postSHTH\"; // 日志排班数据交互处理函数\r\n\t\t\t\t\t\tvar f8 = \"postWCP\"; // 定期工作计划数据交互处理函数\r\n\t\t\t\t\t\tvar f9 = \"postWCPA\"; // 定期工作任务数据交互处理函数\r\n\t\t\t\t\t\tvar fA = \"postMTPM\"; // 维修作业许可数据交互处理函数\r\n\t\t\t\t\t\tvar fB = \"postTKH\"; // 工作票报表数据交互处理函数\r\n\t\t\t\t\t\tvar fC = \"postOPH\"; // 运行记录数据交互处理函数\r\n\t\t\t\t\t\tvar fD = \"postTTN\"; // 保护投退功能增强数据交互处理函数\r\n\t\t\t\t\t\tvar fE = \"postDF\"; // 缺陷报表数据交互处理函数\r\n\t\t\t\t\t\tvar fF = \"postTEA\"; // 临时用电数据交互处理函数\r\n\t\t\t\t\t\tvar fG = \"postOPT\"; // 操作票数据交互处理函数\r\n\t\t\t\t\t\tvar fH = \"postXG\"; // 巡更管理数据交互处理函数\r\n\t\t\t\t\t\tvar fI = \"postTR\"; // 设备试运行数据交互处理函数\r\n\t\t\t\t\t\tvar fJ = \"postTW\"; // 临时用水、压缩空气申请单数据交互处理函数\r\n\t\t\t\t\t\tvar fK = \"postTF\"; // 设备停复役数据交互处理函数\r\n\t\t\t\t\t\tvar fL = \"postSCN\"; // 停送电联系单数据交互处理函数\r\n\t\t\t\t\t\tvar fM = \"postOPQ\"; // 操作票查询报表数据交互处理函数\r\n\t\t\t\t\t\tvar fN = \"postQM\"; // 综合报表查询数据交互处理函数\r\n\t\t\t\t\t\tvar fO = \"postYD\"; // 异动通知单数据交互处理函数\r\n\t\t\t\t\t\tvar fP = \"postOPSR\";// 操作票状态报告数据交互处理函数\r\n\t\t\t\t\t\tvar fQ = \"postFL\"; // 功能位置数据交互处理函数\r\n\t\t\t\t\t\tvar fR = \"postDT\"; // 值班管理数据交互处理函数\r\n\t\t\t\t\t\tvar fS = \"postSP\"; // 备件需求提报报表处理函数\r\n\t\t\t\t\t\tvar fT = \"postRR\"; // 试运转单报表处理函数\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tvar sFunction = {\r\n\t\t\t\t\t\t\t\"WT\" : f1,\r\n\t\t\t\t\t\t\t\"BJ\" : f2,\r\n\t\t\t\t\t\t\t\"DH\" : f4,\r\n\t\t\t\t\t\t\t\"RL\" : f5,\r\n\t\t\t\t\t\t\t\"PT\" : f6,\r\n\t\t\t\t\t\t\t\"SH\" : f7,\r\n\t\t\t\t\t\t\t\"WP\" : f8,\r\n\t\t\t\t\t\t\t\"WA\" : f9,\r\n\t\t\t\t\t\t\t\"MT\" : fA,\r\n\t\t\t\t\t\t\t\"TK\" : fB,\r\n\t\t\t\t\t\t\t\"OP\" : fC,\r\n\t\t\t\t\t\t\t\"TN\" : fD,\r\n\t\t\t\t\t\t\t\"DF\" : fE,\r\n\t\t\t\t\t\t\t\"TE\" : fF,\r\n\t\t\t\t\t\t\t\"OPT\" : fG,\r\n\t\t\t\t\t\t\t\"XG\" : fH,\r\n\t\t\t\t\t\t\t\"TR\" : fI,\r\n\t\t\t\t\t\t\t\"TW\" : fJ,\r\n\t\t\t\t\t\t\t\"TF\" : fK,\r\n\t\t\t\t\t\t\t\"SC\" : fL,\r\n\t\t\t\t\t\t\t\"OPQ\" : fM,\r\n\t\t\t\t\t\t\t\"QM\" : fN,\r\n\t\t\t\t\t\t\t\"YD\" : fO,\r\n\t\t\t\t\t\t\t\"OPSR\" : fP,\r\n\t\t\t\t\t\t\t\"FL\" : fQ,\r\n\t\t\t\t\t\t\t\"DT\" : fR,\r\n\t\t\t\t\t\t\t\"SP\" : fS,\r\n\t\t\t\t\t\t\t\"RR\" : fT\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t}[sBCode] || \"\";\r\n\r\n\t\t\t\t\t\tswitch (sFunction) {\r\n\t\t\t\t\t\tcase f1:\r\n\t\t\t\t\t\t\tthis.postEAMWT(oView, fnSuccess, fnError);\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase f2:\r\n\t\t\t\t\t\t\tthis.postBEIJIAN(oView, fnSuccess, fnError);\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase f4:\r\n\t\t\t\t\t\t\tthis.postDEFECT(oView, fnSuccess, fnError);\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase f5:\r\n\t\t\t\t\t\t\tthis.postSHA(oView, fnSuccess, fnError);\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase f6:\r\n\t\t\t\t\t\t\tthis.postPTH(oView, fnSuccess, fnError);\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase f7:\r\n\t\t\t\t\t\t\tthis.postSHTH(oView, fnSuccess, fnError);\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase f8:\r\n\t\t\t\t\t\t\tthis.postWCP(oView, fnSuccess, fnError);\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase f9:\r\n\t\t\t\t\t\t\tthis.postWCPA(oView, fnSuccess, fnError);\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase fA:\r\n\t\t\t\t\t\t\tthis.postMTPM(oView, fnSuccess, fnError);\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase fB:\r\n\t\t\t\t\t\t\tthis.postTKH(oView, fnSuccess, fnError);\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase fC:\r\n\t\t\t\t\t\t\tthis.postOPH(oView, fnSuccess, fnError);\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase fD:\r\n\t\t\t\t\t\t\tthis.postTTN(oView, fnSuccess, fnError);\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase fE:\r\n\t\t\t\t\t\t\tthis.postDF(oView, fnSuccess, fnError);\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase fF:\r\n\t\t\t\t\t\t\tthis.postTEA(oView, fnSuccess, fnError);\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase fG:\r\n\t\t\t\t\t\t\tthis.postOPT(oView, fnSuccess, fnError);\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase fH:\r\n\t\t\t\t\t\t\tthis.postXG(oView, fnSuccess, fnError);\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase fI:\r\n\t\t\t\t\t\t\tthis.postTR(oView, fnSuccess, fnError);\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase fJ:\r\n\t\t\t\t\t\t\tthis.postTW(oView, fnSuccess, fnError);\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase fK:\r\n\t\t\t\t\t\t\tthis.postTF(oView, fnSuccess, fnError);\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase fL:\r\n\t\t\t\t\t\t\tthis.postSCN(oView, fnSuccess, fnError);\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase fM:\r\n\t\t\t\t\t\t\tthis.postOPQ(oView, fnSuccess, fnError);\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase fN:\r\n\t\t\t\t\t\t\tthis.postQM(oView, fnSuccess, fnError);\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase fO:\r\n\t\t\t\t\t\t\tthis.postYD(oView, fnSuccess, fnError);\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase fP:\r\n\t\t\t\t\t\t\tthis.postOPSR(oView, fnSuccess, fnError);\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase fQ:\r\n\t\t\t\t\t\t\tthis.postFL(oView, fnSuccess, fnError);\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase fR:\r\n\t\t\t\t\t\t\tthis.postDT(oView, fnSuccess, fnError);\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase fS:\r\n\t\t\t\t\t\t\tthis.postSP(oView, fnSuccess, fnError);\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase fT:\r\n\t\t\t\t\t\t\tthis.postRR(oView, fnSuccess, fnError);\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tdefault:\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\r\n\t\t\t\t\t// 工作票数据交互处理函数\r\n\t\t\t\t\tpostEAMWT : function(oView, fnSuccess, fnError) {\r\n\r\n\t\t\t\t\t\tthis._Controller = oView.getController();\r\n\t\t\t\t\t\tthis._ODataModel = this._Controller.getModel(\"OData\");\r\n\t\t\t\t\t\tthis._JSONModel = this._Controller.getModel();\r\n\t\t\t\t\t\tvar sFCode = this._JSONModel.getProperty(\"/appProperties/fcode\");// 公用fcode\r\n\t\t\t\t\t\tthis._Controller.setBusy(true);\r\n\r\n\t\t\t\t\t\t// 工作票数据集\r\n\t\t\t\t\t\tvar oWT = this._JSONModel.getData().wtSet;\r\n\t\t\t\t\t\tvar oRequest = this._Controller.clone(oWT);\r\n\t\t\t\t\t\toRequest.Fcode = sFCode;\r\n\t\t\t\t\t\t// UIC备份\r\n\t\t\t\t\t\tvar oUICBackup = oRequest.np_wt2uic;\r\n\t\t\t\t\t\t// 相关行项目\r\n\t\t\t\t\t\toRequest.np_wt2uic = [];\r\n\t\t\t\t\t\toRequest.np_wt2it = !oRequest.np_wt2it ? [] : oRequest.np_wt2it;\r\n\t\t\t\t\t\toRequest.np_wt2da = !oRequest.np_wt2da ? [] : oRequest.np_wt2da;\r\n\t\t\t\t\t\toRequest.np_wt2sm01 = !oRequest.np_wt2sm01 ? [] : oRequest.np_wt2sm01;\r\n\t\t\t\t\t\toRequest.np_wt2sm02 = !oRequest.np_wt2sm02 ? [] : oRequest.np_wt2sm02;\r\n\t\t\t\t\t\toRequest.np_wt2sm03 = !oRequest.np_wt2sm03 ? [] : oRequest.np_wt2sm03;\r\n\t\t\t\t\t\toRequest.np_wt2sm04 = !oRequest.np_wt2sm04 ? [] : oRequest.np_wt2sm04;\r\n\t\t\t\t\t\toRequest.np_wt2sm05 = !oRequest.np_wt2sm05 ? [] : oRequest.np_wt2sm05;\r\n\t\t\t\t\t\toRequest.np_wt2sm06 = !oRequest.np_wt2sm06 ? [] : oRequest.np_wt2sm06;\r\n\t\t\t\t\t\toRequest.np_wt2ro = !oRequest.np_wt2ro ? [] : oRequest.np_wt2ro;\r\n\t\t\t\t\t\toRequest.np_wt2cf = !oRequest.np_wt2cf ? [] : oRequest.np_wt2cf;\r\n\t\t\t\t\t\toRequest.np_wt2hl = !oRequest.np_wt2hl ? [] : oRequest.np_wt2hl;\r\n\t\t\t\t\t\toRequest.np_wt2bt = !oRequest.np_wt2bt ? [] : oRequest.np_wt2bt;\r\n\t\t\t\t\t\toRequest.np_wt2s = !oRequest.np_wt2s ? [] : oRequest.np_wt2s;\r\n\t\t\t\t\t\toRequest.np_wt2a = !oRequest.np_wt2a ? [] : oRequest.np_wt2a;\r\n\t\t\t\t\t\toRequest.np_wt2t = !oRequest.np_wt2t ? [] : oRequest.np_wt2t;\r\n\r\n\t\t\t\t\t\tvar sUrl = \"/wtSet\";\r\n\t\t\t\t\t\tvar mParameters = {\r\n\t\t\t\t\t\t\tsuccess : function(oData, response) {\r\n\t\t\t\t\t\t\t\tvar localData = this._JSONModel.getData();\r\n\t\t\t\t\t\t\t\tlocalData.wtSet = oData;\r\n\t\t\t\t\t\t\t\tlocalData.wtSet.np_wt2it = oData.np_wt2it != null ? oData.np_wt2it.results : null;\r\n\t\t\t\t\t\t\t\tlocalData.wtSet.np_wt2ro = oData.np_wt2ro != null ? oData.np_wt2ro.results : null;\r\n\t\t\t\t\t\t\t\tlocalData.wtSet.np_wt2sm01 = oData.np_wt2sm01 != null ? oData.np_wt2sm01.results : null;\r\n\t\t\t\t\t\t\t\tlocalData.wtSet.np_wt2sm02 = oData.np_wt2sm02 != null ? oData.np_wt2sm02.results : null;\r\n\t\t\t\t\t\t\t\tlocalData.wtSet.np_wt2sm03 = oData.np_wt2sm03 != null ? oData.np_wt2sm03.results : null;\r\n\t\t\t\t\t\t\t\tlocalData.wtSet.np_wt2sm04 = oData.np_wt2sm04 != null ? oData.np_wt2sm04.results : null;\r\n\t\t\t\t\t\t\t\tlocalData.wtSet.np_wt2sm05 = oData.np_wt2sm05 != null ? oData.np_wt2sm05.results : null;\r\n\t\t\t\t\t\t\t\tlocalData.wtSet.np_wt2sm06 = oData.np_wt2sm06 != null ? oData.np_wt2sm06.results : null;\r\n\t\t\t\t\t\t\t\tlocalData.wtSet.np_wt2da = oData.np_wt2da != null ? oData.np_wt2da.results : null;\r\n\t\t\t\t\t\t\t\tlocalData.wtSet.np_wt2hl = oData.np_wt2hl != null ? oData.np_wt2hl.results : null;\r\n\t\t\t\t\t\t\t\tlocalData.wtSet.np_wt2cf = oData.np_wt2cf != null ? oData.np_wt2cf.results : null;\r\n\t\t\t\t\t\t\t\tlocalData.wtSet.np_wt2bt = oData.np_wt2bt != null ? oData.np_wt2bt.results : null;\r\n\t\t\t\t\t\t\t\tlocalData.wtSet.np_wt2s = oData.np_wt2s != null ? oData.np_wt2s.results : null;\r\n\t\t\t\t\t\t\t\tlocalData.wtSet.np_wt2a = oData.np_wt2a != null ? oData.np_wt2a.results : null;\r\n\t\t\t\t\t\t\t\tlocalData.wtSet.np_wt2t = oData.np_wt2t != null ? oData.np_wt2t.results : null;\r\n\t\t\t\t\t\t\t\tlocalData.wtSet.np_wt2uic = oData.np_wt2uic != null ? oData.np_wt2uic.results : oUICBackup;\r\n\t\t\t\t\t\t\t\tif (jQuery.isArray(localData.wtSet.np_wt2uic)) {\r\n\t\t\t\t\t\t\t\t\tlocalData.wtSet.np_wt2uic = formatter.convertUIC(localData.wtSet.np_wt2uic);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tthis._JSONModel.setProperty(\"/\", localData, false);\r\n\t\t\t\t\t\t\t\tmessages.convertMessage(this, \"/wtSet/np_wt2bt\");\r\n\t\t\t\t\t\t\t\tthis._Controller.setBusy(false);\r\n\t\t\t\t\t\t\t\tif (fnSuccess) {\r\n\t\t\t\t\t\t\t\t\tfnSuccess(this._Controller);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}.bind(this),\r\n\t\t\t\t\t\t\terror : function(oError) {\r\n\t\t\t\t\t\t\t\tthis._Controller.setBusy(false);\r\n\t\t\t\t\t\t\t\tthis._Controller.oError = oError;\r\n\t\t\t\t\t\t\t\tmessages.convertODataErrorMessage(this._Controller);\r\n\t\t\t\t\t\t\t\tthis._Controller.updateObligatory();\r\n\t\t\t\t\t\t\t\tif (fnError) {\r\n\t\t\t\t\t\t\t\t\tfnError(this._Controller);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}.bind(this)\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t\tthis._ODataModel.create(sUrl, oRequest, mParameters);\r\n\r\n\t\t\t\t\t},\r\n\r\n\t\t\t\t\t// 备件需求提报数据交互处理函数\r\n\t\t\t\t\tpostBEIJIAN : function(oView, fnSuccess, fnError) {\r\n\r\n\t\t\t\t\t\tthis._Controller = oView.getController();\r\n\t\t\t\t\t\tthis._ODataModel = this._Controller.getModel(\"OData\");\r\n\t\t\t\t\t\tthis._JSONModel = this._Controller.getModel();\r\n\t\t\t\t\t\tvar sFCode = this._JSONModel.getProperty(\"/appProperties/fcode\");//公用属性fcode\r\n\r\n\t\t\t\t\t\tthis._Controller.setBusy(true);\r\n\t\t\t\t\t// 数据集\r\n\t\t\t\t\t\tvar oBJH = this._JSONModel.getData().bjhSet;\r\n\t\t\t\t\t\tvar oRequest = this._Controller.clone(oBJH);\r\n\t\t\t\t\t\toRequest.Fcode = sFCode;\r\n\t\t\t\t\t// 相关行项目\r\n\t\t\t\t\t\toRequest.np_bjh2bt = !oRequest.np_bjh2bt ? [] : oRequest.np_bjh2bt;\r\n\t\t\t\t\t\toRequest.np_bjh2i = !oRequest.np_bjh2i ? [] : oRequest.np_bjh2i;\r\n\t\t\t\t\t\toRequest.np_bjh2s = !oRequest.np_bjh2s ? [] : oRequest.np_bjh2s;\r\n\t\t\t\t\t\toRequest.np_bjh2a = !oRequest.np_bjh2a ? [] : oRequest.np_bjh2a;\r\n\t\t\t\t\t\toRequest.np_bjh2t = !oRequest.np_bjh2t ? [] : oRequest.np_bjh2t;\r\n\r\n\t\t\t\t\t\tvar sUrl = \"/bjhSet\";\r\n\t\t\t\t\t\tvar mParameters = {\r\n\t\t\t\t\t\t\tsuccess : function(oData, response) {\r\n\t\t\t\t\t\t\t\tvar localData = this._JSONModel.getData();\r\n\t\t\t\t\t\t\t\tlocalData.bjhSet = oData;\r\n\t\t\t\t\t\t\t\tlocalData.bjhSet.np_bjh2bt = oData.np_bjh2bt != null ? oData.np_bjh2bt.results : null;\r\n\t\t\t\t\t\t\t\tlocalData.bjhSet.np_bjh2i = oData.np_bjh2i != null ? oData.np_bjh2i.results : null;\r\n\t\t\t\t\t\t\t\tlocalData.bjhSet.np_bjh2s = oData.np_bjh2s != null ? oData.np_bjh2s.results : null;\r\n\t\t\t\t\t\t\t\tlocalData.bjhSet.np_bjh2a = oData.np_bjh2a != null ? oData.np_bjh2a.results : null;\r\n\t\t\t\t\t\t\t\tlocalData.bjhSet.np_bjh2t = oData.np_bjh2t != null ? oData.np_bjh2t.results : null;\r\n\t\t\t\t\t\t\t\tthis._JSONModel.setProperty(\"/\", localData, false);\r\n\t\t\t\t\t\t\t\tmessages.convertMessage(this, \"/bjhSet/np_bjh2bt\");\r\n\t\t\t\t\t\t\t\tthis._Controller.setBusy(false);\r\n\t\t\t\t\t\t\t\tif (fnSuccess) {\r\n\t\t\t\t\t\t\t\t\tfnSuccess(this._Controller);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}.bind(this),\r\n\t\t\t\t\t\t\terror : function(oError) {\r\n\t\t\t\t\t\t\t\tthis._Controller.setBusy(false);\r\n\t\t\t\t\t\t\t\tthis._Controller.oError = oError;\r\n\t\t\t\t\t\t\t\tmessages.convertODataErrorMessage(this._Controller);\r\n\t\t\t\t\t\t\t\tif (fnError) {\r\n\t\t\t\t\t\t\t\t\tfnError(this._Controller);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}.bind(this)\r\n\t\t\t\t\t\t};\r\n\r\n\t\t\t\t\t\tthis._ODataModel.create(sUrl, oRequest, mParameters);\r\n\r\n\t\t\t\t\t},\r\n\r\n\t\t\t\t\t// 缺陷登记数据交互处理函数\r\n\t\t\t\t\tpostDEFECT : function(oView, fnSuccess, fnError) {\r\n\r\n\t\t\t\t\t\tthis._Controller = oView.getController();\r\n\t\t\t\t\t\tthis._ODataModel = this._Controller.getModel(\"OData\");\r\n\t\t\t\t\t\tthis._JSONModel = this._Controller.getModel();\r\n\t\t\t\t\t\tvar sFCode = this._JSONModel.getProperty(\"/appProperties/fcode\");//公用属性fcode\r\n\t\t\t\t\t\tthis._Controller.setBusy(true);\r\n\t\t\t\t\t// 数据集\r\n\t\t\t\t\t\tvar oDH = this._JSONModel.getData().dhSet;\r\n\t\t\t\t\t\tvar oRequest = this._Controller.clone(oDH);\r\n\t\t\t\t\t\toRequest.Fcode = sFCode;\r\n\t\t\t\t\t// UIC备份\r\n\t\t\t\t\t\tvar oUICBackup = oRequest.np_dh2uic;\r\n\t\t\t\t\t// 相关行项目\r\n\t\t\t\t\t\toRequest.np_dh2uic = [];\r\n\t\t\t\t\t\toRequest.np_dh2ro = !oRequest.np_dh2ro ? [] : oRequest.np_dh2ro;\r\n\t\t\t\t\t\toRequest.np_dh2bt = !oRequest.np_dh2bt ? [] : oRequest.np_dh2bt;\r\n\t\t\t\t\t\toRequest.np_dh2hn = !oRequest.np_dh2hn ? [] : oRequest.np_dh2hn;\r\n\t\t\t\t\t\toRequest.np_dh2s = !oRequest.np_dh2s ? [] : oRequest.np_dh2s;\r\n\t\t\t\t\t\toRequest.np_dh2a = !oRequest.np_dh2a ? [] : oRequest.np_dh2a;\r\n\t\t\t\t\t\toRequest.np_dh2t = !oRequest.np_dh2t ? [] : oRequest.np_dh2t;\r\n\r\n\t\t\t\t\t\tvar sUrl = \"/dhSet\";\r\n\t\t\t\t\t\tvar mParameters = {\r\n\t\t\t\t\t\t\tsuccess : function(oData, response) {\r\n\t\t\t\t\t\t\t\tvar localData = this._JSONModel.getData();\r\n\t\t\t\t\t\t\t\tlocalData.dhSet = oData;\r\n\t\t\t\t\t\t\t\tlocalData.dhSet.np_dh2ro = oData.np_dh2ro != null ? oData.np_dh2ro.results : null;\r\n\t\t\t\t\t\t\t\tlocalData.dhSet.np_dh2bt = oData.np_dh2bt != null ? oData.np_dh2bt.results : null;\r\n\t\t\t\t\t\t\t\tlocalData.dhSet.np_dh2hn = oData.np_dh2hn != null ? oData.np_dh2hn.results : null;\r\n\t\t\t\t\t\t\t\tlocalData.dhSet.np_dh2s = oData.np_dh2s != null ? oData.np_dh2s.results : null;\r\n\t\t\t\t\t\t\t\tlocalData.dhSet.np_dh2a = oData.np_dh2a != null ? oData.np_dh2a.results : null;\r\n\t\t\t\t\t\t\t\tlocalData.dhSet.np_dh2t = oData.np_dh2t != null ? oData.np_dh2t.results : null;\r\n\t\t\t\t\t\t\t\tlocalData.dhSet.np_dh2uic = oData.np_dh2uic != null ? oData.np_dh2uic.results : oUICBackup;\r\n\t\t\t\t\t\t\t\tif (jQuery.isArray(localData.dhSet.np_dh2uic)) {\r\n\t\t\t\t\t\t\t\t\tlocalData.dhSet.np_dh2uic = formatter.convertUIC(localData.dhSet.np_dh2uic);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tthis._JSONModel.setProperty(\"/\", localData, false);\r\n\t\t\t\t\t\t\t\tmessages.convertMessage(this, \"/dhSet/np_dh2bt\");\r\n\t\t\t\t\t\t\t\tthis._Controller.setBusy(false);\r\n\t\t\t\t\t\t\t\tif (fnSuccess) {\r\n\t\t\t\t\t\t\t\t\tfnSuccess(this._Controller);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}.bind(this),\r\n\t\t\t\t\t\t\terror : function(oError) {\r\n\t\t\t\t\t\t\t\tthis._Controller.setBusy(false);\r\n\t\t\t\t\t\t\t\tthis._Controller.oError = oError;\r\n\t\t\t\t\t\t\t\tmessages.convertODataErrorMessage(this._Controller);\r\n\t\t\t\t\t\t\t\tthis._Controller.updateObligatory();\r\n\t\t\t\t\t\t\t\tif (fnError) {\r\n\t\t\t\t\t\t\t\t\tfnError(this._Controller);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}.bind(this)\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t\tthis._ODataModel.create(sUrl, oRequest, mParameters);\r\n\r\n\t\t\t\t\t},\r\n\r\n\t\t\t\t\t// 交接班日志数据交互处理函数\r\n\t\t\t\t\tpostSHA : function(oView, fnSuccess, fnError) {\r\n\r\n\t\t\t\t\t\tthis._Controller = oView.getController();\r\n\t\t\t\t\t\tthis._ODataModel = this._Controller.getModel(\"OData\");\r\n\t\t\t\t\t\tthis._JSONModel = this._Controller.getModel();\r\n\t\t\t\t\t\tvar sFCode = this._JSONModel.getProperty(\"/appProperties/fcode\");//公用属性fcode\r\n\t\t\t\t\t\tthis._Controller.setBusy(true);\r\n\t\t\t\t\t// 数据集\r\n\t\t\t\t\t\tvar oSHA = this._JSONModel.getData().shaSet;\r\n\t\t\t\t\t\tvar oRequest = this._Controller.clone(oSHA);\r\n\t\t\t\t\t\toRequest.Fcode = sFCode;\r\n\t\t\t\t\t// UIC备份\r\n\t\t\t\t\t\tvar oUICBackup = oRequest.np_sha2uic;\r\n\t\t\t\t\t// 相关行项目\r\n\t\t\t\t\t\toRequest.np_sha2uic = [];\r\n\t\t\t\t\t\toRequest.np_sha2bt = !oRequest.np_sha2bt ? [] : oRequest.np_sha2bt;\r\n\t\t\t\t\t\toRequest.np_sha2as = !oRequest.np_sha2as ? [] : oRequest.np_sha2as;\r\n\t\t\t\t\t\toRequest.np_sha2j = !oRequest.np_sha2j ? [] : oRequest.np_sha2j;\r\n\t\t\t\t\t\toRequest.np_sha2es = !oRequest.np_sha2es ? [] : oRequest.np_sha2es;\r\n\t\t\t\t\t\toRequest.np_sha2gs = !oRequest.np_sha2gs ? [] : oRequest.np_sha2gs;\r\n\t\t\t\t\t\toRequest.np_sha2r = !oRequest.np_sha2r ? [] : oRequest.np_sha2r;\r\n\t\t\t\t\t\toRequest.np_sha2rc = !oRequest.np_sha2rc ? [] : oRequest.np_sha2rc;\r\n\t\t\t\t\t\toRequest.np_sha2l = !oRequest.np_sha2l ? [] : oRequest.np_sha2l;\r\n\t\t\t\t\t\toRequest.np_sha2rl = !oRequest.np_sha2rl ? [] : oRequest.np_sha2rl;\r\n\t\t\t\t\t\toRequest.np_sha2pc = !oRequest.np_sha2pc ? [] : oRequest.np_sha2pc;\r\n\t\t\t\t\t\toRequest.np_sha2wka = !oRequest.np_sha2wka ? [] : oRequest.np_sha2wka;\r\n\t\t\t\t\t\toRequest.np_sha2wkq = !oRequest.np_sha2wkq ? [] : oRequest.np_sha2wkq;\r\n\t\t\t\t\t\toRequest.np_sha2grdl = !oRequest.np_sha2grdl ? [] : oRequest.np_sha2grdl;\r\n\t\t\t\t\t\toRequest.np_sha2gsw = !oRequest.np_sha2gsw ? [] : oRequest.np_sha2gsw;\r\n\t\t\t\t\t\toRequest.np_sha2rdoc = !oRequest.np_sha2rdoc ? [] : oRequest.np_sha2rdoc;\r\n\t\t\t\t\t\toRequest.np_sha2grdq = !oRequest.np_sha2grdq ? [] : oRequest.np_sha2grdq;\r\n\t\t\t\t\t\toRequest.np_sha2gswq = !oRequest.np_sha2gswq ? [] : oRequest.np_sha2gswq;\r\n\t\t\t\t\t\toRequest.np_sha2opr = !oRequest.np_sha2opr ? [] : oRequest.np_sha2opr;\r\n\t\t\t\t\t\toRequest.np_sha2oph = !oRequest.np_sha2oph ? [] : oRequest.np_sha2oph;\r\n\t\t\t\t\t\toRequest.np_sha2oprq = !oRequest.np_sha2oprq ? [] : oRequest.np_sha2oprq;\r\n\t\t\t\t\t\toRequest.np_sha2tt = !oRequest.np_sha2tt ? [] : oRequest.np_sha2tt;\r\n\t\t\t\t\t\toRequest.np_sha2ttq = !oRequest.np_sha2ttq ? [] : oRequest.np_sha2ttq;\r\n\t\t\t\t\t\toRequest.np_sha2tth = !oRequest.np_sha2tth ? [] : oRequest.np_sha2tth;\r\n\t\t\t\t\t\toRequest.np_sha2tti = !oRequest.np_sha2tti ? [] : oRequest.np_sha2tti;\r\n\t\t\t\t\t\toRequest.np_sha2df = !oRequest.np_sha2df ? [] : oRequest.np_sha2df;\r\n\t\t\t\t\t\toRequest.np_sha2dfq = !oRequest.np_sha2dfq ? [] : oRequest.np_sha2dfq;\r\n\t\t\t\t\t\toRequest.np_sha2dfh = !oRequest.np_sha2dfh ? [] : oRequest.np_sha2dfh;\r\n\t\t\t\t\t\toRequest.np_sha2hn = !oRequest.np_sha2hn ? [] : oRequest.np_sha2hn;\r\n\t\t\t\t\t\toRequest.np_sha2wt = !oRequest.np_sha2wt ? [] : oRequest.np_sha2wt;\r\n\t\t\t\t\t\toRequest.np_sha2wtq = !oRequest.np_sha2wtq ? [] : oRequest.np_sha2wtq;\r\n\t\t\t\t\t\toRequest.np_sha2wth = !oRequest.np_sha2wth ? [] : oRequest.np_sha2wth;\r\n\t\t\t\t\t\toRequest.np_sha2wti = !oRequest.np_sha2wti ? [] : oRequest.np_sha2wti;\r\n\t\t\t\t\t\toRequest.np_sha2wtd = !oRequest.np_sha2wtd ? [] : oRequest.np_sha2wtd;\r\n\t\t\t\t\t\toRequest.np_sha2wts = !oRequest.np_sha2wts ? [] : oRequest.np_sha2wts;\r\n\t\t\t\t\t\toRequest.np_sha2cz = !oRequest.np_sha2cz ? [] : oRequest.np_sha2cz;\r\n\t\t\t\t\t\toRequest.np_sha2czq = !oRequest.np_sha2czq ? [] : oRequest.np_sha2czq;\r\n\t\t\t\t\t\toRequest.np_sha2czh = !oRequest.np_sha2czh ? [] : oRequest.np_sha2czh;\r\n\t\t\t\t\t\toRequest.np_sha2czi = !oRequest.np_sha2czi ? [] : oRequest.np_sha2czi;\r\n\t\t\t\t\t\toRequest.np_sha2czd = !oRequest.np_sha2czd ? [] : oRequest.np_sha2czd;\r\n\t\t\t\t\t\toRequest.np_sha2uic = !oRequest.np_sha2uic ? [] : oRequest.np_sha2uic;\r\n\r\n\t\t\t\t\t\tvar sUrl = \"/shaSet\";\r\n\t\t\t\t\t\tvar mParameters = {\r\n\t\t\t\t\t\t\tsuccess : function(oData, response) {\r\n\t\t\t\t\t\t\t\tvar localData = this._JSONModel.getData();\r\n\t\t\t\t\t\t\t\tlocalData.shaSet = oData;\r\n\t\t\t\t\t\t\t\tlocalData.shaSet.np_sha2bt = oData.np_sha2bt != null ? oData.np_sha2bt.results : null;\r\n\t\t\t\t\t\t\t\tlocalData.shaSet.np_sha2as = oData.np_sha2as != null ? oData.np_sha2as.results : null;\r\n\t\t\t\t\t\t\t\tlocalData.shaSet.np_sha2j = oData.np_sha2j != null ? oData.np_sha2j.results : null;\r\n\t\t\t\t\t\t\t\tlocalData.shaSet.np_sha2es = oData.np_sha2es != null ? oData.np_sha2es.results : null;\r\n\t\t\t\t\t\t\t\tlocalData.shaSet.np_sha2gs = oData.np_sha2gs != null ? oData.np_sha2gs.results : null;\r\n\t\t\t\t\t\t\t\tlocalData.shaSet.np_sha2r = oData.np_sha2r != null ? oData.np_sha2r.results : null;\r\n\t\t\t\t\t\t\t\tlocalData.shaSet.np_sha2rc = oData.np_sha2rc != null ? oData.np_sha2rc.results : null;\r\n\t\t\t\t\t\t\t\tlocalData.shaSet.np_sha2l = oData.np_sha2l != null ? oData.np_sha2l.results : null;\r\n\t\t\t\t\t\t\t\tlocalData.shaSet.np_sha2rl = oData.np_sha2rl != null ? oData.np_sha2rl.results : null;\r\n\t\t\t\t\t\t\t\tlocalData.shaSet.np_sha2pc = oData.np_sha2pc != null ? oData.np_sha2pc.results : null;\r\n\t\t\t\t\t\t\t\tlocalData.shaSet.np_sha2wka = oData.np_sha2wka != null ? oData.np_sha2wka.results : null;\r\n\t\t\t\t\t\t\t\tlocalData.shaSet.np_sha2wkq = oData.np_sha2wkq != null ? oData.np_sha2wkq.results : null;\r\n\t\t\t\t\t\t\t\tlocalData.shaSet.np_sha2grdl = oData.np_sha2grdl != null ? oData.np_sha2grdl.results : null;\r\n\t\t\t\t\t\t\t\tlocalData.shaSet.np_sha2gsw = oData.np_sha2gsw != null ? oData.np_sha2gsw.results : null;\r\n\t\t\t\t\t\t\t\tlocalData.shaSet.np_sha2rdoc = oData.np_sha2rdoc != null ? oData.np_sha2rdoc.results : null;\r\n\t\t\t\t\t\t\t\tlocalData.shaSet.np_sha2grdq = oData.np_sha2grdq != null ? oData.np_sha2grdq.results : null;\r\n\t\t\t\t\t\t\t\tlocalData.shaSet.np_sha2gswq = oData.np_sha2gswq != null ? oData.np_sha2gswq.results : null;\r\n\t\t\t\t\t\t\t\tlocalData.shaSet.np_sha2opr = oData.np_sha2opr != null ? oData.np_sha2opr.results : null;\r\n\t\t\t\t\t\t\t\tlocalData.shaSet.np_sha2oph = oData.np_sha2oph != null ? oData.np_sha2oph.results : null;\r\n\t\t\t\t\t\t\t\tlocalData.shaSet.np_sha2oprq = oData.np_sha2oprq != null ? oData.np_sha2oprq.results : null;\r\n\t\t\t\t\t\t\t\tlocalData.shaSet.np_sha2tt = oData.np_sha2tt != null ? oData.np_sha2tt.results : null;\r\n\t\t\t\t\t\t\t\tlocalData.shaSet.np_sha2ttq = oData.np_sha2ttq != null ? oData.np_sha2ttq.results : null;\r\n\t\t\t\t\t\t\t\tlocalData.shaSet.np_sha2tth = oData.np_sha2tth != null ? oData.np_sha2tth.results : null;\r\n\t\t\t\t\t\t\t\tlocalData.shaSet.np_sha2tti = oData.np_sha2tti != null ? oData.np_sha2tti.results : null;\r\n\t\t\t\t\t\t\t\tlocalData.shaSet.np_sha2df = oData.np_sha2df != null ? oData.np_sha2df.results : null;\r\n\t\t\t\t\t\t\t\tlocalData.shaSet.np_sha2dfq = oData.np_sha2dfq != null ? oData.np_sha2dfq.results : null;\r\n\t\t\t\t\t\t\t\tlocalData.shaSet.np_sha2dfh = oData.np_sha2dfh != null ? oData.np_sha2dfh.results : null;\r\n\t\t\t\t\t\t\t\tlocalData.shaSet.np_sha2hn = oData.np_sha2hn != null ? oData.np_sha2hn.results : null;\r\n\t\t\t\t\t\t\t\tlocalData.shaSet.np_sha2wt = oData.np_sha2wt != null ? oData.np_sha2wt.results : null;\r\n\t\t\t\t\t\t\t\tlocalData.shaSet.np_sha2wtq = oData.np_sha2wtq != null ? oData.np_sha2wtq.results : null;\r\n\t\t\t\t\t\t\t\tlocalData.shaSet.np_sha2wth = oData.np_sha2wth != null ? oData.np_sha2wth.results : null;\r\n\t\t\t\t\t\t\t\tlocalData.shaSet.np_sha2wti = oData.np_sha2wti != null ? oData.np_sha2wti.results : null;\r\n\t\t\t\t\t\t\t\tlocalData.shaSet.np_sha2wtd = oData.np_sha2wtd != null ? oData.np_sha2wtd.results : null;\r\n\t\t\t\t\t\t\t\tlocalData.shaSet.np_sha2wts = oData.np_sha2wts != null ? oData.np_sha2wts.results : null;\r\n\t\t\t\t\t\t\t\tlocalData.shaSet.np_sha2cz = oData.np_sha2cz != null ? oData.np_sha2cz.results : null;\r\n\t\t\t\t\t\t\t\tlocalData.shaSet.np_sha2czq = oData.np_sha2czq != null ? oData.np_sha2czq.results : null;\r\n\t\t\t\t\t\t\t\tlocalData.shaSet.np_sha2czh = oData.np_sha2czh != null ? oData.np_sha2czh.results : null;\r\n\t\t\t\t\t\t\t\tlocalData.shaSet.np_sha2czi = oData.np_sha2czi != null ? oData.np_sha2czi.results : null;\r\n\t\t\t\t\t\t\t\tlocalData.shaSet.np_sha2czd = oData.np_sha2czd != null ? oData.np_sha2czd.results : null;\r\n\t\t\t\t\t\t\t\tlocalData.shaSet.np_sha2uic = oData.np_sha2uic != null ? oData.np_sha2uic.results : oUICBackup;\r\n\t\t\t\t\t\t\t\tif (jQuery.isArray(localData.shaSet.np_sha2uic)) {\r\n\t\t\t\t\t\t\t\t\tlocalData.shaSet.np_sha2uic = formatter.convertUIC(localData.shaSet.np_sha2uic);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tthis._JSONModel.setProperty(\"/\", localData, false);\r\n\t\t\t\t\t\t\t\tmessages.convertMessage(this, \"/shaSet/np_sha2bt\");\r\n\t\t\t\t\t\t\t\tthis._Controller.setBusy(false);\r\n\t\t\t\t\t\t\t\tif (fnSuccess) {\r\n\t\t\t\t\t\t\t\t\tfnSuccess(this._Controller);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}.bind(this),\r\n\t\t\t\t\t\t\terror : function(oError) {\r\n\t\t\t\t\t\t\t\tthis._Controller.setBusy(false);\r\n\t\t\t\t\t\t\t\tthis._Controller.oError = oError;\r\n\t\t\t\t\t\t\t\tmessages.convertODataErrorMessage(this._Controller);\r\n\t\t\t\t\t\t\t\tif (fnError) {\r\n\t\t\t\t\t\t\t\t\tfnError(this._Controller);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}.bind(this)\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t\tthis._ODataModel.create(sUrl, oRequest, mParameters);\r\n\r\n\t\t\t\t\t},\r\n\r\n\t\t\t\t\t// 光伏工作票数据交互处理函数\r\n\t\t\t\t\tpostPTH : function(oView, fnSuccess, fnError) {\r\n\r\n\t\t\t\t\t\tthis._Controller = oView.getController();\r\n\t\t\t\t\t\tthis._ODataModel = this._Controller.getModel(\"OData\");\r\n\t\t\t\t\t\tthis._JSONModel = this._Controller.getModel();\r\n\t\t\t\t\t\tvar sFCode = this._JSONModel.getProperty(\"/appProperties/fcode\");//公用属性fcode\r\n\t\t\t\t\t\tthis._Controller.setBusy(true);\r\n\t\t\t\t\t// 数据集\r\n\t\t\t\t\t\tvar oPTH = this._JSONModel.getData().pthSet;\r\n\t\t\t\t\t\tvar oRequest = this._Controller.clone(oPTH);\r\n\t\t\t\t\t\toRequest.Fcode = sFCode;\r\n\t\t\t\t\t// UIC备份\r\n\t\t\t\t\t\tvar oUICBackup = oRequest.np_pth2uic;\r\n\t\t\t\t\t// 相关行项目\r\n\t\t\t\t\t\toRequest.np_pth2uic = [];\r\n\t\t\t\t\t\toRequest.np_pth2f = !oRequest.np_pth2f ? [] : oRequest.np_pth2f;\r\n\t\t\t\t\t\toRequest.np_pth2bpo = !oRequest.np_pth2bpo ? [] : oRequest.np_pth2bpo;\r\n\t\t\t\t\t\toRequest.np_pth2da = !oRequest.np_pth2da ? [] : oRequest.np_pth2da;\r\n\t\t\t\t\t\toRequest.np_pth2dac = !oRequest.np_pth2dac ? [] : oRequest.np_pth2dac;\r\n\t\t\t\t\t\toRequest.np_pth2gd = !oRequest.np_pth2gd ? [] : oRequest.np_pth2gd;\r\n\t\t\t\t\t\toRequest.np_pth2ap = !oRequest.np_pth2ap ? [] : oRequest.np_pth2ap;\r\n\t\t\t\t\t\toRequest.np_pth2f4 = !oRequest.np_pth2f4 ? [] : oRequest.np_pth2f4;\r\n\t\t\t\t\t\toRequest.np_pth2bt = !oRequest.np_pth2bt ? [] : oRequest.np_pth2bt;\r\n\t\t\t\t\t\toRequest.np_pth2uic = !oRequest.np_pth2uic ? [] : oRequest.np_pth2uic;\r\n\r\n\t\t\t\t\t\tvar sUrl = \"/pthSet\";\r\n\t\t\t\t\t\tvar mParameters = {\r\n\t\t\t\t\t\t\tsuccess : function(oData, response) {\r\n\t\t\t\t\t\t\t\tvar localData = this._JSONModel.getData();\r\n\t\t\t\t\t\t\t\tlocalData.pthSet = oData;\r\n\t\t\t\t\t\t\t\tlocalData.pthSet.np_pth2f = oData.np_pth2f != null ? oData.np_pth2f.results : null;\r\n\t\t\t\t\t\t\t\tlocalData.pthSet.np_pth2bpo = oData.np_pth2bpo != null ? oData.np_pth2bpo.results : null;\r\n\t\t\t\t\t\t\t\tlocalData.pthSet.np_pth2da = oData.np_pth2da != null ? oData.np_pth2da.results : null;\r\n\t\t\t\t\t\t\t\tlocalData.pthSet.np_pth2dac = oData.np_pth2dac != null ? oData.np_pth2dac.results : null;\r\n\t\t\t\t\t\t\t\tlocalData.pthSet.np_pth2gd = oData.np_pth2gd != null ? oData.np_pth2gd.results : null;\r\n\t\t\t\t\t\t\t\tlocalData.pthSet.np_pth2ap = oData.np_pth2ap != null ? oData.np_pth2ap.results : null;\r\n\t\t\t\t\t\t\t\tlocalData.pthSet.np_pth2f4 = oData.np_pth2f4 != null ? oData.np_pth2f4.results : null;\r\n\t\t\t\t\t\t\t\tlocalData.pthSet.np_pth2bt = oData.np_pth2bt != null ? oData.np_pth2bt.results : null;\r\n\t\t\t\t\t\t\t\tlocalData.pthSet.np_pth2uic = oData.np_pth2uic != null ? oData.np_pth2uic.results : oUICBackup;\r\n\t\t\t\t\t\t\t\tif (jQuery.isArray(localData.pthSet.np_pth2uic)) {\r\n\t\t\t\t\t\t\t\t\tlocalData.pthSet.np_pth2uic = formatter.convertUIC(localData.pthSet.np_pth2uic);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tthis._JSONModel.setProperty(\"/\", localData, false);\r\n\t\t\t\t\t\t\t\tmessages.convertMessage(this, \"/pthSet/np_pth2bt\");\r\n\t\t\t\t\t\t\t\tthis._Controller.setBusy(false);\r\n\t\t\t\t\t\t\t\tif (fnSuccess) {\r\n\t\t\t\t\t\t\t\t\tfnSuccess(this._Controller);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}.bind(this),\r\n\t\t\t\t\t\t\terror : function(oError) {\r\n\t\t\t\t\t\t\t\tthis._Controller.setBusy(false);\r\n\t\t\t\t\t\t\t\tthis._Controller.oError = oError;\r\n\t\t\t\t\t\t\t\tmessages.convertODataErrorMessage(this._Controller);\r\n\t\t\t\t\t\t\t\tthis._Controller.updateObligatory();\r\n\t\t\t\t\t\t\t\tif (fnError) {\r\n\t\t\t\t\t\t\t\t\tfnError(this._Controller);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}.bind(this)\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t\tthis._ODataModel.create(sUrl, oRequest, mParameters);\r\n\r\n\t\t\t\t\t},\r\n\r\n\t\t\t\t\t// 日志排班数据交互处理函数\r\n\t\t\t\t\tpostSHTH : function(oView, fnSuccess, fnError) {\r\n\r\n\t\t\t\t\t\tthis._Controller = oView.getController();\r\n\t\t\t\t\t\tthis._ODataModel = this._Controller.getModel(\"OData\");\r\n\t\t\t\t\t\tthis._JSONModel = this._Controller.getModel();\r\n\t\t\t\t\t\tvar sFCode = this._JSONModel.getProperty(\"/appProperties/fcode\");//公用属性fcode\r\n\t\t\t\t\t\tthis._Controller.setBusy(true);\r\n\t\t\t\t\t// 数据集\r\n\t\t\t\t\t\tvar oSHTH = this._JSONModel.getData().shthSet;\r\n\t\t\t\t\t\tvar oRequest = this._Controller.clone(oSHTH);\r\n\t\t\t\t\t\toRequest.Fcode = sFCode;\r\n\t\t\t\t\t// 相关行项目\r\n\t\t\t\t\t\toRequest.np_shth2bt = !oRequest.np_shth2bt ? [] : oRequest.np_shth2bt;\r\n\t\t\t\t\t\toRequest.np_shth2sc = !oRequest.np_shth2sc ? [] : oRequest.np_shth2sc;\r\n\t\t\t\t\t\toRequest.np_shth2s = !oRequest.np_shth2s ? [] : oRequest.np_shth2s;\r\n\t\t\t\t\t\toRequest.np_shth2hs = !oRequest.np_shth2hs ? [] : oRequest.np_shth2hs;\r\n\r\n\t\t\t\t\t\tvar sUrl = \"/shthSet\";\r\n\t\t\t\t\t\tvar mParameters = {\r\n\t\t\t\t\t\t\tsuccess : function(oData, response) {\r\n\t\t\t\t\t\t\t\tvar localData = this._JSONModel.getData();\r\n\t\t\t\t\t\t\t\tlocalData.shthSet = oData;\r\n\t\t\t\t\t\t\t\tlocalData.shthSet.np_shth2sc = oData.np_shth2sc != null ? oData.np_shth2sc.results : null;\r\n\t\t\t\t\t\t\t\tlocalData.shthSet.np_shth2s = oData.np_shth2s != null ? oData.np_shth2s.results : null;\r\n\t\t\t\t\t\t\t\tlocalData.shthSet.np_shth2hs = oData.np_shth2hs != null ? oData.np_shth2hs.results : null;\r\n\t\t\t\t\t\t\t\tlocalData.shthSet.np_shth2bt = oData.np_shth2bt != null ? oData.np_shth2bt.results : null;\r\n\t\t\t\t\t\t\t\tthis._JSONModel.setProperty(\"/\", localData, false);\r\n\t\t\t\t\t\t\t\tmessages.convertMessage(this, \"/shthSet/np_shth2bt\");\r\n\t\t\t\t\t\t\t\tthis._Controller.setBusy(false);\r\n\t\t\t\t\t\t\t\tif (fnSuccess) {\r\n\t\t\t\t\t\t\t\t\tfnSuccess(this._Controller);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}.bind(this),\r\n\t\t\t\t\t\t\terror : function(oError) {\r\n\t\t\t\t\t\t\t\tthis._Controller.setBusy(false);\r\n\t\t\t\t\t\t\t\tthis._Controller.oError = oError;\r\n\t\t\t\t\t\t\t\tmessages.convertODataErrorMessage(this._Controller);\r\n\t\t\t\t\t\t\t\tif (fnError) {\r\n\t\t\t\t\t\t\t\t\tfnError(this._Controller);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}.bind(this)\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t\tthis._ODataModel.create(sUrl, oRequest, mParameters);\r\n\r\n\t\t\t\t\t},\r\n\r\n\t\t\t\t\t// 定期工作计划数据交互处理函数\r\n\t\t\t\t\tpostWCP : function(oView, fnSuccess, fnError) {\r\n\r\n\t\t\t\t\t\tthis._Controller = oView.getController();\r\n\t\t\t\t\t\tthis._ODataModel = this._Controller.getModel(\"OData\");\r\n\t\t\t\t\t\tthis._JSONModel = this._Controller.getModel();\r\n\t\t\t\t\t\tvar sFCode = this._JSONModel.getProperty(\"/appProperties/fcode\");// 数据集\r\n\t\t\t\t\t\tthis._Controller.setBusy(true);\r\n\t\t\t\t\t// 数据集\r\n\t\t\t\t\t\tvar oWCP = this._JSONModel.getData().wcpSet;\r\n\t\t\t\t\t\tvar oRequest = this._Controller.clone(oWCP);\r\n\t\t\t\t\t\toRequest.Fcode = sFCode;\r\n\t\t\t\t\t// 相关行项目\r\n\t\t\t\t\t\toRequest.np_wcp2kd = !oRequest.np_wcp2kd ? [] : oRequest.np_wcp2kd;\r\n\t\t\t\t\t\toRequest.np_wcp2hs = !oRequest.np_wcp2hs ? [] : oRequest.np_wcp2hs;\r\n\t\t\t\t\t\toRequest.np_wcp2bt = !oRequest.np_wcp2bt ? [] : oRequest.np_wcp2bt;\r\n\t\t\t\t\t\toRequest.np_wcp2sl = !oRequest.np_wcp2sl ? [] : oRequest.np_wcp2sl;\r\n\r\n\t\t\t\t\t\tvar sUrl = \"/wcpSet\";\r\n\t\t\t\t\t\tvar mParameters = {\r\n\t\t\t\t\t\t\tsuccess : function(oData, response) {\r\n\t\t\t\t\t\t\t\tvar localData = this._JSONModel.getData();\r\n\t\t\t\t\t\t\t\tlocalData.wcpSet = oData;\r\n\t\t\t\t\t\t\t\tlocalData.wcpSet.np_wcp2bt = oData.np_wcp2bt != null ? oData.np_wcp2bt.results : null;\r\n\t\t\t\t\t\t\t\tlocalData.wcpSet.np_wcp2kd = oData.np_wcp2kd != null ? oData.np_wcp2kd.results : null;\r\n\t\t\t\t\t\t\t\tlocalData.wcpSet.np_wcp2hs = oData.np_wcp2hs != null ? oData.np_wcp2hs.results : null;\r\n\t\t\t\t\t\t\t\tlocalData.wcpSet.np_wcp2sl = oData.np_wcp2sl != null ? oData.np_wcp2sl.results : null;\r\n\t\t\t\t\t\t\t\tthis._JSONModel.setProperty(\"/\", localData, false);\r\n\t\t\t\t\t\t\t\tmessages.convertMessage(this, \"/wcpSet/np_wcp2bt\");\r\n\t\t\t\t\t\t\t\tthis._Controller.setBusy(false);\r\n\t\t\t\t\t\t\t\tif (fnSuccess) {\r\n\t\t\t\t\t\t\t\t\tfnSuccess(this._Controller);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}.bind(this),\r\n\t\t\t\t\t\t\terror : function(oError) {\r\n\t\t\t\t\t\t\t\tthis._Controller.setBusy(false);\r\n\t\t\t\t\t\t\t\tthis._Controller.oError = oError;\r\n\t\t\t\t\t\t\t\tmessages.convertODataErrorMessage(this._Controller);\r\n\t\t\t\t\t\t\t\tif (fnError) {\r\n\t\t\t\t\t\t\t\t\tfnError(this._Controller);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}.bind(this)\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t\tthis._ODataModel.create(sUrl, oRequest, mParameters);\r\n\r\n\t\t\t\t\t},\r\n\r\n\t\t\t\t\t// 定期工作任务数据交互处理函数\r\n\t\t\t\t\tpostWCPA : function(oView, fnSuccess, fnError) {\r\n\r\n\t\t\t\t\t\tthis._Controller = oView.getController();\r\n\t\t\t\t\t\tthis._ODataModel = this._Controller.getModel(\"OData\");\r\n\t\t\t\t\t\tthis._JSONModel = this._Controller.getModel();\r\n\t\t\t\t\t\tvar sFCode = this._JSONModel.getProperty(\"/appProperties/fcode\");//公用属性fcode\r\n\t\t\t\t\t\tthis._Controller.setBusy(true);\r\n\t\t\t\t\t// 数据集\r\n\t\t\t\t\t\tvar oWCPA = this._JSONModel.getData().wcpaSet;\r\n\t\t\t\t\t\tvar oRequest = this._Controller.clone(oWCPA);\r\n\t\t\t\t\t\toRequest.Fcode = sFCode;\r\n\t\t\t\t\t// 相关行项目\r\n\t\t\t\t\t\toRequest.np_wcpa2bt = !oRequest.np_sha2bt ? [] : oRequest.np_sha2bt;\r\n\t\t\t\t\t\toRequest.np_wcpa2hs = !oRequest.np_wcpa2hs ? [] : oRequest.np_wcpa2hs;\r\n\t\t\t\t\t\toRequest.np_wcpa2sl = !oRequest.np_wcpa2sl ? [] : oRequest.np_wcpa2sl;\r\n\t\t\t\t\t\toRequest.np_wcpa2opr = !oRequest.np_wcpa2opr ? [] : oRequest.np_wcpa2opr;\r\n\r\n\t\t\t\t\t\tvar sUrl = \"/wcpaSet\";\r\n\t\t\t\t\t\tvar mParameters = {\r\n\t\t\t\t\t\t\tsuccess : function(oData, response) {\r\n\t\t\t\t\t\t\t\tvar localData = this._JSONModel.getData();\r\n\t\t\t\t\t\t\t\tlocalData.wcpaSet = oData;\r\n\t\t\t\t\t\t\t\tlocalData.wcpaSet.np_wcpa2bt = oData.np_wcpa2bt != null ? oData.np_wcpa2bt.results : null;\r\n\t\t\t\t\t\t\t\tlocalData.wcpaSet.np_wcpa2hs = oData.np_wcpa2hs != null ? oData.np_wcpa2hs.results : null;\r\n\t\t\t\t\t\t\t\tlocalData.wcpaSet.np_wcpa2sl = oData.np_wcpa2sl != null ? oData.np_wcpa2sl.results : null;\r\n\t\t\t\t\t\t\t\tlocalData.wcpaSet.np_wcpa2opr = oData.np_wcpa2opr != null ? oData.np_wcpa2opr.results : null;\r\n\t\t\t\t\t\t\t\tthis._JSONModel.setProperty(\"/\", localData, false);\r\n\t\t\t\t\t\t\t\tmessages.convertMessage(this, \"/wcpaSet/np_wcpa2bt\");\r\n\t\t\t\t\t\t\t\tthis._Controller.setBusy(false);\r\n\t\t\t\t\t\t\t\tif (fnSuccess) {\r\n\t\t\t\t\t\t\t\t\tfnSuccess(this._Controller);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}.bind(this),\r\n\t\t\t\t\t\t\terror : function(oError) {\r\n\t\t\t\t\t\t\t\tthis._Controller.setBusy(false);\r\n\t\t\t\t\t\t\t\tthis._Controller.oError = oError;\r\n\t\t\t\t\t\t\t\tmessages.convertODataErrorMessage(this._Controller);\r\n\t\t\t\t\t\t\t\tif (fnError) {\r\n\t\t\t\t\t\t\t\t\tfnError(this._Controller);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}.bind(this)\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t\tthis._ODataModel.create(sUrl, oRequest, mParameters);\r\n\r\n\t\t\t\t\t},\r\n\r\n\t\t\t\t\t// 维修作业许可数据交互处理函数\r\n\t\t\t\t\tpostMTPM : function(oView, fnSuccess, fnError) {\r\n\r\n\t\t\t\t\t\tthis._Controller = oView.getController();\r\n\t\t\t\t\t\tthis._ODataModel = this._Controller.getModel(\"OData\");\r\n\t\t\t\t\t\tthis._JSONModel = this._Controller.getModel();\r\n\t\t\t\t\t\tvar sFCode = this._JSONModel.getProperty(\"/appProperties/fcode\");//公用属性fcode\r\n\t\t\t\t\t\tthis._Controller.setBusy(true);\r\n\t\t\t\t\t// 数据集\r\n\t\t\t\t\t\tvar oMTPMH = this._JSONModel.getData().mtpmhSet;\r\n\t\t\t\t\t\tvar oRequest = this._Controller.clone(oMTPMH);\r\n\t\t\t\t\t\toRequest.Fcode = sFCode;\r\n\t\t\t\t\t// UIC备份\r\n\t\t\t\t\t\tvar oUICBackup = oRequest.np_mtpmh2uic;\r\n\t\t\t\t\t// 相关行项目\r\n\t\t\t\t\t\toRequest.np_mtpmh2uic = [];\r\n\t\t\t\t\t\toRequest.np_mtpmh2bt = !oRequest.np_mtpmh2bt ? [] : oRequest.np_mtpmh2bt;\r\n\t\t\t\t\t\toRequest.np_mtpmh2ptf = !oRequest.np_mtpmh2ptf ? [] : oRequest.np_mtpmh2ptf;\r\n\t\t\t\t\t\toRequest.np_mtpmh2da = !oRequest.np_mtpmh2da ? [] : oRequest.np_mtpmh2da;\r\n\t\t\t\t\t\toRequest.np_mtpmh2da2 = !oRequest.np_mtpmh2da2 ? [] : oRequest.np_mtpmh2da2;\r\n\t\t\t\t\t\tvar sUrl = \"/mtpmhSet\";\r\n\t\t\t\t\t\tvar mParameters = {\r\n\t\t\t\t\t\t\tsuccess : function(oData, response) {\r\n\t\t\t\t\t\t\t\tvar localData = this._JSONModel.getData();\r\n\t\t\t\t\t\t\t\tlocalData.mtpmhSet = oData;\r\n\t\t\t\t\t\t\t\tlocalData.mtpmhSet.np_mtpmh2da = oData.np_mtpmh2da != null ? oData.np_mtpmh2da.results : null;\r\n\t\t\t\t\t\t\t\tlocalData.mtpmhSet.np_mtpmh2da2 = oData.np_mtpmh2da2 != null ? oData.np_mtpmh2da2.results : null;\r\n\t\t\t\t\t\t\t\tlocalData.mtpmhSet.np_mtpmh2ptf = oData.np_mtpmh2ptf != null ? oData.np_mtpmh2ptf.results : null;\r\n\t\t\t\t\t\t\t\tlocalData.mtpmhSet.np_mtpmh2bt = oData.np_mtpmh2bt != null ? oData.np_mtpmh2bt.results : null;\r\n\t\t\t\t\t\t\t\tlocalData.mtpmhSet.np_mtpmh2uic = oData.np_mtpmh2uic != null ? oData.np_mtpmh2uic.results : oUICBackup;\r\n\t\t\t\t\t\t\t\tif (jQuery.isArray(localData.mtpmhSet.np_mtpmh2uic)) {\r\n\t\t\t\t\t\t\t\t\tlocalData.mtpmhSet.np_mtpmh2uic = formatter.convertUIC(localData.mtpmhSet.np_mtpmh2uic);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tthis._JSONModel.setProperty(\"/\", localData, false);\r\n\t\t\t\t\t\t\t\tmessages.convertMessage(this, \"/mtpmhSet/np_mtpmh2bt\");\r\n\t\t\t\t\t\t\t\tthis._Controller.setBusy(false);\r\n\t\t\t\t\t\t\t\tif (fnSuccess) {\r\n\t\t\t\t\t\t\t\t\tfnSuccess(this._Controller);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}.bind(this),\r\n\t\t\t\t\t\t\terror : function(oError) {\r\n\t\t\t\t\t\t\t\tthis._Controller.setBusy(false);\r\n\t\t\t\t\t\t\t\tthis._Controller.oError = oError;\r\n\t\t\t\t\t\t\t\tmessages.convertODataErrorMessage(this._Controller);\r\n\t\t\t\t\t\t\t\tthis._Controller.updateObligatory();\r\n\t\t\t\t\t\t\t\tif (fnError) {\r\n\t\t\t\t\t\t\t\t\tfnError(this._Controller);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}.bind(this)\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t\tthis._ODataModel.create(sUrl, oRequest, mParameters);\r\n\r\n\t\t\t\t\t},\r\n\r\n\t\t\t\t\t// 工作票报表数据交互处理函数\r\n\t\t\t\t\tpostTKH : function(oView, fnSuccess, fnError) {\r\n\r\n\t\t\t\t\t\tthis._Controller = oView.getController();\r\n\t\t\t\t\t\tthis._ODataModel = this._Controller.getModel(\"OData\");\r\n\t\t\t\t\t\tthis._JSONModel = this._Controller.getModel();\r\n\t\t\t\t\t\tvar sFCode = this._JSONModel.getProperty(\"/appProperties/fcode\");//公用属性fcode\r\n\r\n\t\t\t\t\t\tthis._Controller.setBusy(true);\r\n\t\t\t\t\t// 数据集\r\n\t\t\t\t\t\tvar oTKH = this._JSONModel.getData().tkhSet;\r\n\t\t\t\t\t\tvar oRequest = this._Controller.clone(oTKH);\r\n\t\t\t\t\t\toRequest.Fcode = sFCode;\r\n\t\t\t\t\t// UIC备份\r\n\t\t\t\t\t\tvar oUICBackup = oRequest.np_tkh2uic;\r\n\t\t\t\t\t// 相关行项目\r\n\t\t\t\t\t\toRequest.np_tkh2uic = [];\r\n\t\t\t\t\t\toRequest.np_tkh2la = !oRequest.np_tkh2la ? [] : oRequest.np_tkh2la;\r\n\t\t\t\t\t\toRequest.np_tkh2q = !oRequest.np_tkh2q ? [] : oRequest.np_tkh2q;\r\n\t\t\t\t\t\toRequest.np_tkh2bt = !oRequest.np_tkh2bt ? [] : oRequest.np_tkh2bt;\r\n\r\n\t\t\t\t\t\tvar sUrl = \"/tkhSet\";\r\n\t\t\t\t\t\tvar mParameters = {\r\n\t\t\t\t\t\t\tsuccess : function(oData, response) {\r\n\t\t\t\t\t\t\t\tvar localData = this._JSONModel.getData();\r\n\t\t\t\t\t\t\t\tlocalData.tkhSet = oData;\r\n\t\t\t\t\t\t\t\tlocalData.tkhSet.np_tkh2la = oData.np_tkh2la != null ? oData.np_tkh2la.results : null;\r\n\t\t\t\t\t\t\t\tlocalData.tkhSet.np_tkh2q = oData.np_tkh2q != null ? oData.np_tkh2q.results : null;\r\n\t\t\t\t\t\t\t\tlocalData.tkhSet.np_tkh2bt = oData.np_tkh2bt != null ? oData.np_tkh2bt.results : null;\r\n\t\t\t\t\t\t\t\tlocalData.tkhSet.np_tkh2uic = oData.np_tkh2uic != null ? oData.np_tkh2uic.results : oUICBackup;\r\n\t\t\t\t\t\t\t\tif (jQuery.isArray(localData.tkhSet.np_tkh2uic)) {\r\n\t\t\t\t\t\t\t\t\tlocalData.tkhSet.np_tkh2uic = formatter.convertUIC(localData.tkhSet.np_tkh2uic);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tthis._JSONModel.setProperty(\"/\", localData, false);\r\n\t\t\t\t\t\t\t\tmessages.convertMessage(this, \"/bjhSet/np_tkh2bt\");\r\n\t\t\t\t\t\t\t\tthis._Controller.setBusy(false);\r\n\t\t\t\t\t\t\t\tif (fnSuccess) {\r\n\t\t\t\t\t\t\t\t\tfnSuccess(this._Controller);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}.bind(this),\r\n\t\t\t\t\t\t\terror : function(oError) {\r\n\t\t\t\t\t\t\t\tthis._Controller.setBusy(false);\r\n\t\t\t\t\t\t\t\tthis._Controller.oError = oError;\r\n\t\t\t\t\t\t\t\tmessages.convertODataErrorMessage(this._Controller);\r\n\t\t\t\t\t\t\t\tthis._Controller.updateObligatory();\r\n\t\t\t\t\t\t\t\tif (fnError) {\r\n\t\t\t\t\t\t\t\t\tfnError(this._Controller);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}.bind(this)\r\n\t\t\t\t\t\t};\r\n\r\n\t\t\t\t\t\tthis._ODataModel.create(sUrl, oRequest, mParameters);\r\n\r\n\t\t\t\t\t},\r\n\r\n\t\t\t\t\t// 运行通知数据交互处理函数\r\n\t\t\t\t\tpostOPH : function(oView, fnSuccess, fnError) {\r\n\r\n\t\t\t\t\t\tthis._Controller = oView.getController();\r\n\t\t\t\t\t\tthis._ODataModel = this._Controller.getModel(\"OData\");\r\n\t\t\t\t\t\tthis._JSONModel = this._Controller.getModel();\r\n\t\t\t\t\t\tvar sFCode = this._JSONModel.getProperty(\"/appProperties/fcode\");//公用属性fcode\r\n\t\t\t\t\t\tthis._Controller.setBusy(true);\r\n\t\t\t\t\t// 数据集\r\n\t\t\t\t\t\tvar oOPH = this._JSONModel.getData().ophSet;\r\n\t\t\t\t\t\tvar oRequest = this._Controller.clone(oOPH);\r\n\t\t\t\t\t\toRequest.Fcode = sFCode;\r\n\t\t\t\t\t// UIC备份\r\n\t\t\t\t\t\tvar oUICBackup = oRequest.np_oph2uic;\r\n\t\t\t\t\t// 相关行项目\r\n\t\t\t\t\t\toRequest.np_oph2uic = [];\r\n\t\t\t\t\t\toRequest.np_oph2hs = !oRequest.np_oph2hs ? [] : oRequest.np_oph2hs;\r\n\t\t\t\t\t\toRequest.np_oph2c = !oRequest.np_oph2c ? [] : oRequest.np_oph2c;\r\n\t\t\t\t\t\toRequest.np_oph2g = !oRequest.np_oph2g ? [] : oRequest.np_oph2g;\r\n\t\t\t\t\t\toRequest.np_oph2s = !oRequest.np_oph2s ? [] : oRequest.np_oph2s;\r\n\t\t\t\t\t\toRequest.np_oph2o = !oRequest.np_oph2o ? [] : oRequest.np_oph2o;\r\n\t\t\t\t\t\toRequest.np_oph2bt = !oRequest.np_oph2bt ? [] : oRequest.np_oph2bt;\r\n\r\n\t\t\t\t\t\tvar sUrl = \"/ophSet\";\r\n\t\t\t\t\t\tvar mParameters = {\r\n\t\t\t\t\t\t\tsuccess : function(oData, response) {\r\n\t\t\t\t\t\t\t\tvar localData = this._JSONModel.getData();\r\n\t\t\t\t\t\t\t\tlocalData.ophSet = oData;\r\n\t\t\t\t\t\t\t\tlocalData.ophSet.np_oph2hs = oData.np_oph2hs != null ? oData.np_oph2hs.results : null;\r\n\t\t\t\t\t\t\t\tlocalData.ophSet.np_oph2c = oData.np_oph2c != null ? oData.np_oph2c.results : null;\r\n\t\t\t\t\t\t\t\tlocalData.ophSet.np_oph2g = oData.np_oph2g != null ? oData.np_oph2g.results : null;\r\n\t\t\t\t\t\t\t\tlocalData.ophSet.np_oph2s = oData.np_oph2s != null ? oData.np_oph2s.results : null;\r\n\t\t\t\t\t\t\t\tlocalData.ophSet.np_oph2o = oData.np_oph2o != null ? oData.np_oph2o.results : null;\r\n\t\t\t\t\t\t\t\tlocalData.ophSet.np_oph2bt = oData.np_oph2bt != null ? oData.np_oph2bt.results : null;\r\n\t\t\t\t\t\t\t\tlocalData.ophSet.np_oph2uic = oData.np_oph2uic != null ? oData.np_oph2uic.results : oUICBackup;\r\n\t\t\t\t\t\t\t\tif (jQuery.isArray(localData.ophSet.np_oph2uic)) {\r\n\t\t\t\t\t\t\t\t\tlocalData.ophSet.np_oph2uic = formatter.convertUIC(localData.ophSet.np_oph2uic);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tthis._JSONModel.setProperty(\"/\", localData, false);\r\n\t\t\t\t\t\t\t\tmessages.convertMessage(this, \"/ophSet/np_oph2bt\");\r\n\t\t\t\t\t\t\t\tthis._Controller.setBusy(false);\r\n\t\t\t\t\t\t\t\tif (fnSuccess) {\r\n\t\t\t\t\t\t\t\t\tfnSuccess(this._Controller);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}.bind(this),\r\n\t\t\t\t\t\t\terror : function(oError) {\r\n\t\t\t\t\t\t\t\tthis._Controller.setBusy(false);\r\n\t\t\t\t\t\t\t\tthis._Controller.oError = oError;\r\n\t\t\t\t\t\t\t\tmessages.convertODataErrorMessage(this._Controller);\r\n\t\t\t\t\t\t\t\tthis._Controller.updateObligatory();\r\n\t\t\t\t\t\t\t\tif (fnError) {\r\n\t\t\t\t\t\t\t\t\tfnError(this._Controller);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}.bind(this)\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t\tthis._ODataModel.create(sUrl, oRequest, mParameters);\r\n\r\n\t\t\t\t\t},\r\n\r\n\t\t\t\t\t// 保护投退功能增强数据交互处理函数\r\n\t\t\t\t\tpostTTN : function(oView, fnSuccess, fnError) {\r\n\r\n\t\t\t\t\t\tthis._Controller = oView.getController();\r\n\t\t\t\t\t\tthis._ODataModel = this._Controller.getModel(\"OData\");\r\n\t\t\t\t\t\tthis._JSONModel = this._Controller.getModel();\r\n\t\t\t\t\t\tvar sFCode = this._JSONModel.getProperty(\"/appProperties/fcode\");//公用属性fcode\r\n\r\n\t\t\t\t\t\tthis._Controller.setBusy(true);\r\n\t\t\t\t\t// 数据集\r\n\t\t\t\t\t\tvar oTTN = this._JSONModel.getData().ttnSet;\r\n\t\t\t\t\t\tvar oRequest = this._Controller.clone(oTTN);\r\n\t\t\t\t\t\toRequest.Fcode = sFCode;\r\n\t\t\t\t\t// UIC备份\r\n\t\t\t\t\t\tvar oUICBackup = oRequest.np_ttn2uic;\r\n\t\t\t\t\t// 相关行项目\r\n\t\t\t\t\t\toRequest.np_ttn2uic = [];\r\n\t\t\t\t\t\toRequest.np_ttn2bt = !oRequest.np_ttn2bt ? [] : oRequest.np_ttn2bt;\r\n\t\t\t\t\t\toRequest.np_ttn2ta = !oRequest.np_ttn2ta ? [] : oRequest.np_ttn2ta;\r\n\t\t\t\t\t\toRequest.np_ttn2s = !oRequest.np_ttn2s ? [] : oRequest.np_ttn2s;\r\n\t\t\t\t\t\toRequest.np_ttn2a = !oRequest.np_ttn2a ? [] : oRequest.np_ttn2a;\r\n\t\t\t\t\t\toRequest.np_ttn2t = !oRequest.np_ttn2t ? [] : oRequest.np_ttn2t;\r\n\r\n\t\t\t\t\t\tvar sUrl = \"/ttnSet\";\r\n\t\t\t\t\t\tvar mParameters = {\r\n\t\t\t\t\t\t\tsuccess : function(oData, response) {\r\n\t\t\t\t\t\t\t\tvar localData = this._JSONModel.getData();\r\n\t\t\t\t\t\t\t\tlocalData.ttnSet = oData;\r\n\t\t\t\t\t\t\t\tlocalData.ttnSet.np_ttn2bt = oData.np_ttn2bt != null ? oData.np_ttn2bt.results : null;\r\n\t\t\t\t\t\t\t\tlocalData.ttnSet.np_ttn2ta = oData.np_ttn2ta != null ? oData.np_ttn2ta.results : null;\r\n\t\t\t\t\t\t\t\tlocalData.ttnSet.np_ttn2s = oData.np_ttn2s != null ? oData.np_ttn2s.results : null;\r\n\t\t\t\t\t\t\t\tlocalData.ttnSet.np_ttn2a = oData.np_ttn2a != null ? oData.np_ttn2a.results : null;\r\n\t\t\t\t\t\t\t\tlocalData.ttnSet.np_ttn2t = oData.np_ttn2t != null ? oData.np_ttn2t.results : null;\r\n\t\t\t\t\t\t\t\tlocalData.ttnSet.np_ttn2uic = oData.np_ttn2uic != null ? oData.np_ttn2uic.results : oUICBackup;\r\n\t\t\t\t\t\t\t\tif (jQuery.isArray(localData.ttnSet.np_ttn2uic)) {\r\n\t\t\t\t\t\t\t\t\tlocalData.ttnSet.np_ttn2uic = formatter.convertUIC(localData.ttnSet.np_ttn2uic);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tthis._JSONModel.setProperty(\"/\", localData, false);\r\n\t\t\t\t\t\t\t\tmessages.convertMessage(this, \"/ttnSet/np_ttn2bt\");\r\n\t\t\t\t\t\t\t\tthis._Controller.setBusy(false);\r\n\t\t\t\t\t\t\t\tif (fnSuccess) {\r\n\t\t\t\t\t\t\t\t\tfnSuccess(this._Controller);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}.bind(this),\r\n\t\t\t\t\t\t\terror : function(oError) {\r\n\t\t\t\t\t\t\t\tthis._Controller.setBusy(false);\r\n\t\t\t\t\t\t\t\tthis._Controller.oError = oError;\r\n\t\t\t\t\t\t\t\tmessages.convertODataErrorMessage(this._Controller);\r\n\t\t\t\t\t\t\t\tthis._Controller.updateObligatory();\r\n\t\t\t\t\t\t\t\tif (fnError) {\r\n\t\t\t\t\t\t\t\t\tfnError(this._Controller);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}.bind(this)\r\n\t\t\t\t\t\t};\r\n\r\n\t\t\t\t\t\tthis._ODataModel.create(sUrl, oRequest, mParameters);\r\n\r\n\t\t\t\t\t},\r\n\r\n\t\t\t\t\t// 缺陷报表数据交互处理函数\r\n\t\t\t\t\tpostDF : function(oView, fnSuccess, fnError) {\r\n\r\n\t\t\t\t\t\tthis._Controller = oView.getController();\r\n\t\t\t\t\t\tthis._ODataModel = this._Controller.getModel(\"OData\");\r\n\t\t\t\t\t\tthis._JSONModel = this._Controller.getModel();\r\n\t\t\t\t\t\tvar sFCode = this._JSONModel.getProperty(\"/appProperties/fcode\");//公用属性fcode\r\n\r\n\t\t\t\t\t\tthis._Controller.setBusy(true);\r\n\t\t\t\t\t// 数据集\r\n\t\t\t\t\t\tvar oDF = this._JSONModel.getData().dfSet;\r\n\t\t\t\t\t\tvar oRequest = this._Controller.clone(oDF);\r\n\t\t\t\t\t\toRequest.Fcode = sFCode;\r\n\t\t\t\t\t// UIC备份\r\n\t\t\t\t\t\tvar oUICBackup = oRequest.np_df2uic;\r\n\t\t\t\t\t// 相关行项目\r\n\t\t\t\t\t\toRequest.np_df2uic = [];\r\n\t\t\t\t\t\toRequest.np_df2bt = !oRequest.np_df2bt ? [] : oRequest.np_df2bt;\r\n\t\t\t\t\t\toRequest.np_df2dfs = !oRequest.np_df2dfs ? [] : oRequest.np_df2dfs;\r\n\r\n\t\t\t\t\t\tvar sUrl = \"/dfSet\";\r\n\t\t\t\t\t\tvar mParameters = {\r\n\t\t\t\t\t\t\tsuccess : function(oData, response) {\r\n\t\t\t\t\t\t\t\tvar localData = this._JSONModel.getData();\r\n\t\t\t\t\t\t\t\tlocalData.dfSet = oData;\r\n\t\t\t\t\t\t\t\tlocalData.dfSet.np_df2dfs = oData.np_df2dfs != null ? oData.np_df2dfs.results : null;\r\n\t\t\t\t\t\t\t\tlocalData.dfSet.np_df2bt = oData.np_df2bt != null ? oData.np_df2bt.results : null;\r\n\t\t\t\t\t\t\t\tlocalData.dfSet.np_df2uic = oData.np_df2uic != null ? oData.np_df2uic.results : oUICBackup;\r\n\t\t\t\t\t\t\t\tif (jQuery.isArray(localData.dfSet.np_df2uic)) {\r\n\t\t\t\t\t\t\t\t\tlocalData.dfSet.np_df2uic = formatter.convertUIC(localData.dfSet.np_df2uic);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tthis._JSONModel.setProperty(\"/\", localData, false);\r\n\t\t\t\t\t\t\t\tmessages.convertMessage(this, \"/dfSet/np_df2bt\");\r\n\t\t\t\t\t\t\t\tthis._Controller.setBusy(false);\r\n\t\t\t\t\t\t\t\tif (fnSuccess) {\r\n\t\t\t\t\t\t\t\t\tfnSuccess(this._Controller);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}.bind(this),\r\n\t\t\t\t\t\t\terror : function(oError) {\r\n\t\t\t\t\t\t\t\tthis._Controller.setBusy(false);\r\n\t\t\t\t\t\t\t\tthis._Controller.oError = oError;\r\n\t\t\t\t\t\t\t\tmessages.convertODataErrorMessage(this._Controller);\r\n\t\t\t\t\t\t\t\tthis._Controller.updateObligatory();\r\n\t\t\t\t\t\t\t\tif (fnError) {\r\n\t\t\t\t\t\t\t\t\tfnError(this._Controller);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}.bind(this)\r\n\t\t\t\t\t\t};\r\n\r\n\t\t\t\t\t\tthis._ODataModel.create(sUrl, oRequest, mParameters);\r\n\r\n\t\t\t\t\t},\r\n\r\n\t\t\t\t\t// 临时用电数据交互处理函数\r\n\t\t\t\t\tpostTEA : function(oView, fnSuccess, fnError) {\r\n\t\t\t\t\t\tthis._Controller = oView.getController();\r\n\t\t\t\t\t\tthis._ODataModel = this._Controller.getModel(\"OData\");\r\n\t\t\t\t\t\tthis._JSONModel = this._Controller.getModel();\r\n\t\t\t\t\t\tvar sFCode = this._JSONModel.getProperty(\"/appProperties/fcode\");// 公用属性fcode\r\n\r\n\t\t\t\t\t\tthis._Controller.setBusy(true);\r\n\t\t\t\t\t\t// 数据集\r\n\t\t\t\t\t\tvar oTE = this._JSONModel.getData().teahSet;\r\n\t\t\t\t\t\tvar oRequest = this._Controller.clone(oTE);\r\n\t\t\t\t\t\toRequest.Fcode = sFCode;\r\n\t\t\t\t\t\t// UIC备份\r\n\t\t\t\t\t\tvar oUICBackup = oRequest.np_teah2uic;\r\n\t\t\t\t\t\t// 相关行项目\r\n\t\t\t\t\t\toRequest.np_teah2uic = [];\r\n\t\t\t\t\t\toRequest.np_teah2bt = !oRequest.np_teah2bt ? [] : oRequest.np_teah2bt;\r\n\t\t\t\t\t\toRequest.np_teah2i = !oRequest.np_teah2i ? [] : oRequest.np_teah2i;\r\n\r\n\t\t\t\t\t\tvar sUrl = \"/teahSet\";\r\n\t\t\t\t\t\tvar mParameters = {\r\n\t\t\t\t\t\t\tsuccess : function(oData, response) {\r\n\t\t\t\t\t\t\t\tvar localData = this._JSONModel.getData();\r\n\t\t\t\t\t\t\t\tlocalData.teahSet = oData;\r\n\t\t\t\t\t\t\t\tlocalData.teahSet.np_teah2i = oData.np_teah2i != null ? oData.np_teah2i.results : null;\r\n\t\t\t\t\t\t\t\tlocalData.teahSet.np_teah2bt = oData.np_teah2bt != null ? oData.np_teah2bt.results : null;\r\n\t\t\t\t\t\t\t\tlocalData.teahSet.np_teah2uic = oData.np_teah2uic != null ? oData.np_teah2uic.results : oUICBackup;\r\n\t\t\t\t\t\t\t\tif (jQuery.isArray(localData.teahSet.np_teah2uic)) {\r\n\t\t\t\t\t\t\t\t\tlocalData.teahSet.np_teah2uic = formatter.convertUIC(localData.teahSet.np_teah2uic);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tthis._JSONModel.setProperty(\"/\", localData, false);\r\n\t\t\t\t\t\t\t\tmessages.convertMessage(this, \"/teahSet/np_teah2bt\");\r\n\t\t\t\t\t\t\t\tthis._Controller.setBusy(false);\r\n\t\t\t\t\t\t\t\tif (fnSuccess) {\r\n\t\t\t\t\t\t\t\t\tfnSuccess(this._Controller);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}.bind(this),\r\n\t\t\t\t\t\t\terror : function(oError) {\r\n\t\t\t\t\t\t\t\tthis._Controller.setBusy(false);\r\n\t\t\t\t\t\t\t\tthis._Controller.oError = oError;\r\n\t\t\t\t\t\t\t\tmessages.convertODataErrorMessage(this._Controller);\r\n\t\t\t\t\t\t\t\tthis._Controller.updateObligatory();\r\n\t\t\t\t\t\t\t\tif (fnError) {\r\n\t\t\t\t\t\t\t\t\tfnError(this._Controller);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}.bind(this)\r\n\t\t\t\t\t\t};\r\n\r\n\t\t\t\t\t\tthis._ODataModel.create(sUrl, oRequest, mParameters);\r\n\t\t\t\t\t},\r\n\r\n\t\t\t\t\t// 操作票数据交互处理函数\r\n\t\t\t\t\tpostOPT : function(oView, fnSuccess, fnError) {\r\n\t\t\t\t\t\tthis._Controller = oView.getController();\r\n\t\t\t\t\t\tthis._ODataModel = this._Controller.getModel(\"OData\");\r\n\t\t\t\t\t\tthis._JSONModel = this._Controller.getModel();\r\n\t\t\t\t\t\tvar sFCode = this._JSONModel.getProperty(\"/appProperties/fcode\");// 公用属性fcode\r\n\r\n\t\t\t\t\t\tthis._Controller.setBusy(true);\r\n\t\t\t\t\t\t// 数据集\r\n\t\t\t\t\t\tvar oOPT = this._JSONModel.getData().opthSet;\r\n\t\t\t\t\t\tvar oRequest = this._Controller.clone(oOPT);\r\n\t\t\t\t\t\toRequest.Fcode = sFCode;\r\n\t\t\t\t\t\t// UIC备份\r\n\t\t\t\t\t\tvar oUICBackup = oRequest.np_opth2uic;\r\n\t\t\t\t\t\t// 相关行项目\r\n\t\t\t\t\t\toRequest.np_opth2uic = [];\r\n\t\t\t\t\t\toRequest.np_opth2bt = !oRequest.np_opth2bt ? [] : oRequest.np_opth2bt;\r\n\t\t\t\t\t\toRequest.np_opth2da = !oRequest.np_opth2da ? [] : oRequest.np_opth2da;\r\n\t\t\t\t\t\toRequest.np_opth2s = !oRequest.np_opth2s ? [] : oRequest.np_opth2s;\r\n\t\t\t\t\t\toRequest.np_opth2ro = !oRequest.np_opth2ro ? [] : oRequest.np_opth2ro;\r\n\t\t\t\t\t\toRequest.np_opth2i = !oRequest.np_opth2i ? [] : oRequest.np_opth2i;\r\n\t\t\t\t\t\toRequest.np_opth2st = !oRequest.np_opth2st ? [] : oRequest.np_opth2st;\r\n\t\t\t\t\t\toRequest.np_opth2a = !oRequest.np_opth2a ? [] : oRequest.np_opth2a;\r\n\t\t\t\t\t\toRequest.np_opth2t = !oRequest.np_opth2t ? [] : oRequest.np_opth2t;\r\n\r\n\t\t\t\t\t\tvar sUrl = \"/opthSet\";\r\n\t\t\t\t\t\tvar mParameters = {\r\n\t\t\t\t\t\t\tsuccess : function(oData, response) {\r\n\t\t\t\t\t\t\t\tvar localData = this._JSONModel.getData();\r\n\t\t\t\t\t\t\t\tlocalData.opthSet = oData;\r\n\t\t\t\t\t\t\t\tlocalData.opthSet.np_opth2i = oData.np_opth2i != null ? oData.np_opth2i.results : null;\r\n\t\t\t\t\t\t\t\tlocalData.opthSet.np_opth2bt = oData.np_opth2bt != null ? oData.np_opth2bt.results : null;\r\n\t\t\t\t\t\t\t\tlocalData.opthSet.np_opth2s = oData.np_opth2s != null ? oData.np_opth2s.results : null;\r\n\t\t\t\t\t\t\t\tlocalData.opthSet.np_opth2ro = oData.np_opth2ro != null ? oData.np_opth2ro.results : null;\r\n\t\t\t\t\t\t\t\tlocalData.opthSet.np_opth2da = oData.np_opth2da != null ? oData.np_opth2da.results : null;\r\n\t\t\t\t\t\t\t\tlocalData.opthSet.np_opth2st = oData.np_opth2st != null ? oData.np_opth2st.results : null;\r\n\t\t\t\t\t\t\t\tlocalData.opthSet.np_opth2a = oData.np_opth2a != null ? oData.np_opth2a.results : null;\r\n\t\t\t\t\t\t\t\tlocalData.opthSet.np_opth2t = oData.np_opth2t != null ? oData.np_opth2t.results : null;\r\n\t\t\t\t\t\t\t\tlocalData.opthSet.np_opth2uic = oData.np_opth2uic != null ? oData.np_opth2uic.results : oUICBackup;\r\n\t\t\t\t\t\t\t\tif (jQuery.isArray(localData.opthSet.np_opth2uic)) {\r\n\t\t\t\t\t\t\t\t\tlocalData.opthSet.np_opth2uic = formatter.convertUIC(localData.opthSet.np_opth2uic);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tthis._JSONModel.setProperty(\"/\", localData, false);\r\n\t\t\t\t\t\t\t\tmessages.convertMessage(this, \"/opthSet/np_opth2bt\");\r\n\t\t\t\t\t\t\t\tthis._Controller.setBusy(false);\r\n\t\t\t\t\t\t\t\tif (fnSuccess) {\r\n\t\t\t\t\t\t\t\t\tfnSuccess(this._Controller);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}.bind(this),\r\n\t\t\t\t\t\t\terror : function(oError) {\r\n\t\t\t\t\t\t\t\tthis._Controller.setBusy(false);\r\n\t\t\t\t\t\t\t\tthis._Controller.oError = oError;\r\n\t\t\t\t\t\t\t\tmessages.convertODataErrorMessage(this._Controller);\r\n\t\t\t\t\t\t\t\tthis._Controller.updateObligatory();\r\n\t\t\t\t\t\t\t\tif (fnError) {\r\n\t\t\t\t\t\t\t\t\tfnError(this._Controller);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}.bind(this)\r\n\t\t\t\t\t\t};\r\n\r\n\t\t\t\t\t\tthis._ODataModel.create(sUrl, oRequest, mParameters);\r\n\t\t\t\t\t},\r\n\r\n\t\t\t\t\t// 设备试运行数据交互处理函数\r\n\t\t\t\t\tpostTR : function(oView, fnSuccess, fnError) {\r\n\t\t\t\t\t\tthis._Controller = oView.getController();\r\n\t\t\t\t\t\tthis._ODataModel = this._Controller.getModel(\"OData\");\r\n\t\t\t\t\t\tthis._JSONModel = this._Controller.getModel();\r\n\t\t\t\t\t\tvar sFCode = this._JSONModel.getProperty(\"/appProperties/fcode\");// 公用属性fcode\r\n\r\n\t\t\t\t\t\tthis._Controller.setBusy(true);\r\n\t\t\t\t\t\t// 数据集\r\n\t\t\t\t\t\tvar oTR = this._JSONModel.getData().trSet;\r\n\t\t\t\t\t\tvar oRequest = this._Controller.clone(oTR);\r\n\t\t\t\t\t\toRequest.Fcode = sFCode;\r\n\t\t\t\t\t\t// UIC备份\r\n\t\t\t\t\t\tvar oUICBackup = oRequest.np_tr2uic;\r\n\t\t\t\t\t\t// 相关行项目\r\n\t\t\t\t\t\toRequest.np_tr2uic = [];\r\n\t\t\t\t\t\toRequest.np_tr2bt = !oRequest.np_tr2bt ? [] : oRequest.np_tr2bt;\r\n\t\t\t\t\t\toRequest.np_tr2c = !oRequest.np_tr2c ? [] : oRequest.np_tr2c;\r\n\t\t\t\t\t\toRequest.np_tr2s = !oRequest.np_tr2s ? [] : oRequest.np_tr2s;\r\n\t\t\t\t\t\toRequest.np_tr2d = !oRequest.np_tr2d ? [] : oRequest.np_tr2d;\r\n\r\n\t\t\t\t\t\tvar sUrl = \"/trSet\";\r\n\t\t\t\t\t\tvar mParameters = {\r\n\t\t\t\t\t\t\tsuccess : function(oData, response) {\r\n\t\t\t\t\t\t\t\tvar localData = this._JSONModel.getData();\r\n\t\t\t\t\t\t\t\tlocalData.trSet = oData;\r\n\t\t\t\t\t\t\t\tlocalData.trSet.np_tr2bt = oData.np_tr2bt != null ? oData.np_tr2bt.results : null;\r\n\t\t\t\t\t\t\t\tlocalData.trSet.np_tr2uic = oData.np_tr2uic != null ? oData.np_tr2uic.results : oUICBackup;\r\n\t\t\t\t\t\t\t\tlocalData.trSet.np_tr2c = oData.np_tr2c != null ? oData.np_tr2c.results : null;\r\n\t\t\t\t\t\t\t\tlocalData.trSet.np_tr2s = oData.np_tr2s != null ? oData.np_tr2s.results : null;\r\n\t\t\t\t\t\t\t\tlocalData.trSet.np_tr2d = oData.np_tr2d != null ? oData.np_tr2d.results : null;\r\n\t\t\t\t\t\t\t\tif (jQuery.isArray(localData.trSet.np_tr2uic)) {\r\n\t\t\t\t\t\t\t\t\tlocalData.trSet.np_tr2uic = formatter.convertUIC(localData.trSet.np_tr2uic);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tthis._JSONModel.setProperty(\"/\", localData, false);\r\n\t\t\t\t\t\t\t\tmessages.convertMessage(this, \"/trSet/np_tr2bt\");\r\n\t\t\t\t\t\t\t\tthis._Controller.setBusy(false);\r\n\t\t\t\t\t\t\t\tif (fnSuccess) {\r\n\t\t\t\t\t\t\t\t\tfnSuccess(this._Controller);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}.bind(this),\r\n\t\t\t\t\t\t\terror : function(oError) {\r\n\t\t\t\t\t\t\t\tthis._Controller.setBusy(false);\r\n\t\t\t\t\t\t\t\tthis._Controller.oError = oError;\r\n\t\t\t\t\t\t\t\tmessages.convertODataErrorMessage(this._Controller);\r\n\t\t\t\t\t\t\t\tthis._Controller.updateObligatory();\r\n\t\t\t\t\t\t\t\tif (fnError) {\r\n\t\t\t\t\t\t\t\t\tfnError(this._Controller);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}.bind(this)\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t\tthis._ODataModel.create(sUrl, oRequest, mParameters);\r\n\t\t\t\t\t},\r\n\r\n\t\t\t\t\t// 巡更管理数据交互处理函数\r\n\t\t\t\t\tpostXG : function(oView, fnSuccess, fnError) {\r\n\t\t\t\t\t\tthis._Controller = oView.getController();\r\n\t\t\t\t\t\tthis._ODataModel = this._Controller.getModel(\"OData\");\r\n\t\t\t\t\t\tthis._JSONModel = this._Controller.getModel();\r\n\t\t\t\t\t\tvar sFCode = this._JSONModel.getProperty(\"/appProperties/fcode\");// 公用属性fcode\r\n\r\n\t\t\t\t\t\tthis._Controller.setBusy(true);\r\n\t\t\t\t\t\t// 数据集\r\n\t\t\t\t\t\tvar oXG = this._JSONModel.getData().xgSet;\r\n\t\t\t\t\t\tvar oRequest = this._Controller.clone(oXG);\r\n\t\t\t\t\t\toRequest.Fcode = sFCode;\r\n\t\t\t\t\t\t// UIC备份\r\n\t\t\t\t\t\tvar oUICBackup = oRequest.np_xg2uic;\r\n\t\t\t\t\t\t// 相关行项目\r\n\t\t\t\t\t\toRequest.np_xg2uic = [];\r\n\t\t\t\t\t\toRequest.np_xg2i = !oRequest.np_xg2i ? [] : oRequest.np_xg2i;\r\n\t\t\t\t\t\toRequest.np_xg2bt = !oRequest.np_xg2bt ? [] : oRequest.np_xg2bt;\r\n\t\t\t\t\t\toRequest.np_xg2bc = !oRequest.np_xg2bc ? [] : oRequest.np_xg2bc;\r\n\t\t\t\t\t\toRequest.np_xg2rw = !oRequest.np_xg2rw ? [] : oRequest.np_xg2rw;\r\n\r\n\t\t\t\t\t\tvar sUrl = \"/xgSet\";\r\n\t\t\t\t\t\tvar mParameters = {\r\n\t\t\t\t\t\t\tsuccess : function(oData, response) {\r\n\t\t\t\t\t\t\t\tvar localData = this._JSONModel.getData();\r\n\t\t\t\t\t\t\t\tlocalData.xgSet = oData;\r\n\t\t\t\t\t\t\t\tlocalData.xgSet.np_xg2i = oData.np_xg2i != null ? oData.np_xg2i.results : null;\r\n\t\t\t\t\t\t\t\tlocalData.xgSet.np_xg2bt = oData.np_xg2bt != null ? oData.np_xg2bt.results : null;\r\n\t\t\t\t\t\t\t\tlocalData.xgSet.np_xg2bc = oData.np_xg2bc != null ? oData.np_xg2bc.results : null;\r\n\t\t\t\t\t\t\t\tlocalData.xgSet.np_xg2rw = oData.np_xg2rw != null ? oData.np_xg2rw.results : null;\r\n\t\t\t\t\t\t\t\tlocalData.xgSet.np_xg2uic = oData.np_xg2uic != null ? oData.np_xg2uic.results : oUICBackup;\r\n\t\t\t\t\t\t\t\tif (jQuery.isArray(localData.xgSet.np_xg2uic)) {\r\n\t\t\t\t\t\t\t\t\tlocalData.xgSet.np_xg2uic = formatter.convertUIC(localData.xgSet.np_xg2uic);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tthis._JSONModel.setProperty(\"/\", localData, false);\r\n\t\t\t\t\t\t\t\tmessages.convertMessage(this, \"/xgSet/np_xg2bt\");\r\n\t\t\t\t\t\t\t\tthis._Controller.setBusy(false);\r\n\t\t\t\t\t\t\t\tif (fnSuccess) {\r\n\t\t\t\t\t\t\t\t\tfnSuccess(this._Controller);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}.bind(this),\r\n\t\t\t\t\t\t\terror : function(oError) {\r\n\t\t\t\t\t\t\t\tthis._Controller.setBusy(false);\r\n\t\t\t\t\t\t\t\tthis._Controller.oError = oError;\r\n\t\t\t\t\t\t\t\tmessages.convertODataErrorMessage(this._Controller);\r\n\t\t\t\t\t\t\t\tthis._Controller.updateObligatory();\r\n\t\t\t\t\t\t\t\tif (fnError) {\r\n\t\t\t\t\t\t\t\t\tfnError(this._Controller);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}.bind(this)\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t\tthis._ODataModel.create(sUrl, oRequest, mParameters);\r\n\t\t\t\t\t},\r\n\r\n\t\t\t\t\t// 临时用水、压缩空气申请单数据交互处理函数\r\n\t\t\t\t\tpostTW : function(oView, fnSuccess, fnError) {\r\n\t\t\t\t\t\tthis._Controller = oView.getController();\r\n\t\t\t\t\t\tthis._ODataModel = this._Controller.getModel(\"OData\");\r\n\t\t\t\t\t\tthis._JSONModel = this._Controller.getModel();\r\n\t\t\t\t\t\tvar sFCode = this._JSONModel.getProperty(\"/appProperties/fcode\");// 公用属性fcode\r\n\r\n\t\t\t\t\t\tthis._Controller.setBusy(true);\r\n\t\t\t\t\t\t// 数据集\r\n\t\t\t\t\t\tvar oTW = this._JSONModel.getData().tuwaSet;\r\n\t\t\t\t\t\tvar oRequest = this._Controller.clone(oTW);\r\n\t\t\t\t\t\toRequest.Fcode = sFCode;\r\n\t\t\t\t\t\t// UIC备份\r\n\t\t\t\t\t\tvar oUICBackup = oRequest.np_tuwa2uic;\r\n\t\t\t\t\t\t// 相关行项目\r\n\t\t\t\t\t\toRequest.np_tuwa2uic = [];\r\n\t\t\t\t\t\toRequest.np_tuwa2bt = !oRequest.np_tuwa2bt ? [] : oRequest.np_tuwa2bt;\r\n\t\t\t\t\t\toRequest.np_tuwa2it = !oRequest.np_tuwa2it ? [] : oRequest.np_tuwa2it;\r\n\r\n\t\t\t\t\t\tvar sUrl = \"/tuwaSet\";\r\n\t\t\t\t\t\tvar mParameters = {\r\n\t\t\t\t\t\t\tsuccess : function(oData, response) {\r\n\t\t\t\t\t\t\t\tvar localData = this._JSONModel.getData();\r\n\t\t\t\t\t\t\t\tlocalData.tuwaSet = oData;\r\n\t\t\t\t\t\t\t\tlocalData.tuwaSet.np_tuwa2bt = oData.np_tuwa2bt != null ? oData.np_tuwa2bt.results : null;\r\n\t\t\t\t\t\t\t\tlocalData.tuwaSet.np_tuwa2it = oData.np_tuwa2it != null ? oData.np_tuwa2it.results : null;\r\n\t\t\t\t\t\t\t\tlocalData.tuwaSet.np_tuwa2uic = oData.np_tuwa2uic != null ? oData.np_tuwa2uic.results : oUICBackup;\r\n\t\t\t\t\t\t\t\tif (jQuery.isArray(localData.tuwaSet.np_tuwa2uic)) {\r\n\t\t\t\t\t\t\t\t\tlocalData.tuwaSet.np_tuwa2uic = formatter.convertUIC(localData.tuwaSet.np_tuwa2uic);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tthis._JSONModel.setProperty(\"/\", localData, false);\r\n\t\t\t\t\t\t\t\tmessages.convertMessage(this, \"/tuwaSet/np_tuwa2bt\");\r\n\t\t\t\t\t\t\t\tthis._Controller.setBusy(false);\r\n\t\t\t\t\t\t\t\tif (fnSuccess) {\r\n\t\t\t\t\t\t\t\t\tfnSuccess(this._Controller);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}.bind(this),\r\n\t\t\t\t\t\t\terror : function(oError) {\r\n\t\t\t\t\t\t\t\tthis._Controller.setBusy(false);\r\n\t\t\t\t\t\t\t\tthis._Controller.oError = oError;\r\n\t\t\t\t\t\t\t\tmessages.convertODataErrorMessage(this._Controller);\r\n\t\t\t\t\t\t\t\tthis._Controller.updateObligatory();\r\n\t\t\t\t\t\t\t\tif (fnError) {\r\n\t\t\t\t\t\t\t\t\tfnError(this._Controller);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}.bind(this)\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t\tthis._ODataModel.create(sUrl, oRequest, mParameters);\r\n\t\t\t\t\t},\r\n\r\n\t\t\t\t\t// 设备停复役数据交互处理函数\r\n\t\t\t\t\tpostTF : function(oView, fnSuccess, fnError) {\r\n\t\t\t\t\t\tthis._Controller = oView.getController();\r\n\t\t\t\t\t\tthis._ODataModel = this._Controller.getModel(\"OData\");\r\n\t\t\t\t\t\tthis._JSONModel = this._Controller.getModel();\r\n\t\t\t\t\t\tvar sFCode = this._JSONModel.getProperty(\"/appProperties/fcode\");// 公用属性fcode\r\n\r\n\t\t\t\t\t\tthis._Controller.setBusy(true);\r\n\t\t\t\t\t\t// 数据集\r\n\t\t\t\t\t\tvar oTF = this._JSONModel.getData().tfSet;\r\n\t\t\t\t\t\tvar oRequest = this._Controller.clone(oTF);\r\n\t\t\t\t\t\toRequest.Fcode = sFCode;\r\n\t\t\t\t\t\t// UIC备份\r\n\t\t\t\t\t\tvar oUICBackup = oRequest.np_tf2uic;\r\n\t\t\t\t\t\t// 相关行项目\r\n\t\t\t\t\t\toRequest.np_tf2uic = [];\r\n\t\t\t\t\t\toRequest.np_tf2bt = !oRequest.np_tf2bt ? [] : oRequest.np_tf2bt;\r\n\t\t\t\t\t\toRequest.np_tf2s = !oRequest.np_tf2s ? [] : oRequest.np_tf2s;\r\n\t\t\t\t\t\toRequest.np_tf2a = !oRequest.np_tf2a ? [] : oRequest.np_tf2a;\r\n\t\t\t\t\t\toRequest.np_tf2t = !oRequest.np_tf2t ? [] : oRequest.np_tf2t;\r\n\r\n\r\n\t\t\t\t\t\tvar sUrl = \"/tfSet\";\r\n\t\t\t\t\t\tvar mParameters = {\r\n\t\t\t\t\t\t\tsuccess : function(oData, response) {\r\n\t\t\t\t\t\t\t\tvar localData = this._JSONModel.getData();\r\n\t\t\t\t\t\t\t\tlocalData.tfSet = oData;\r\n\t\t\t\t\t\t\t\tlocalData.tfSet.np_tf2bt = oData.np_tf2bt != null ? oData.np_tf2bt.results : null;\r\n\t\t\t\t\t\t\t\tlocalData.tfSet.np_tf2uic = oData.np_tf2uic != null ? oData.np_tf2uic.results : oUICBackup;\r\n\t\t\t\t\t\t\t\tlocalData.tfSet.np_tf2s = oData.np_tf2s != null ? oData.np_tf2s.results : null;\r\n\t\t\t\t\t\t\t\tlocalData.tfSet.np_tf2a = oData.np_tf2a != null ? oData.np_tf2a.results : null;\r\n\t\t\t\t\t\t\t\tlocalData.tfSet.np_tf2t = oData.np_tf2t != null ? oData.np_tf2t.results : null;\r\n\t\t\t\t\t\t\t\tif (jQuery.isArray(localData.tfSet.np_tf2uic)) {\r\n\t\t\t\t\t\t\t\t\tlocalData.tfSet.np_tf2uic = formatter.convertUIC(localData.tfSet.np_tf2uic);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tthis._JSONModel.setProperty(\"/\", localData, false);\r\n\t\t\t\t\t\t\t\tmessages.convertMessage(this, \"/tfSet/np_tf2bt\");\r\n\t\t\t\t\t\t\t\tthis._Controller.setBusy(false);\r\n\t\t\t\t\t\t\t\tif (fnSuccess) {\r\n\t\t\t\t\t\t\t\t\tfnSuccess(this._Controller);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}.bind(this),\r\n\t\t\t\t\t\t\terror : function(oError) {\r\n\t\t\t\t\t\t\t\tthis._Controller.setBusy(false);\r\n\t\t\t\t\t\t\t\tthis._Controller.oError = oError;\r\n\t\t\t\t\t\t\t\tmessages.convertODataErrorMessage(this._Controller);\r\n\t\t\t\t\t\t\t\tthis._Controller.updateObligatory();\r\n\t\t\t\t\t\t\t\tif (fnError) {\r\n\t\t\t\t\t\t\t\t\tfnError(this._Controller);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}.bind(this)\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t\tthis._ODataModel.create(sUrl, oRequest, mParameters);\r\n\t\t\t\t\t},\r\n\r\n\t\t\t\t\t// 停送电联系单数据交互处理函数\r\n\t\t\t\t\tpostSCN : function(oView, fnSuccess, fnError) {\r\n\t\t\t\t\t\tthis._Controller = oView.getController();\r\n\t\t\t\t\t\tthis._ODataModel = this._Controller.getModel(\"OData\");\r\n\t\t\t\t\t\tthis._JSONModel = this._Controller.getModel();\r\n\t\t\t\t\t\tvar sFCode = this._JSONModel.getProperty(\"/appProperties/fcode\");// 公用属性fcode\r\n\r\n\t\t\t\t\t\tthis._Controller.setBusy(true);\r\n\t\t\t\t\t\t// 数据集\r\n\t\t\t\t\t\tvar oSC = this._JSONModel.getData().scnSet;\r\n\t\t\t\t\t\tvar oRequest = this._Controller.clone(oSC);\r\n\t\t\t\t\t\toRequest.Fcode = sFCode;\r\n\t\t\t\t\t\t// UIC备份\r\n\t\t\t\t\t\tvar oUICBackup = oRequest.np_scn2uic;\r\n\t\t\t\t\t\toRequest.np_scn2uic = [];\r\n\t\t\t\t\t\t// 相关行项目\r\n\t\t\t\t\t\toRequest.np_scn2bt = !oRequest.np_scn2bt ? [] : oRequest.np_scn2bt;\r\n\t\t\t\t\t\toRequest.np_scn2it = !oRequest.np_scn2it ? [] : oRequest.np_scn2it;\r\n\r\n\t\t\t\t\t\tvar sUrl = \"/scnSet\";\r\n\t\t\t\t\t\tvar mParameters = {\r\n\t\t\t\t\t\t\tsuccess : function(oData, response) {\r\n\t\t\t\t\t\t\t\tvar localData = this._JSONModel.getData();\r\n\t\t\t\t\t\t\t\tlocalData.scnSet = oData;\r\n\t\t\t\t\t\t\t\tlocalData.scnSet.np_scn2bt = oData.np_scn2bt != null ? oData.np_scn2bt.results : null;\r\n\t\t\t\t\t\t\t\tlocalData.scnSet.np_scn2it = oData.np_scn2it != null ? oData.np_scn2it.results : null;\r\n\t\t\t\t\t\t\t\tlocalData.scnSet.np_scn2uic = oData.np_scn2uic != null ? oData.np_scn2uic.results : oUICBackup;\r\n\t\t\t\t\t\t\t\tif (jQuery.isArray(localData.scnSet.np_scn2uic)) {\r\n\t\t\t\t\t\t\t\t\tlocalData.scnSet.np_scn2uic = formatter.convertUIC(localData.scnSet.np_scn2uic);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tthis._JSONModel.setProperty(\"/\", localData, false);\r\n\t\t\t\t\t\t\t\tmessages.convertMessage(this, \"/scnSet/np_scn2bt\");\r\n\t\t\t\t\t\t\t\tthis._Controller.setBusy(false);\r\n\t\t\t\t\t\t\t\tif (fnSuccess) {\r\n\t\t\t\t\t\t\t\t\tfnSuccess(this._Controller);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}.bind(this),\r\n\t\t\t\t\t\t\terror : function(oError) {\r\n\t\t\t\t\t\t\t\tthis._Controller.setBusy(false);\r\n\t\t\t\t\t\t\t\tthis._Controller.oError = oError;\r\n\t\t\t\t\t\t\t\tmessages.convertODataErrorMessage(this._Controller);\r\n\t\t\t\t\t\t\t\tthis._Controller.updateObligatory();\r\n\t\t\t\t\t\t\t\tif (fnError) {\r\n\t\t\t\t\t\t\t\t\tfnError(this._Controller);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}.bind(this)\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t\tthis._ODataModel.create(sUrl, oRequest, mParameters);\r\n\t\t\t\t\t},\r\n\r\n\t\t\t\t\t// 操作票查询报表数据交互处理函数\r\n\t\t\t\t\tpostOPQ : function(oView, fnSuccess, fnError) {\r\n\t\t\t\t\t\tthis._Controller = oView.getController();\r\n\t\t\t\t\t\tthis._ODataModel = this._Controller.getModel(\"OData\");\r\n\t\t\t\t\t\tthis._JSONModel = this._Controller.getModel();\r\n\t\t\t\t\t\tvar sFCode = this._JSONModel.getProperty(\"/appProperties/fcode\");// 公用属性fcode\r\n\r\n\t\t\t\t\t\tthis._Controller.setBusy(true);\r\n\t\t\t\t\t\t// 数据集\r\n\t\t\t\t\t\tvar oOPQ = this._JSONModel.getData().opqSet;\r\n\t\t\t\t\t\tvar oRequest = this._Controller.clone(oOPQ);\r\n\t\t\t\t\t\toRequest.Fcode = sFCode;\r\n\t\t\t\t\t\t// 相关行项目\r\n\t\t\t\t\t\toRequest.np_opq2bt = !oRequest.np_opq2bt ? [] : oRequest.np_opq2bt;\r\n\t\t\t\t\t\toRequest.np_opq2r = !oRequest.np_opq2r ? [] : oRequest.np_opq2r;\r\n\r\n\t\t\t\t\t\tvar sUrl = \"/opqSet\";\r\n\t\t\t\t\t\tvar mParameters = {\r\n\t\t\t\t\t\t\tsuccess : function(oData, response) {\r\n\t\t\t\t\t\t\t\tvar localData = this._JSONModel.getData();\r\n\t\t\t\t\t\t\t\tlocalData.opqSet = oData;\r\n\t\t\t\t\t\t\t\tlocalData.opqSet.np_opq2bt = oData.np_opq2bt != null ? oData.np_opq2bt.results : null;\r\n\t\t\t\t\t\t\t\tlocalData.opqSet.np_opq2r = oData.np_opq2r != null ? oData.np_opq2r.results : null;\r\n\r\n\t\t\t\t\t\t\t\tthis._JSONModel.setProperty(\"/\", localData, false);\r\n\t\t\t\t\t\t\t\tmessages.convertMessage(this, \"/opqSet/np_opq2bt\");\r\n\t\t\t\t\t\t\t\tthis._Controller.setBusy(false);\r\n\t\t\t\t\t\t\t\tif (fnSuccess) {\r\n\t\t\t\t\t\t\t\t\tfnSuccess(this._Controller);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}.bind(this),\r\n\t\t\t\t\t\t\terror : function(oError) {\r\n\t\t\t\t\t\t\t\tthis._Controller.setBusy(false);\r\n\t\t\t\t\t\t\t\tthis._Controller.oError = oError;\r\n\t\t\t\t\t\t\t\tmessages.convertODataErrorMessage(this._Controller);\r\n\t\t\t\t\t\t\t\tif (fnError) {\r\n\t\t\t\t\t\t\t\t\tfnError(this._Controller);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}.bind(this)\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t\tthis._ODataModel.create(sUrl, oRequest, mParameters);\r\n\t\t\t\t\t},\r\n\r\n\t\t\t\t\t// 操作票状态报告数据交互处理函数\r\n\t\t\t\t\tpostOPSR : function(oView, fnSuccess, fnError) {\r\n\t\t\t\t\t\tthis._Controller = oView.getController();\r\n\t\t\t\t\t\tthis._ODataModel = this._Controller.getModel(\"OData\");\r\n\t\t\t\t\t\tthis._JSONModel = this._Controller.getModel();\r\n\t\t\t\t\t\tvar sFCode = this._JSONModel.getProperty(\"/appProperties/fcode\");// 公用属性fcode\r\n\r\n\t\t\t\t\t\tthis._Controller.setBusy(true);\r\n\t\t\t\t\t\t// 数据集\r\n\t\t\t\t\t\tvar oOPSR = this._JSONModel.getData().opsrSet;\r\n\t\t\t\t\t\tvar oRequest = this._Controller.clone(oOPSR);\r\n\t\t\t\t\t\toRequest.Fcode = sFCode;\r\n\t\t\t\t\t\t// 相关行项目\r\n\t\t\t\t\t\toRequest.np_opsr2bt = !oRequest.np_opsr2bt ? [] : oRequest.np_opsr2bt;\r\n\t\t\t\t\t\toRequest.np_opsr2s = !oRequest.np_opsr2s ? [] : oRequest.np_opsr2s;\r\n\t\t\t\t\t\toRequest.np_opsr2l = !oRequest.np_opsr2l ? [] : oRequest.np_opsr2l;\r\n\r\n\t\t\t\t\t\tvar sUrl = \"/opsrSet\";\r\n\t\t\t\t\t\tvar mParameters = {\r\n\t\t\t\t\t\t\tsuccess : function(oData, response) {\r\n\t\t\t\t\t\t\t\tvar localData = this._JSONModel.getData();\r\n\t\t\t\t\t\t\t\tlocalData.opsrSet = oData;\r\n\t\t\t\t\t\t\t\tlocalData.opsrSet.np_opsr2bt = oData.np_opsr2bt != null ? oData.np_opsr2bt.results : null;\r\n\t\t\t\t\t\t\t\tlocalData.opsrSet.np_opsr2s = oData.np_opsr2s != null ? oData.np_opsr2s.results : null;\r\n\t\t\t\t\t\t\t\tlocalData.opsrSet.np_opsr2l = oData.np_opsr2l != null ? oData.np_opsr2l.results : null;\r\n\t\t\t\t\t\t\t\tthis._JSONModel.setProperty(\"/\", localData, false);\r\n\t\t\t\t\t\t\t\tmessages.convertMessage(this, \"/opsrSet/np_opsr2bt\");\r\n\t\t\t\t\t\t\t\tthis._Controller.setBusy(false);\r\n\t\t\t\t\t\t\t\tif (fnSuccess) {\r\n\t\t\t\t\t\t\t\t\tfnSuccess(this._Controller);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}.bind(this),\r\n\t\t\t\t\t\t\terror : function(oError) {\r\n\t\t\t\t\t\t\t\tthis._Controller.setBusy(false);\r\n\t\t\t\t\t\t\t\tthis._Controller.oError = oError;\r\n\t\t\t\t\t\t\t\tmessages.convertODataErrorMessage(this._Controller);\r\n\t\t\t\t\t\t\t\tif (fnError) {\r\n\t\t\t\t\t\t\t\t\tfnError(this._Controller);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}.bind(this)\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t\tthis._ODataModel.create(sUrl, oRequest, mParameters);\r\n\t\t\t\t\t},\r\n\r\n\t\t\t\t\t// 功能位置数据交互处理函数\r\n\t\t\t\t\tpostFL : function(oView, fnSuccess, fnError) {\r\n\t\t\t\t\t\tthis._Controller = oView.getController();\r\n\t\t\t\t\t\tthis._ODataModel = this._Controller.getModel(\"OData\");\r\n\t\t\t\t\t\tthis._JSONModel = this._Controller.getModel();\r\n\t\t\t\t\t\tvar sFCode = this._JSONModel.getProperty(\"/appProperties/fcode\");// 公用属性fcode\r\n\r\n\t\t\t\t\t\tthis._Controller.setBusy(true);\r\n\t\t\t\t\t\t// 功能位置数据集\r\n\t\t\t\t\t\tvar oFL = this._JSONModel.getData().flSet;\r\n\t\t\t\t\t\tvar oRequest = this._Controller.clone(oFL);\r\n\t\t\t\t\t\toRequest.Fcode = sFCode;\r\n\t\t\t\t\t\t// 相关行项目\r\n\t\t\t\t\t\toRequest.np_fl2bt = !oRequest.np_fl2bt ? [] : oRequest.np_fl2bt;\r\n\t\t\t\t\t\toRequest.np_fl2rf = !oRequest.np_fl2rf ? [] : oRequest.np_fl2rf;\r\n\t\t\t\t\t\toRequest.np_fl2pf = !oRequest.np_fl2pf ? [] : oRequest.np_fl2pf;\r\n\t\t\t\t\t\toRequest.np_fl2re = !oRequest.np_fl2re ? [] : oRequest.np_fl2re;\r\n\r\n\t\t\t\t\t\tvar sUrl = \"/flSet\";\r\n\t\t\t\t\t\tvar mParameters = {\r\n\t\t\t\t\t\t\tsuccess : function(oData, response) {\r\n\t\t\t\t\t\t\t\tvar localData = this._JSONModel.getData();\r\n\t\t\t\t\t\t\t\tlocalData.flSet = oData;\r\n\t\t\t\t\t\t\t\tlocalData.flSet.np_fl2bt = oData.np_fl2bt != null ? oData.np_fl2bt.results : null;\r\n\t\t\t\t\t\t\t\tlocalData.flSet.np_fl2rf = oData.np_fl2rf != null ? oData.np_fl2rf.results : null;\r\n\t\t\t\t\t\t\t\tlocalData.flSet.np_fl2pf = oData.np_fl2pf != null ? oData.np_fl2pf.results : null;\r\n\t\t\t\t\t\t\t\tlocalData.flSet.np_fl2re = oData.np_fl2re != null ? oData.np_fl2re.results : null;\r\n\t\t\t\t\t\t\t\tthis._JSONModel.setProperty(\"/\", localData, false);\r\n\t\t\t\t\t\t\t\tmessages.convertMessage(this, \"/flSet/np_fl2bt\");\r\n\t\t\t\t\t\t\t\tthis._Controller.setBusy(false);\r\n\t\t\t\t\t\t\t\tif (fnSuccess) {\r\n\t\t\t\t\t\t\t\t\tfnSuccess(this._Controller);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}.bind(this),\r\n\t\t\t\t\t\t\terror : function(oError) {\r\n\t\t\t\t\t\t\t\tthis._Controller.setBusy(false);\r\n\t\t\t\t\t\t\t\tthis._Controller.oError = oError;\r\n\t\t\t\t\t\t\t\tmessages.convertODataErrorMessage(this._Controller);\r\n\t\t\t\t\t\t\t\tif (fnError) {\r\n\t\t\t\t\t\t\t\t\tfnError(this._Controller);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}.bind(this)\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t\tthis._JSONModel.setProperty(\"/flSet/np_fl2re\",null,false);\r\n\t\t\t\t\t\tthis._ODataModel.create(sUrl, oRequest, mParameters);\r\n\t\t\t\t\t},\r\n\r\n\t\t\t\t\t// 备件需求提报报表数据交互处理函数\r\n\t\t\t\t\tpostSP : function(oView, fnSuccess, fnError) {\r\n\t\t\t\t\t\tthis._Controller = oView.getController();\r\n\t\t\t\t\t\tthis._ODataModel = this._Controller.getModel(\"OData\");\r\n\t\t\t\t\t\tthis._JSONModel = this._Controller.getModel();\r\n\t\t\t\t\t\tvar sFCode = this._JSONModel.getProperty(\"/appProperties/fcode\");// 公用属性fcode\r\n\r\n\t\t\t\t\t\tthis._Controller.setBusy(true);\r\n\t\t\t\t\t\t// 功能位置数据集\r\n\t\t\t\t\t\tvar oSP = this._JSONModel.getData().spSet;\r\n\t\t\t\t\t\tvar oRequest = this._Controller.clone(oSP);\r\n\t\t\t\t\t\toRequest.Fcode = sFCode;\r\n\t\t\t\t\t\t// 相关行项目\r\n\t\t\t\t\t\toRequest.np_sp2bt = !oRequest.np_sp2bt ? [] : oRequest.np_sp2bt;\r\n\t\t\t\t\t\toRequest.np_sp2i = !oRequest.np_sp2i ? [] : oRequest.np_sp2i;\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tvar sUrl = \"/spSet\";\r\n\t\t\t\t\t\tvar mParameters = {\r\n\t\t\t\t\t\t\tsuccess : function(oData, response) {\r\n\t\t\t\t\t\t\t\tvar localData = this._JSONModel.getData();\r\n\t\t\t\t\t\t\t\tlocalData.spSet = oData;\r\n\t\t\t\t\t\t\t\tlocalData.spSet.np_sp2bt = oData.np_sp2bt != null ? oData.np_sp2bt.results : null;\r\n\t\t\t\t\t\t\t\tlocalData.spSet.np_sp2i = oData.np_sp2i != null ? oData.np_sp2i.results : null;\r\n\t\t\t\t\t\t\t\tthis._JSONModel.setProperty(\"/\", localData, false);\r\n\t\t\t\t\t\t\t\tmessages.convertMessage(this, \"/spSet/np_sp2bt\");\r\n\t\t\t\t\t\t\t\tthis._Controller.setBusy(false);\r\n\t\t\t\t\t\t\t\tif (fnSuccess) {\r\n\t\t\t\t\t\t\t\t\tfnSuccess(this._Controller);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}.bind(this),\r\n\t\t\t\t\t\t\terror : function(oError) {\r\n\t\t\t\t\t\t\t\tthis._Controller.setBusy(false);\r\n\t\t\t\t\t\t\t\tthis._Controller.oError = oError;\r\n\t\t\t\t\t\t\t\tmessages.convertODataErrorMessage(this._Controller);\r\n\t\t\t\t\t\t\t\tif (fnError) {\r\n\t\t\t\t\t\t\t\t\tfnError(this._Controller);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}.bind(this)\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t\tthis._ODataModel.create(sUrl, oRequest, mParameters);\r\n\t\t\t\t\t},\r\n\r\n\t\t\t\t// 试运转单报表数据交互处理函数\r\n\t\t\t\t\tpostRR : function(oView, fnSuccess, fnError) {\r\n\t\t\t\t\t\tthis._Controller = oView.getController();\r\n\t\t\t\t\t\tthis._ODataModel = this._Controller.getModel(\"OData\");\r\n\t\t\t\t\t\tthis._JSONModel = this._Controller.getModel();\r\n\t\t\t\t\t\tvar sFCode = this._JSONModel.getProperty(\"/appProperties/fcode\");// 公用属性fcode\r\n\r\n\t\t\t\t\t\tthis._Controller.setBusy(true);\r\n\t\t\t\t\t\t// 功能位置数据集\r\n\t\t\t\t\t\tvar oRR = this._JSONModel.getData().rrSet;\r\n\t\t\t\t\t\tvar oRequest = this._Controller.clone(oRR);\r\n\t\t\t\t\t\toRequest.Fcode = sFCode;\r\n\t\t\t\t\t\t// 相关行项目\r\n\t\t\t\t\t\toRequest.np_rr2bt = !oRequest.np_rr2bt ? [] : oRequest.np_rr2bt;\r\n\t\t\t\t\t\toRequest.np_rr2rl = !oRequest.np_rr2rl ? [] : oRequest.np_rr2rl;\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tvar sUrl = \"/rrSet\";\r\n\t\t\t\t\t\tvar mParameters = {\r\n\t\t\t\t\t\t\tsuccess : function(oData, response) {\r\n\t\t\t\t\t\t\t\tvar localData = this._JSONModel.getData();\r\n\t\t\t\t\t\t\t\tlocalData.rrSet = oData;\r\n\t\t\t\t\t\t\t\tlocalData.rrSet.np_rr2bt = oData.np_rr2bt != null ? oData.np_rr2bt.results : null;\r\n\t\t\t\t\t\t\t\tlocalData.rrSet.np_rr2rl = oData.np_rr2rl != null ? oData.np_rr2rl.results : null;\r\n\t\t\t\t\t\t\t\tthis._JSONModel.setProperty(\"/\", localData, false);\r\n\t\t\t\t\t\t\t\tmessages.convertMessage(this, \"/rrSet/np_rr2bt\");\r\n\t\t\t\t\t\t\t\tthis._Controller.setBusy(false);\r\n\t\t\t\t\t\t\t\tif (fnSuccess) {\r\n\t\t\t\t\t\t\t\t\tfnSuccess(this._Controller);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}.bind(this),\r\n\t\t\t\t\t\t\terror : function(oError) {\r\n\t\t\t\t\t\t\t\tthis._Controller.setBusy(false);\r\n\t\t\t\t\t\t\t\tthis._Controller.oError = oError;\r\n\t\t\t\t\t\t\t\tmessages.convertODataErrorMessage(this._Controller);\r\n\t\t\t\t\t\t\t\tif (fnError) {\r\n\t\t\t\t\t\t\t\t\tfnError(this._Controller);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}.bind(this)\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t\tthis._ODataModel.create(sUrl, oRequest, mParameters);\r\n\t\t\t\t\t},\r\n\r\n\t\t\t\t\t\r\n\t\t\t\t\t// 获取Domain值搜索帮助\r\n\t\t\t\t\tgetDomainValueList : function(sDomainName, oContext, sLanguage) {\r\n\t\t\t\t\t\tvar aFilters = [];\r\n\t\t\t\t\t\taFilters.push(new Filter(\"Domname\", sap.ui.model.FilterOperator.EQ, sDomainName));\r\n\t\t\t\t\t\taFilters.push(new Filter(\"Ddlanguage\", sap.ui.model.FilterOperator.EQ, sLanguage));\r\n\t\t\t\t\t\tthis.callSearchHelp(\"ZSH_DOMAIN\", oContext, aFilters);\r\n\t\t\t\t\t},\r\n\r\n\t\t\t\t\t// 搜索帮助交互函数\r\n\t\t\t\t\tcallSearchHelp : function(sName, oController, aFilter, aSorter, fnSuccess, fnError) {\r\n\r\n\t\t\t\t\t\tthis._Controller = oController;\r\n\t\t\t\t\t\tthis._ODataModel = this._Controller.getModel(\"OData\");\r\n\t\t\t\t\t\tthis._JSONModel = this._Controller.getModel();\r\n\r\n\t\t\t\t\t\tthis._Controller.setBusy(true);\r\n\r\n\t\t\t\t\t\tsName = sName + \"Set\";\r\n\t\t\t\t\t\tvar sUrl = \"/\" + sName;\r\n\t\t\t\t\t\tvar iQueryMaxhints = this._JSONModel.getProperty(\"/appProperties/queryMaxhints\");\r\n\t\t\t\t\t\tif (iQueryMaxhints == \"\" || iQueryMaxhints == 0) {\r\n\t\t\t\t\t\t\tiQueryMaxhints = 9999;\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tif (sName == \"ZSH_DOMAINSet\") {\r\n\t\t\t\t\t\t\tif (!aFilter || !aFilter.length || aFilter.length == 0) {\r\n\t\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tfor (var i = 0; i < aFilter.length; i++) {\r\n\t\t\t\t\t\t\t\tif (aFilter[i].sPath == \"Domname\") {\r\n\t\t\t\t\t\t\t\t\tsName = aFilter[i].oValue1 + \"Set\";\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tvar mParameters = {\r\n\t\t\t\t\t\t\turlParameters : {\r\n\t\t\t\t\t\t\t\t$top : iQueryMaxhints,\r\n\t\t\t\t\t\t\t\t$skip : 0\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\tfilters : aFilter,\r\n\t\t\t\t\t\t\tsorters : aSorter,\r\n\t\t\t\t\t\t\tsuccess : function(oData, response) {\r\n\t\t\t\t\t\t\t\tvar localData = this._JSONModel.getData();\r\n\t\t\t\t\t\t\t\tlocalData[sName] = oData.results;\r\n\t\t\t\t\t\t\t\tthis._JSONModel.setProperty(\"/\", localData, false);\r\n\t\t\t\t\t\t\t\tthis._Controller.setBusy(false);\r\n\t\t\t\t\t\t\t\tif (fnSuccess) {\r\n\t\t\t\t\t\t\t\t\tfnSuccess(this._Controller);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}.bind(this),\r\n\t\t\t\t\t\t\terror : function(oError) {\r\n\t\t\t\t\t\t\t\tthis._Controller.setBusy(false);\r\n\t\t\t\t\t\t\t\tthis._Controller.oError = oError;\r\n\t\t\t\t\t\t\t\tif (fnError) {\r\n\t\t\t\t\t\t\t\t\tfnError(this._Controller);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}.bind(this)\r\n\t\t\t\t\t\t};\r\n\r\n\t\t\t\t\t\tthis._ODataModel.read(sUrl, mParameters);\r\n\r\n\t\t\t\t\t},\r\n\r\n\t\t\t\t\t// 综合报表查询数据交互处理函数\r\n\t\t\t\t\tpostQM : function(oView, fnSuccess, fnError) {\r\n\r\n\t\t\t\t\t\tthis._Controller = oView.getController();\r\n\t\t\t\t\t\tthis._ODataModel = this._Controller.getModel(\"OData\");\r\n\t\t\t\t\t\tthis._JSONModel = this._Controller.getModel();\r\n\t\t\t\t\t\tvar sFCode = this._JSONModel.getProperty(\"/appProperties/fcode\");\r\n\r\n\t\t\t\t\t\tthis._Controller.setBusy(true);\r\n\t\t\t\t\t\t// 综合报表数据集\r\n\t\t\t\t\t\tvar oQM = this._JSONModel.getData().qmSet;\r\n\t\t\t\t\t\tvar oRequest = this._Controller.clone(oQM);\r\n\t\t\t\t\t\toRequest.Fcode = sFCode;\r\n\t\t\t\t\t\t// UIC备份\r\n\t\t\t\t\t\tvar oUICBackup = oRequest.np_qm2uic;\r\n\t\t\t\t\t\t// 相关行项目\r\n\t\t\t\t\t\toRequest.np_qm2uic = [];\r\n\t\t\t\t\t\toRequest.np_qm2bt = !oRequest.np_qm2bt ? [] : oRequest.np_qm2bt;\r\n\t\t\t\t\t\toRequest.np_qm2df = !oRequest.np_qm2df ? [] : oRequest.np_qm2df;\r\n\t\t\t\t\t\toRequest.np_qm2dh = !oRequest.np_qm2dh ? [] : oRequest.np_qm2dh;\r\n\t\t\t\t\t\toRequest.np_qm2yd = !oRequest.np_qm2yd ? [] : oRequest.np_qm2yd;\r\n\t\t\t\t\t\toRequest.np_qm2tf = !oRequest.np_qm2tf ? [] : oRequest.np_qm2tf;\r\n\t\t\t\t\t\toRequest.np_qm2tn = !oRequest.np_qm2tn ? [] : oRequest.np_qm2tn;\r\n\r\n\t\t\t\t\t\tvar sUrl = \"/qmSet\";\r\n\t\t\t\t\t\tvar mParameters = {\r\n\t\t\t\t\t\t\tsuccess : function(oData, response) {\r\n\t\t\t\t\t\t\t\tvar localData = this._JSONModel.getData();\r\n\t\t\t\t\t\t\t\tlocalData.qmSet = oData;\r\n\t\t\t\t\t\t\t\tlocalData.qmSet.np_qm2df = oData.np_qm2df != null ? oData.np_qm2df.results : null;\r\n\t\t\t\t\t\t\t\tlocalData.qmSet.np_qm2dh = oData.np_qm2dh != null ? oData.np_qm2dh.results : null;\r\n\t\t\t\t\t\t\t\tlocalData.qmSet.np_qm2yd = oData.np_qm2yd != null ? oData.np_qm2yd.results : null;\r\n\t\t\t\t\t\t\t\tlocalData.qmSet.np_qm2tf = oData.np_qm2tf != null ? oData.np_qm2tf.results : null;\r\n\t\t\t\t\t\t\t\tlocalData.qmSet.np_qm2tn = oData.np_qm2tn != null ? oData.np_qm2tn.results : null;\r\n\t\t\t\t\t\t\t\tlocalData.qmSet.np_qm2bt = oData.np_qm2bt != null ? oData.np_qm2bt.results : null;\r\n\t\t\t\t\t\t\t\tlocalData.qmSet.np_qm2uic = oData.np_qm2uic != null ? oData.np_qm2uic.results : oUICBackup;\r\n\r\n\t\t\t\t\t\t\t\tif (jQuery.isArray(localData.qmSet.np_qm2uic)) {\r\n\t\t\t\t\t\t\t\t\tlocalData.qmSet.np_qm2uic = formatter.convertUIC(localData.qmSet.np_qm2uic);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tthis._JSONModel.setProperty(\"/\", localData, false);\r\n\t\t\t\t\t\t\t\tmessages.convertMessage(this, \"/qmSet/np_qm2bt\");\r\n\t\t\t\t\t\t\t\tthis._Controller.setBusy(false);\r\n\t\t\t\t\t\t\t\tif (fnSuccess) {\r\n\t\t\t\t\t\t\t\t\tfnSuccess(this._Controller);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}.bind(this),\r\n\t\t\t\t\t\t\terror : function(oError) {\r\n\t\t\t\t\t\t\t\tthis._Controller.setBusy(false);\r\n\t\t\t\t\t\t\t\tthis._Controller.oError = oError;\r\n\t\t\t\t\t\t\t\tmessages.convertODataErrorMessage(this._Controller);\r\n\t\t\t\t\t\t\t\tthis._Controller.updateObligatory();\r\n\t\t\t\t\t\t\t\tif (fnError) {\r\n\t\t\t\t\t\t\t\t\tfnError(this._Controller);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}.bind(this)\r\n\t\t\t\t\t\t};\r\n\r\n\t\t\t\t\t\tthis._ODataModel.create(sUrl, oRequest, mParameters);\r\n\r\n\t\t\t\t\t},\r\n\r\n\t\t\t\t\t// 异动通知单数据交互处理函数\r\n\t\t\t\t\tpostYD : function(oView, fnSuccess, fnError) {\r\n\r\n\t\t\t\t\t\tthis._Controller = oView.getController();\r\n\t\t\t\t\t\tthis._ODataModel = this._Controller.getModel(\"OData\");\r\n\t\t\t\t\t\tthis._JSONModel = this._Controller.getModel();\r\n\t\t\t\t\t\tvar sFCode = this._JSONModel.getProperty(\"/appProperties/fcode\");// 公用属性fcode\r\n\r\n\t\t\t\t\t\tthis._Controller.setBusy(true);\r\n\t\t\t\t\t\t// 异动数据集\r\n\t\t\t\t\t\tvar oYD = this._JSONModel.getData().ydSet;\r\n\t\t\t\t\t\tvar oRequest = this._Controller.clone(oYD);\r\n\t\t\t\t\t\toRequest.Fcode = sFCode;\r\n\t\t\t\t\t\t// UIC备份\r\n\t\t\t\t\t\tvar oUICBackup = oRequest.np_yd2uic;\r\n\t\t\t\t\t\t// 相关行项目\r\n\t\t\t\t\t\toRequest.np_yd2uic = [];\r\n\t\t\t\t\t\toRequest.np_yd2bt = !oRequest.np_yd2bt ? [] : oRequest.np_yd2bt;\r\n\t\t\t\t\t\toRequest.np_yd2s = !oRequest.np_yd2s ? [] : oRequest.np_yd2s;\r\n\t\t\t\t\t\toRequest.np_yd2a = !oRequest.np_yd2a ? [] : oRequest.np_yd2a;\r\n\t\t\t\t\t\toRequest.np_yd2t = !oRequest.np_yd2t ? [] : oRequest.np_yd2t;\r\n\r\n\t\t\t\t\t\tvar sUrl = \"/ydSet\";\r\n\t\t\t\t\t\tvar mParameters = {\r\n\t\t\t\t\t\t\tsuccess : function(oData, response) {\r\n\t\t\t\t\t\t\t\tvar localData = this._JSONModel.getData();\r\n\t\t\t\t\t\t\t\tlocalData.ydSet = oData;\r\n\t\t\t\t\t\t\t\tlocalData.ydSet.np_yd2bt = oData.np_yd2bt != null ? oData.np_yd2bt.results : null;\r\n\t\t\t\t\t\t\t\tlocalData.ydSet.np_yd2s = oData.np_yd2s != null ? oData.np_yd2s.results : null;\r\n\t\t\t\t\t\t\t\tlocalData.ydSet.np_yd2a = oData.np_yd2a != null ? oData.np_yd2a.results : null;\r\n\t\t\t\t\t\t\t\tlocalData.ydSet.np_yd2t = oData.np_yd2t != null ? oData.np_yd2t.results : null;\r\n\t\t\t\t\t\t\t\tlocalData.ydSet.np_yd2uic = oData.np_yd2uic != null ? oData.np_yd2uic.results : oUICBackup;\r\n\t\t\t\t\t\t\t\tif (jQuery.isArray(localData.ydSet.np_yd2uic)) {\r\n\t\t\t\t\t\t\t\t\tlocalData.ydSet.np_yd2uic = formatter.convertUIC(localData.ydSet.np_yd2uic);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tthis._JSONModel.setProperty(\"/\", localData, false);\r\n\t\t\t\t\t\t\t\tmessages.convertMessage(this, \"/ydSet/np_yd2bt\");\r\n\t\t\t\t\t\t\t\tthis._Controller.setBusy(false);\r\n\t\t\t\t\t\t\t\tif (fnSuccess) {\r\n\t\t\t\t\t\t\t\t\tfnSuccess(this._Controller);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}.bind(this),\r\n\t\t\t\t\t\t\terror : function(oError) {\r\n\t\t\t\t\t\t\t\tthis._Controller.setBusy(false);\r\n\t\t\t\t\t\t\t\tthis._Controller.oError = oError;\r\n\t\t\t\t\t\t\t\tmessages.convertODataErrorMessage(this._Controller);\r\n\t\t\t\t\t\t\t\tthis._Controller.updateObligatory();\r\n\t\t\t\t\t\t\t\tif (fnError) {\r\n\t\t\t\t\t\t\t\t\tfnError(this._Controller);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}.bind(this)\r\n\t\t\t\t\t\t};\r\n\r\n\t\t\t\t\t\tthis._ODataModel.create(sUrl, oRequest, mParameters);\r\n\r\n\t\t\t\t\t},\r\n\r\n\t\t\t\t\t// 值班管理数据交互处理函数\r\n\t\t\t\t\tpostDT : function(oView, fnSuccess, fnError) {\r\n\r\n\t\t\t\t\t\tthis._Controller = oView.getController();\r\n\t\t\t\t\t\tthis._ODataModel = this._Controller.getModel(\"OData\");\r\n\t\t\t\t\t\tthis._JSONModel = this._Controller.getModel();\r\n\t\t\t\t\t\tvar sFCode = this._JSONModel.getProperty(\"/appProperties/fcode\");// 公用属性fcode\r\n\r\n\t\t\t\t\t\tthis._Controller.setBusy(true);\r\n\t\t\t\t\t\t// 值班管理数据集\r\n\t\t\t\t\t\tvar oDT = this._JSONModel.getData().dtSet;\r\n\t\t\t\t\t\tvar oRequest = this._Controller.clone(oDT);\r\n\t\t\t\t\t\toRequest.Fcode = sFCode;\r\n\t\t\t\t\t\t// 相关行项目\r\n\t\t\t\t\t\toRequest.np_dt2di = !oRequest.np_dt2di ? [] : oRequest.np_dt2di;\r\n\t\t\t\t\t\toRequest.np_dt2bt = !oRequest.np_dt2bt ? [] : oRequest.np_dt2bt;\r\n\r\n\t\t\t\t\t\tvar sUrl = \"/dtSet\";\r\n\t\t\t\t\t\tvar mParameters = {\r\n\t\t\t\t\t\t\tsuccess : function(oData, response) {\r\n\t\t\t\t\t\t\t\tvar localData = this._JSONModel.getData();\r\n\t\t\t\t\t\t\t\tlocalData.dtSet = oData;\r\n\t\t\t\t\t\t\t\tlocalData.dtSet.np_dt2bt = oData.np_dt2bt != null ? oData.np_dt2bt.results : null;\r\n\t\t\t\t\t\t\t\tlocalData.dtSet.np_dt2di = oData.np_dt2di != null ? oData.np_dt2di.results : null;\r\n\t\t\t\t\t\t\t\tthis._JSONModel.setProperty(\"/\", localData, false);\r\n\t\t\t\t\t\t\t\tmessages.convertMessage(this, \"/dtSet/np_dt2bt\");\r\n\t\t\t\t\t\t\t\tthis._Controller.setBusy(false);\r\n\t\t\t\t\t\t\t\tif (fnSuccess) {\r\n\t\t\t\t\t\t\t\t\tfnSuccess(this._Controller);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}.bind(this),\r\n\t\t\t\t\t\t\terror : function(oError) {\r\n\t\t\t\t\t\t\t\tthis._Controller.setBusy(false);\r\n\t\t\t\t\t\t\t\tthis._Controller.oError = oError;\r\n\t\t\t\t\t\t\t\tmessages.convertODataErrorMessage(this._Controller);\r\n\t\t\t\t\t\t\t\tthis._Controller.updateObligatory();\r\n\t\t\t\t\t\t\t\tif (fnError) {\r\n\t\t\t\t\t\t\t\t\tfnError(this._Controller);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}.bind(this)\r\n\t\t\t\t\t\t};\r\n\r\n\t\t\t\t\t\tthis._ODataModel.create(sUrl, oRequest, mParameters);\r\n\r\n\t\t\t\t\t},\r\n\r\n\t\t\t\t\t// 附件上传数据交互处理函数\r\n\t\t\t\t\tpostAttachment : function(oView, fnSuccess, fnError) {\r\n\t\t\t\t\t\tthis._Controller = oView.getController();\r\n\t\t\t\t\t\tthis._JSONModel = this._Controller.getModel();\r\n\t\t\t\t\t\tthis._ResourceBundle = this._Controller.getModel(\"i18n\").getResourceBundle();\r\n\r\n\t\t\t\t\t\t// this.setBusy(true);\r\n\r\n\t\t\t\t\t\tif (this.atODataModel == undefined) {\r\n\t\t\t\t\t\t\tthis.atODataModel = models.createODataModel({\r\n\t\t\t\t\t\t\t\turlParametersForEveryRequest : [\r\n\t\t\t\t\t\t\t\t\t\t\"sap-server\",\r\n\t\t\t\t\t\t\t\t\t\t\"sap-client\",\r\n\t\t\t\t\t\t\t\t\t\t\"sap-language\"\r\n\t\t\t\t\t\t\t\t],\r\n\t\t\t\t\t\t\t\turl : \"/sap/opu/odata/sap/ZXXFILE01_SRV/\",\r\n\t\t\t\t\t\t\t\tconfig : {\r\n\t\t\t\t\t\t\t\t\t// metadataUrlParams: {\r\n\t\t\t\t\t\t\t\t\t// \"sap-documentation\": \"heading\"\r\n\t\t\t\t\t\t\t\t\t// },\r\n\t\t\t\t\t\t\t\t\t// defaultBindingMode: \"OneWay\",\r\n\t\t\t\t\t\t\t\t\tuseBatch : false,\r\n\t\t\t\t\t\t\t\t\tdefaultCountMode : \"None\",\r\n\t\t\t\t\t\t\t\t\t// loadMetadataAsync: true,\r\n\t\t\t\t\t\t\t\t\tjson : true\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tvar oRequest = this._JSONModel.getData().filelistSet;\r\n\r\n\t\t\t\t\t\tfor ( var o in oRequest) {\r\n\t\t\t\t\t\t\tif (oRequest[o] == null) {\r\n\t\t\t\t\t\t\t\toRequest[o] = [];\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tif (oRequest.np_filelist2h.length == 0) {\r\n\t\t\t\t\t\t\tvar np_attah = {\r\n\t\t\t\t\t\t\t\tDocid : \"\",\r\n\t\t\t\t\t\t\t\tFilename : \"\",\r\n\t\t\t\t\t\t\t\tMimetype : \"\",\r\n\t\t\t\t\t\t\t\tUrl : \"\",\r\n\t\t\t\t\t\t\t\tnp_attah2a : []\r\n\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\t\toRequest.np_filelist2h.push(np_attah);\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tthis._Controller.setBusy(true);\r\n\r\n\t\t\t\t\t\tvar sUrl = \"/filelistSet\";\r\n\t\t\t\t\t\tvar mParameters = {\r\n\t\t\t\t\t\t\tsuccess : function(oData, response) {\r\n\t\t\t\t\t\t\t\tthis._Controller.setBusy(false);\r\n\t\t\t\t\t\t\t\tvar localData = this._JSONModel.getData();\r\n\t\t\t\t\t\t\t\tlocalData.filelistSet = oData;\r\n\t\t\t\t\t\t\t\tlocalData.filelistSet.np_filelist2bt = oData.np_filelist2bt != null ? oData.np_filelist2bt.results : null;\r\n\t\t\t\t\t\t\t\tlocalData.filelistSet.np_filelist2h = oData.np_filelist2h != null ? oData.np_filelist2h.results : null;\r\n\t\t\t\t\t\t\t\tif (localData.filelistSet.np_filelist2h != null) {\r\n\t\t\t\t\t\t\t\t\tfor (var i = 0; i < localData.filelistSet.np_filelist2h.length; i++) {\r\n\t\t\t\t\t\t\t\t\t\tlocalData.filelistSet.np_filelist2h[i].np_attah2a = localData.filelistSet.np_filelist2h[i].np_attah2a != null ? localData.filelistSet.np_filelist2h[i].np_attah2a.results : null;\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tthis._JSONModel.setProperty(\"/\", localData, false);\r\n\r\n\t\t\t\t\t\t\t\tif (oRequest.Fcode == \"DELETE\") {\r\n\t\t\t\t\t\t\t\t\tmessages.showText(this._ResourceBundle.getText(\"fileDel.Ok\"));\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}.bind(this),\r\n\t\t\t\t\t\t\terror : function(oError) {\r\n\t\t\t\t\t\t\t\tthis._Controller.setBusy(false);\r\n\t\t\t\t\t\t\t\tif (oRequest.Fcode == \"DELETE\") {\r\n\t\t\t\t\t\t\t\t\tmessages.showText(this._ResourceBundle.getText(\"fileDel.Error\"));\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tthis._JSONModel.setProperty(\"/filelistSet/Fcode\", \"SELECT\");\r\n\t\t\t\t\t\t\t\tthis.postAttachment(oView);\r\n\r\n\t\t\t\t\t\t\t}.bind(this)\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t\tthis.atODataModel.create(sUrl, oRequest, mParameters);\r\n\t\t\t\t\t},\r\n\t\t\t\t};\r\n\t\t\t});",
		"ZAPI_VIEW/view/main.view.xml": "<!-- helloWorld 显示视图：\r\n     1.xmlns 声明 xml 命名空间，sap.ui.layout、sap.ui.cor.mvc、sap.ui.core、sap.m,\r\n            说明xmlns:l 其中 l 为别名，后续使用中会使用前缀(别名)加标签方式指定标签来源；\r\n     2.controllerName 指定控制器文件，ZTR18_3135_1010.controller.helloWorld;\r\n     3.Panel 面板标签使用；\r\n     4.content 标签使用；\r\n     5.Button 标签使用；\r\n-->\r\n<mvc:View controllerName=\"ZAPI_VIEW.controller.main\" xmlns:mvc=\"sap.ui.core.mvc\" xmlns=\"sap.m\" xmlns:layout=\"sap.ui.layout\"\r\n\txmlns:microchart=\"sap.suite.ui.microchart\">\r\n\t<Page title=\"\">\r\n\t\t<!--\t<layout:VerticalLayout class=\"sapUiResponsiveMargin\">\r\n\t\t\t<layout:HorizontalLayout allowWrapping=\"true\">\r\n\t\t\t\t<GenericTile class=\"sapUiTinyMarginBegin sapUiTinyMarginTop\" header=\"图片识别\" subheader=\"\" press=\"onPress1\"></GenericTile>\r\n\t\t\t</layout:HorizontalLayout>\r\n\t\t</layout:VerticalLayout>-->\r\n\t\t<layout:VerticalLayout class=\"sapUiResponsiveMargin\">\r\n\t\t\t<layout:HorizontalLayout allowWrapping=\"true\">\r\n\t\t\t\t<GenericTile class=\"sapUiTinyMarginBegin sapUiTinyMarginTop\" header=\"标签扫描\" subheader=\"\" press=\"onPress2\"></GenericTile>\r\n\t\t\t</layout:HorizontalLayout>\r\n\t\t</layout:VerticalLayout>\r\n\t\t<layout:VerticalLayout class=\"sapUiResponsiveMargin\">\r\n\t\t\t<layout:HorizontalLayout allowWrapping=\"true\">\r\n\t\t\t\t<GenericTile class=\"sapUiTinyMarginBegin sapUiTinyMarginTop\" header=\"发票扫描\" subheader=\"\" press=\"onPress3\"></GenericTile>\r\n\t\t\t</layout:HorizontalLayout>\r\n\t\t</layout:VerticalLayout>\r\n\t\t<!--\t<layout:VerticalLayout class=\"sapUiResponsiveMargin\">\r\n\t\t\t<layout:HorizontalLayout allowWrapping=\"true\">\r\n\t\t\t\t<GenericTile class=\"sapUiTinyMarginBegin sapUiTinyMarginTop\" header=\"录入图片\" subheader=\"先录入,后扫描 \" press=\"onPress4\"></GenericTile>\r\n\t\t\t</layout:HorizontalLayout>\r\n\t\t</layout:VerticalLayout>\r\n\t\t<layout:VerticalLayout class=\"sapUiResponsiveMargin\">\r\n\t\t\t<layout:HorizontalLayout allowWrapping=\"true\">\r\n\t\t\t\t<GenericTile class=\"sapUiTinyMarginBegin sapUiTinyMarginTop\" header=\"人脸识别\" subheader=\"先录入,后扫描 \" press=\"onPress5\"></GenericTile>\r\n\t\t\t</layout:HorizontalLayout>\r\n\t\t</layout:VerticalLayout>\r\n\t\t<layout:VerticalLayout class=\"sapUiResponsiveMargin\">\r\n\t\t\t<layout:HorizontalLayout allowWrapping=\"true\">\r\n\t\t\t\t<GenericTile class=\"sapUiTinyMarginBegin sapUiTinyMarginTop\" header=\"拍照 \" subheader=\" \" press=\"onPress6\"></GenericTile>\r\n\t\t\t</layout:HorizontalLayout>\r\n\t\t</layout:VerticalLayout>\r\n\t\t\t<layout:VerticalLayout class=\"sapUiResponsiveMargin\">\r\n\t\t\t<layout:HorizontalLayout allowWrapping=\"true\">\r\n\t\t\t\t<GenericTile class=\"sapUiTinyMarginBegin sapUiTinyMarginTop\" header=\"语音识别  \" subheader=\" \" press=\"onPress7\"></GenericTile>\r\n\t\t\t</layout:HorizontalLayout>\r\n\t\t</layout:VerticalLayout>-->\r\n\t\t<layout:VerticalLayout class=\"sapUiResponsiveMargin\">\r\n\t\t\t<layout:HorizontalLayout allowWrapping=\"true\">\r\n\t\t\t\t<GenericTile class=\"sapUiTinyMarginBegin sapUiTinyMarginTop\" header=\"拍照 \" subheader=\" \" press=\"onPress6\"></GenericTile>\r\n\t\t\t</layout:HorizontalLayout>\r\n\t\t</layout:VerticalLayout>\r\n\t</Page>\r\n</mvc:View>",
		"ZAPI_VIEW/thirdparty/openui5/camera/library.js": "/*!\r\n * ${copyright}\r\n */\r\n\r\n/**\r\n * Initialization Code and shared classes of library it.designfuture.qrcode.\r\n */\r\nsap.ui.define([\r\n\t'jquery.sap.global',\r\n\t'sap/ui/core/library' // library dependency\r\n],  function(jQuery, library) {\r\n\r\n\t\"use strict\";\r\n\r\n\t/**\r\n\t * Suite controls library.\r\n\t *\r\n\t * @namespace\r\n\t * @name openui5.camera\r\n\t * @author Tiago Almeida <jumpifzero@gmail.com>\r\n\t * @version ${version}\r\n\t * @public\r\n\t */\r\n\r\n\t// delegate further initialization of this library to the Core\r\n\tsap.ui.getCore().initLibrary({\r\n\t\tname : \"openui5.camera\",\r\n\t\tnoLibraryCSS: true,\r\n\t\tversion: \"${version}\",\r\n\t\tdependencies : [\"sap.ui.core\", \"sap.m\"],\r\n\t\ttypes: [],\r\n\t\tinterfaces: [],\r\n\t\tcontrols: [\r\n\t\t\t\"openui5.camera.Camera\"\r\n\t\t],\r\n\t\telements: []\r\n\t});\r\n\r\n\treturn openui5.camera;\r\n\r\n}, /* bExport= */ false);",
		"ZAPI_VIEW/thirdparty/openui5/camera/CameraRenderer.js": "sap.ui.define([],\r\n\t          function() {\r\n\t              \"use strict\";\r\n\r\n\t              /**\r\n\t               * @namespace openui5.camera\r\n\t               */\r\n\t              var CameraRenderer = {};\r\n\r\n\t              /**\r\n\t               * Renders the HTML for the control, using the provided {@link sap.ui.core.RenderManager}.\r\n\t               *\r\n\t               * @param {sap.ui.core.RenderManager} oRm RenderManager object\r\n\t               * @param {sap.ui.core.Control} oControl An object representation of the control that will be rendered\r\n\t               */\r\n\t              CameraRenderer.render = function(oRm, oControl) {\r\n\t\t              oRm.write(\"<div\");\r\n\t\t              oRm.writeControlData(oControl);\r\n\t\t              oRm.writeClasses();\r\n\t\t              oRm.writeStyles();\r\n\t\t              oRm.write(\">\");\r\n                      oRm.write(\"<div style='display: flex; flex-direction: row; align-items: center; justify-content: space-around;'>\");\r\n                      oRm.write(\r\n                          \"<video width='%w' height='%h' style='width: %pwpx; height: %phpx;'></video>\"\r\n                              .replace(\"%w\", oControl.getVideoWidth())\r\n                              .replace(\"%h\", oControl.getVideoHeight())\r\n                              .replace(\"%pw\", oControl.getWidth())\r\n                              .replace(\"%ph\", oControl.getHeight())\r\n                      );\r\n                      oRm.write(\r\n                          \"<canvas width='%w' height='%h' style='display: none; width: %pwpx; height: %phpx;'></canvas>\"\r\n                              .replace(\"%w\", oControl.getVideoWidth())\r\n                              .replace(\"%h\", oControl.getVideoHeight())\r\n                              .replace(\"%pw\", oControl.getWidth())\r\n                              .replace(\"%ph\", oControl.getHeight()));\r\n\t\t              oRm.write(\"</div>\");\r\n\t\t              oRm.write(\"</div>\");\r\n\t              };\r\n\r\n\t              return CameraRenderer;\r\n\r\n              }, /* bExport= */ true);",
		"ZAPI_VIEW/model/models.js": "/* =========================================================== */\r\n/* App MVC中 model 实现（App 模型）                            */\r\n/* =========================================================== */\r\nsap.ui.define([\"sap/ui/model/json/JSONModel\",\r\n\t\"sap/ui/Device\",\r\n\t\"sap/ui/model/odata/v2/ODataModel\",\r\n\t\"sap/ui/model/resource/ResourceModel\"\r\n], function(JSONModel, Device, ODataModel, ResourceModel) {\r\n\t\"use strict\";\r\n\r\n\tfunction extendMetadataUrlParameters(aUrlParametersToAdd, oMetadataUrlParams, sServiceUrl) {\r\n\t\tvar oExtensionObject = {},\r\n\t\t\toServiceUri = new URI(sServiceUrl);\r\n\r\n\t\taUrlParametersToAdd.forEach(function(sUrlParam) {\r\n\t\t\tvar sLanguage, oUrlParameters, sParameterValue;\r\n\r\n\t\t\t// for sap-language we check if the launchpad can provide it.\r\n\t\t\tif (sUrlParam === \"sap-language\") {\r\n\r\n\t\t\t\tvar fnGetuser = jQuery.sap.getObject(\"sap.ushell.Container.getUser\");\r\n\t\t\t\tif (fnGetuser) {\r\n\t\t\t\t\t// for sap-language we check if the launchpad can provide it.\r\n\t\t\t\t\tsLanguage = fnGetuser().getLanguage();\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (sLanguage) {\r\n\t\t\t\t\toMetadataUrlParams[\"sap-language\"] = sLanguage;\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\t// Continue searching in the url\r\n\t\t\t}\r\n\r\n\t\t\toUrlParameters = jQuery.sap.getUriParameters();\r\n\t\t\tsParameterValue = oUrlParameters.get(sUrlParam);\r\n\t\t\tif (sParameterValue) {\r\n\t\t\t\toMetadataUrlParams[sUrlParam] = sParameterValue;\r\n\t\t\t\toServiceUri.addSearch(sUrlParam, sParameterValue);\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tjQuery.extend(oMetadataUrlParams, oExtensionObject);\r\n\t\treturn oServiceUri.toString();\r\n\t}\r\n\r\n\treturn {\r\n\r\n\t\t// 创建OData模型\r\n\t\tcreateODataModel: function(oOptions) {\r\n\t\t\tvar aUrlParametersForEveryRequest, oConfig, sUrl;\r\n\r\n\t\t\toOptions = oOptions || {};\r\n\r\n\t\t\tif (!oOptions.url) {\r\n\t\t\t\tjQuery.sap.log.error(\"Please provide a url when you want to create an ODataModel\",\r\n\t\t\t\t\t\"ZHAND_201803_TR_1001.model.models.createODataModel\");\r\n\t\t\t\treturn null;\r\n\t\t\t}\r\n\r\n\t\t\t// create a copied instance since we modify the\r\n\t\t\t// config\r\n\t\t\toConfig = jQuery.extend(true, {}, oOptions.config);\r\n\r\n\t\t\taUrlParametersForEveryRequest = oOptions.urlParametersForEveryRequest || [];\r\n\t\t\toConfig.metadataUrlParams = oConfig.metadataUrlParams || {};\r\n\r\n\t\t\tsUrl = extendMetadataUrlParameters(aUrlParametersForEveryRequest, oConfig.metadataUrlParams, oOptions.url);\r\n\r\n\t\t\treturn this._createODataModel(sUrl, oConfig);\r\n\r\n\t\t},\r\n\r\n\t\t// 创建OData模型\r\n\t\t_createODataModel: function(sUrl, oConfig) {\r\n\t\t\treturn new ODataModel(sUrl, oConfig);\r\n\t\t},\r\n\r\n\t\t// 初始化本地数据集\r\n\t\t_initialLocalData: function() {\r\n\r\n\t\t\tvar localData = {\r\n\r\n\t\t\t\trecognitionSet: {\r\n\t\t\t\t\tnp_recognitionimage: [{\r\n\t\t\t\t\t\t\"Image\": \"\"\r\n\t\t\t\t\t}],\r\n\t\t\t\t\tnp_recognitionitem: []\r\n\t\t\t\t},\r\n\r\n\t\t\t\tinvoiceSet: {\r\n\t\t\t\t\tnp_invoiceimage: [{\r\n\t\t\t\t\t\t\"Image\": \"\"\r\n\t\t\t\t\t}],\r\n\t\t\t\t\tnp_invoiceinvoice_item: []\r\n\t\t\t\t},\r\n\r\n\t\t\t\tinvoice_miro_postSet: {\r\n\t\t\t\t\tnp_message: []\r\n\t\t\t\t},\r\n\r\n\t\t\t\tvat_faceSet: {\r\n\t\t\t\t\tnp_vat_faceimage: [{\r\n\t\t\t\t\t\t\"Image\": \"\"\r\n\t\t\t\t\t}]\r\n\t\t\t\t},\r\n\r\n\t\t\t\tface_uploadSet: {\r\n\t\t\t\t\tnp_face_uploadimage: [{\r\n\t\t\t\t\t\t\"Image\": \"\"\r\n\t\t\t\t\t}]\r\n\t\t\t\t}\r\n\t\t\t};\r\n\r\n\t\t\tvar uR = $.ajax({\r\n\t\t\t\turl: \"/sap/bc/ui2/start_up\",\r\n\t\t\t\tasync: false\r\n\t\t\t});\r\n\r\n\t\t\tif (uR.status === 200) {\r\n\t\t\t\tlocalData.userSet = uR.responseJSON;\r\n\t\t\t}\r\n\r\n\t\t\treturn localData;\r\n\t\t},\r\n\r\n\t\t// 创建设备模型\r\n\t\tcreateDeviceModel: function() {\r\n\t\t\tvar oModel = new JSONModel(Device);\r\n\t\t\toModel.setDefaultBindingMode(\"OneWay\");\r\n\t\t\treturn oModel;\r\n\t\t},\r\n\r\n\t\t// 创建图片 \r\n\t\tcreateImage: function() {\r\n\t\t\tvar oRootPath = jQuery.sap.getModulePath(\"ZAPI_VIEW/images\"); // your resource root\r\n\t\t\tvar imageModel = new JSONModel({\r\n\t\t\t\tpath: oRootPath\r\n\t\t\t});\r\n\t\t\treturn imageModel;\r\n\t\t},\r\n\t\t// 创建FLP模型\r\n\t\tcreateFLPModel: function() {\r\n\t\t\tvar fnGetuser = jQuery.sap.getObject(\"sap.ushell.Container.getUser\");\r\n\t\t\tvar bIsShareInJamActive = fnGetuser ? fnGetuser().isJamActive() : false;\r\n\t\t\tvar oModel = new JSONModel({\r\n\t\t\t\tisShareInJamActive: bIsShareInJamActive\r\n\t\t\t});\r\n\t\t\toModel.setDefaultBindingMode(\"OneWay\");\r\n\t\t\treturn oModel;\r\n\t\t},\r\n\r\n\t\t// 创建本地模型\r\n\t\tcreateLocalModel: function() {\r\n\t\t\tvar oModel = new JSONModel(this._initialLocalData());\r\n\t\t\t//oModel.setSizeLimit(9999);\r\n\t\t\treturn oModel;\r\n\t\t},\r\n\r\n\t\t// \t创建资源模型\r\n\t\tcreateResourceModel: function(sRootPath, resourceBundle) {\r\n\t\t\tthis._resourceModel = new ResourceModel({\r\n\t\t\t\tbundleUrl: [\r\n\t\t\t\t\tsRootPath,\r\n\t\t\t\t\tresourceBundle\r\n\t\t\t\t].join(\"/\")\r\n\t\t\t});\r\n\t\t\treturn this._resourceModel;\r\n\t\t}\r\n\t};\r\n\r\n});",
		"ZAPI_VIEW/thirdparty/openui5/camera/soundmanager2.js": "/** @license\r\n *\r\n * SoundManager 2: JavaScript Sound for the Web\r\n * ----------------------------------------------\r\n * http://schillmania.com/projects/soundmanager2/\r\n *\r\n * Copyright (c) 2007, Scott Schiller. All rights reserved.\r\n * Code provided under the BSD License:\r\n * http://schillmania.com/projects/soundmanager2/license.txt\r\n *\r\n * V2.97a.20170601\r\n */\r\n\r\n/**\r\n * About this file\r\n * -------------------------------------------------------------------------------------\r\n * This is the fully-commented source version of the SoundManager 2 API,\r\n * recommended for use during development and testing.\r\n *\r\n * See soundmanager2-nodebug-jsmin.js for an optimized build (~11KB with gzip.)\r\n * http://schillmania.com/projects/soundmanager2/doc/getstarted/#basic-inclusion\r\n * Alternately, serve this file with gzip for 75% compression savings (~30KB over HTTP.)\r\n *\r\n * You may notice <d> and </d> comments in this source; these are delimiters for\r\n * debug blocks which are removed in the -nodebug builds, further optimizing code size.\r\n *\r\n * Also, as you may note: Whoa, reliable cross-platform/device audio support is hard! ;)\r\n */\r\n\r\n(function SM2(window, _undefined) {\r\n\r\n/* global Audio, document, window, navigator, define, module, SM2_DEFER, opera, setTimeout, setInterval, clearTimeout, sm2Debugger */\r\n\r\n'use strict';\r\n\r\nif (!window || !window.document) {\r\n\r\n  // Don't cross the [environment] streams. SM2 expects to be running in a browser, not under node.js etc.\r\n  // Additionally, if a browser somehow manages to fail this test, as Egon said: \"It would be bad.\"\r\n\r\n  throw new Error('SoundManager requires a browser with window and document objects.');\r\n\r\n}\r\n\r\nvar soundManager = null;\r\n\r\n/**\r\n * The SoundManager constructor.\r\n *\r\n * @constructor\r\n * @param {string} smURL Optional: Path to SWF files\r\n * @param {string} smID Optional: The ID to use for the SWF container element\r\n * @this {SoundManager}\r\n * @return {SoundManager} The new SoundManager instance\r\n */\r\n\r\nfunction SoundManager(smURL, smID) {\r\n\r\n  /**\r\n   * soundManager configuration options list\r\n   * defines top-level configuration properties to be applied to the soundManager instance (eg. soundManager.flashVersion)\r\n   * to set these properties, use the setup() method - eg., soundManager.setup({url: '/swf/', flashVersion: 9})\r\n   */\r\n\r\n  this.setupOptions = {\r\n\r\n    url: (smURL || null),             // path (directory) where SoundManager 2 SWFs exist, eg., /path/to/swfs/\r\n    flashVersion: 8,                  // flash build to use (8 or 9.) Some API features require 9.\r\n    debugMode: true,                  // enable debugging output (console.log() with HTML fallback)\r\n    debugFlash: false,                // enable debugging output inside SWF, troubleshoot Flash/browser issues\r\n    useConsole: true,                 // use console.log() if available (otherwise, writes to #soundmanager-debug element)\r\n    consoleOnly: true,                // if console is being used, do not create/write to #soundmanager-debug\r\n    waitForWindowLoad: false,         // force SM2 to wait for window.onload() before trying to call soundManager.onload()\r\n    bgColor: '#ffffff',               // SWF background color. N/A when wmode = 'transparent'\r\n    useHighPerformance: false,        // position:fixed flash movie can help increase js/flash speed, minimize lag\r\n    flashPollingInterval: null,       // msec affecting whileplaying/loading callback frequency. If null, default of 50 msec is used.\r\n    html5PollingInterval: null,       // msec affecting whileplaying() for HTML5 audio, excluding mobile devices. If null, native HTML5 update events are used.\r\n    flashLoadTimeout: 1000,           // msec to wait for flash movie to load before failing (0 = infinity)\r\n    wmode: null,                      // flash rendering mode - null, 'transparent', or 'opaque' (last two allow z-index to work)\r\n    allowScriptAccess: 'always',      // for scripting the SWF (object/embed property), 'always' or 'sameDomain'\r\n    useFlashBlock: false,             // *requires flashblock.css, see demos* - allow recovery from flash blockers. Wait indefinitely and apply timeout CSS to SWF, if applicable.\r\n    useHTML5Audio: true,              // use HTML5 Audio() where API is supported (most Safari, Chrome versions), Firefox (MP3/MP4 support varies.) Ideally, transparent vs. Flash API where possible.\r\n    forceUseGlobalHTML5Audio: false,  // if true, a single Audio() object is used for all sounds - and only one can play at a time.\r\n    ignoreMobileRestrictions: false,  // if true, SM2 will not apply global HTML5 audio rules to mobile UAs. iOS > 7 and WebViews may allow multiple Audio() instances.\r\n    html5Test: /^(probably|maybe)$/i, // HTML5 Audio() format support test. Use /^probably$/i; if you want to be more conservative.\r\n    preferFlash: false,               // overrides useHTML5audio, will use Flash for MP3/MP4/AAC if present. Potential option if HTML5 playback with these formats is quirky.\r\n    noSWFCache: false,                // if true, appends ?ts={date} to break aggressive SWF caching.\r\n    idPrefix: 'sound'                 // if an id is not provided to createSound(), this prefix is used for generated IDs - 'sound0', 'sound1' etc.\r\n\r\n  };\r\n\r\n  this.defaultOptions = {\r\n\r\n    /**\r\n     * the default configuration for sound objects made with createSound() and related methods\r\n     * eg., volume, auto-load behaviour and so forth\r\n     */\r\n\r\n    autoLoad: false,        // enable automatic loading (otherwise .load() will be called on demand with .play(), the latter being nicer on bandwidth - if you want to .load yourself, you also can)\r\n    autoPlay: false,        // enable playing of file as soon as possible (much faster if \"stream\" is true)\r\n    from: null,             // position to start playback within a sound (msec), default = beginning\r\n    loops: 1,               // how many times to repeat the sound (position will wrap around to 0, setPosition() will break out of loop when >0)\r\n    onid3: null,            // callback function for \"ID3 data is added/available\"\r\n    onerror: null,          // callback function for \"load failed\" (or, playback/network/decode error under HTML5.)\r\n    onload: null,           // callback function for \"load finished\"\r\n    whileloading: null,     // callback function for \"download progress update\" (X of Y bytes received)\r\n    onplay: null,           // callback for \"play\" start\r\n    onpause: null,          // callback for \"pause\"\r\n    onresume: null,         // callback for \"resume\" (pause toggle)\r\n    whileplaying: null,     // callback during play (position update)\r\n    onposition: null,       // object containing times and function callbacks for positions of interest\r\n    onstop: null,           // callback for \"user stop\"\r\n    onfinish: null,         // callback function for \"sound finished playing\"\r\n    multiShot: true,        // let sounds \"restart\" or layer on top of each other when played multiple times, rather than one-shot/one at a time\r\n    multiShotEvents: false, // fire multiple sound events (currently onfinish() only) when multiShot is enabled\r\n    position: null,         // offset (milliseconds) to seek to within loaded sound data.\r\n    pan: 0,                 // \"pan\" settings, left-to-right, -100 to 100\r\n    playbackRate: 1,        // rate at which to play the sound (HTML5-only)\r\n    stream: true,           // allows playing before entire file has loaded (recommended)\r\n    to: null,               // position to end playback within a sound (msec), default = end\r\n    type: null,             // MIME-like hint for file pattern / canPlay() tests, eg. audio/mp3\r\n    usePolicyFile: false,   // enable crossdomain.xml request for audio on remote domains (for ID3/waveform access)\r\n    volume: 100             // self-explanatory. 0-100, the latter being the max.\r\n\r\n  };\r\n\r\n  this.flash9Options = {\r\n\r\n    /**\r\n     * flash 9-only options,\r\n     * merged into defaultOptions if flash 9 is being used\r\n     */\r\n\r\n    onfailure: null,        // callback function for when playing fails (Flash 9, MovieStar + RTMP-only)\r\n    isMovieStar: null,      // \"MovieStar\" MPEG4 audio mode. Null (default) = auto detect MP4, AAC etc. based on URL. true = force on, ignore URL\r\n    usePeakData: false,     // enable left/right channel peak (level) data\r\n    useWaveformData: false, // enable sound spectrum (raw waveform data) - NOTE: May increase CPU load.\r\n    useEQData: false,       // enable sound EQ (frequency spectrum data) - NOTE: May increase CPU load.\r\n    onbufferchange: null,   // callback for \"isBuffering\" property change\r\n    ondataerror: null       // callback for waveform/eq data access error (flash playing audio in other tabs/domains)\r\n\r\n  };\r\n\r\n  this.movieStarOptions = {\r\n\r\n    /**\r\n     * flash 9.0r115+ MPEG4 audio options,\r\n     * merged into defaultOptions if flash 9+movieStar mode is enabled\r\n     */\r\n\r\n    bufferTime: 3,          // seconds of data to buffer before playback begins (null = flash default of 0.1 seconds - if AAC playback is gappy, try increasing.)\r\n    serverURL: null,        // rtmp: FMS or FMIS server to connect to, required when requesting media via RTMP or one of its variants\r\n    onconnect: null,        // rtmp: callback for connection to flash media server\r\n    duration: null          // rtmp: song duration (msec)\r\n\r\n  };\r\n\r\n  this.audioFormats = {\r\n\r\n    /**\r\n     * determines HTML5 support + flash requirements.\r\n     * if no support (via flash and/or HTML5) for a \"required\" format, SM2 will fail to start.\r\n     * flash fallback is used for MP3 or MP4 if HTML5 can't play it (or if preferFlash = true)\r\n     */\r\n\r\n    mp3: {\r\n      type: ['audio/mpeg; codecs=\"mp3\"', 'audio/mpeg', 'audio/mp3', 'audio/MPA', 'audio/mpa-robust'],\r\n      required: true\r\n    },\r\n\r\n    mp4: {\r\n      related: ['aac', 'm4a', 'm4b'], // additional formats under the MP4 container\r\n      type: ['audio/mp4; codecs=\"mp4a.40.2\"', 'audio/aac', 'audio/x-m4a', 'audio/MP4A-LATM', 'audio/mpeg4-generic'],\r\n      required: false\r\n    },\r\n\r\n    ogg: {\r\n      type: ['audio/ogg; codecs=vorbis'],\r\n      required: false\r\n    },\r\n\r\n    opus: {\r\n      type: ['audio/ogg; codecs=opus', 'audio/opus'],\r\n      required: false\r\n    },\r\n\r\n    wav: {\r\n      type: ['audio/wav; codecs=\"1\"', 'audio/wav', 'audio/wave', 'audio/x-wav'],\r\n      required: false\r\n    },\r\n\r\n    flac: {\r\n      type: ['audio/flac'],\r\n      required: false\r\n    }\r\n\r\n  };\r\n\r\n  // HTML attributes (id + class names) for the SWF container\r\n\r\n  this.movieID = 'sm2-container';\r\n  this.id = (smID || 'sm2movie');\r\n\r\n  this.debugID = 'soundmanager-debug';\r\n  this.debugURLParam = /([#?&])debug=1/i;\r\n\r\n  // dynamic attributes\r\n\r\n  this.versionNumber = 'V2.97a.20170601';\r\n  this.version = null;\r\n  this.movieURL = null;\r\n  this.altURL = null;\r\n  this.swfLoaded = false;\r\n  this.enabled = false;\r\n  this.oMC = null;\r\n  this.sounds = {};\r\n  this.soundIDs = [];\r\n  this.muted = false;\r\n  this.didFlashBlock = false;\r\n  this.filePattern = null;\r\n\r\n  this.filePatterns = {\r\n    flash8: /\\.mp3(\\?.*)?$/i,\r\n    flash9: /\\.mp3(\\?.*)?$/i\r\n  };\r\n\r\n  // support indicators, set at init\r\n\r\n  this.features = {\r\n    buffering: false,\r\n    peakData: false,\r\n    waveformData: false,\r\n    eqData: false,\r\n    movieStar: false\r\n  };\r\n\r\n  // flash sandbox info, used primarily in troubleshooting\r\n\r\n  this.sandbox = {\r\n    // <d>\r\n    type: null,\r\n    types: {\r\n      remote: 'remote (domain-based) rules',\r\n      localWithFile: 'local with file access (no internet access)',\r\n      localWithNetwork: 'local with network (internet access only, no local access)',\r\n      localTrusted: 'local, trusted (local+internet access)'\r\n    },\r\n    description: null,\r\n    noRemote: null,\r\n    noLocal: null\r\n    // </d>\r\n  };\r\n\r\n  /**\r\n   * format support (html5/flash)\r\n   * stores canPlayType() results based on audioFormats.\r\n   * eg. { mp3: boolean, mp4: boolean }\r\n   * treat as read-only.\r\n   */\r\n\r\n  this.html5 = {\r\n    usingFlash: null // set if/when flash fallback is needed\r\n  };\r\n\r\n  // file type support hash\r\n  this.flash = {};\r\n\r\n  // determined at init time\r\n  this.html5Only = false;\r\n\r\n  // used for special cases (eg. iPad/iPhone/palm OS?)\r\n  this.ignoreFlash = false;\r\n\r\n  /**\r\n   * a few private internals (OK, a lot. :D)\r\n   */\r\n\r\n  var SMSound,\r\n  sm2 = this, globalHTML5Audio = null, flash = null, sm = 'soundManager', smc = sm + ': ', h5 = 'HTML5::', id, ua = navigator.userAgent, wl = window.location.href.toString(), doc = document, doNothing, setProperties, init, fV, on_queue = [], debugOpen = true, debugTS, didAppend = false, appendSuccess = false, didInit = false, disabled = false, windowLoaded = false, _wDS, wdCount = 0, initComplete, mixin, assign, extraOptions, addOnEvent, processOnEvents, initUserOnload, delayWaitForEI, waitForEI, rebootIntoHTML5, setVersionInfo, handleFocus, strings, initMovie, domContentLoaded, winOnLoad, didDCLoaded, getDocument, createMovie, catchError, setPolling, initDebug, debugLevels = ['log', 'info', 'warn', 'error'], defaultFlashVersion = 8, disableObject, failSafely, normalizeMovieURL, oRemoved = null, oRemovedHTML = null, str, flashBlockHandler, getSWFCSS, swfCSS, toggleDebug, loopFix, policyFix, complain, idCheck, waitingForEI = false, initPending = false, startTimer, stopTimer, timerExecute, h5TimerCount = 0, h5IntervalTimer = null, parseURL, messages = [],\r\n  canIgnoreFlash, needsFlash = null, featureCheck, html5OK, html5CanPlay, html5ErrorCodes, html5Ext, html5Unload, domContentLoadedIE, testHTML5, event, slice = Array.prototype.slice, useGlobalHTML5Audio = false, lastGlobalHTML5URL, hasFlash, detectFlash, badSafariFix, html5_events, showSupport, flushMessages, wrapCallback, idCounter = 0, didSetup, msecScale = 1000,\r\n  is_iDevice = ua.match(/(ipad|iphone|ipod)/i), isAndroid = ua.match(/android/i), isIE = ua.match(/msie|trident/i),\r\n  isWebkit = ua.match(/webkit/i),\r\n  isSafari = (ua.match(/safari/i) && !ua.match(/chrome/i)),\r\n  isOpera = (ua.match(/opera/i)),\r\n  mobileHTML5 = (ua.match(/(mobile|pre\\/|xoom)/i) || is_iDevice || isAndroid),\r\n  isBadSafari = (!wl.match(/usehtml5audio/i) && !wl.match(/sm2-ignorebadua/i) && isSafari && !ua.match(/silk/i) && ua.match(/OS\\sX\\s10_6_([3-7])/i)), // Safari 4 and 5 (excluding Kindle Fire, \"Silk\") occasionally fail to load/play HTML5 audio on Snow Leopard 10.6.3 through 10.6.7 due to bug(s) in QuickTime X and/or other underlying frameworks. :/ Confirmed bug. https://bugs.webkit.org/show_bug.cgi?id=32159\r\n  hasConsole = (window.console !== _undefined && console.log !== _undefined),\r\n  isFocused = (doc.hasFocus !== _undefined ? doc.hasFocus() : null),\r\n  tryInitOnFocus = (isSafari && (doc.hasFocus === _undefined || !doc.hasFocus())),\r\n  okToDisable = !tryInitOnFocus,\r\n  flashMIME = /(mp3|mp4|mpa|m4a|m4b)/i,\r\n  emptyURL = 'about:blank', // safe URL to unload, or load nothing from (flash 8 + most HTML5 UAs)\r\n  emptyWAV = 'data:audio/wave;base64,/UklGRiYAAABXQVZFZm10IBAAAAABAAEARKwAAIhYAQACABAAZGF0YQIAAAD//w==', // tiny WAV for HTML5 unloading\r\n  overHTTP = (doc.location ? doc.location.protocol.match(/http/i) : null),\r\n  http = (!overHTTP ? '//' : ''),\r\n  // mp3, mp4, aac etc.\r\n  netStreamMimeTypes = /^\\s*audio\\/(?:x-)?(?:mpeg4|aac|flv|mov|mp4|m4v|m4a|m4b|mp4v|3gp|3g2)\\s*(?:$|;)/i,\r\n  // Flash v9.0r115+ \"moviestar\" formats\r\n  netStreamTypes = ['mpeg4', 'aac', 'flv', 'mov', 'mp4', 'm4v', 'f4v', 'm4a', 'm4b', 'mp4v', '3gp', '3g2'],\r\n  netStreamPattern = new RegExp('\\\\.(' + netStreamTypes.join('|') + ')(\\\\?.*)?$', 'i');\r\n\r\n  this.mimePattern = /^\\s*audio\\/(?:x-)?(?:mp(?:eg|3))\\s*(?:$|;)/i; // default mp3 set\r\n\r\n  // use altURL if not \"online\"\r\n  this.useAltURL = !overHTTP;\r\n\r\n  swfCSS = {\r\n    swfBox: 'sm2-object-box',\r\n    swfDefault: 'movieContainer',\r\n    swfError: 'swf_error', // SWF loaded, but SM2 couldn't start (other error)\r\n    swfTimedout: 'swf_timedout',\r\n    swfLoaded: 'swf_loaded',\r\n    swfUnblocked: 'swf_unblocked', // or loaded OK\r\n    sm2Debug: 'sm2_debug',\r\n    highPerf: 'high_performance',\r\n    flashDebug: 'flash_debug'\r\n  };\r\n\r\n  /**\r\n   * HTML5 error codes, per W3C\r\n   * Error code 1, MEDIA_ERR_ABORTED: Client aborted download at user's request.\r\n   * Error code 2, MEDIA_ERR_NETWORK: A network error of some description caused the user agent to stop fetching the media resource, after the resource was established to be usable.\r\n   * Error code 3, MEDIA_ERR_DECODE: An error of some description occurred while decoding the media resource, after the resource was established to be usable.\r\n   * Error code 4, MEDIA_ERR_SRC_NOT_SUPPORTED: Media (audio file) not supported (\"not usable.\")\r\n   * Reference: https://html.spec.whatwg.org/multipage/embedded-content.html#error-codes\r\n   */\r\n  html5ErrorCodes = [\r\n    null,\r\n    'MEDIA_ERR_ABORTED',\r\n    'MEDIA_ERR_NETWORK',\r\n    'MEDIA_ERR_DECODE',\r\n    'MEDIA_ERR_SRC_NOT_SUPPORTED'\r\n  ];\r\n\r\n  /**\r\n   * basic HTML5 Audio() support test\r\n   * try...catch because of IE 9 \"not implemented\" nonsense\r\n   * https://github.com/Modernizr/Modernizr/issues/224\r\n   */\r\n\r\n  this.hasHTML5 = (function() {\r\n    try {\r\n      // new Audio(null) for stupid Opera 9.64 case, which throws not_enough_arguments exception otherwise.\r\n      return (Audio !== _undefined && (isOpera && opera !== _undefined && opera.version() < 10 ? new Audio(null) : new Audio()).canPlayType !== _undefined);\r\n    } catch(e) {\r\n      return false;\r\n    }\r\n  }());\r\n\r\n  /**\r\n   * Public SoundManager API\r\n   * -----------------------\r\n   */\r\n\r\n  /**\r\n   * Configures top-level soundManager properties.\r\n   *\r\n   * @param {object} options Option parameters, eg. { flashVersion: 9, url: '/path/to/swfs/' }\r\n   * onready and ontimeout are also accepted parameters. call soundManager.setup() to see the full list.\r\n   */\r\n\r\n  this.setup = function(options) {\r\n\r\n    var noURL = (!sm2.url);\r\n\r\n    // warn if flash options have already been applied\r\n\r\n    if (options !== _undefined && didInit && needsFlash && sm2.ok() && (options.flashVersion !== _undefined || options.url !== _undefined || options.html5Test !== _undefined)) {\r\n      complain(str('setupLate'));\r\n    }\r\n\r\n    // TODO: defer: true?\r\n\r\n    assign(options);\r\n\r\n    if (!useGlobalHTML5Audio) {\r\n\r\n      if (mobileHTML5) {\r\n\r\n        // force the singleton HTML5 pattern on mobile, by default.\r\n        if (!sm2.setupOptions.ignoreMobileRestrictions || sm2.setupOptions.forceUseGlobalHTML5Audio) {\r\n          messages.push(strings.globalHTML5);\r\n          useGlobalHTML5Audio = true;\r\n        }\r\n\r\n      } else if (sm2.setupOptions.forceUseGlobalHTML5Audio) {\r\n\r\n        // only apply singleton HTML5 on desktop if forced.\r\n        messages.push(strings.globalHTML5);\r\n        useGlobalHTML5Audio = true;\r\n\r\n      }\r\n\r\n    }\r\n\r\n    if (!didSetup && mobileHTML5) {\r\n\r\n      if (sm2.setupOptions.ignoreMobileRestrictions) {\r\n\r\n        messages.push(strings.ignoreMobile);\r\n\r\n      } else {\r\n\r\n        // prefer HTML5 for mobile + tablet-like devices, probably more reliable vs. flash at this point.\r\n\r\n        // <d>\r\n        if (!sm2.setupOptions.useHTML5Audio || sm2.setupOptions.preferFlash) {\r\n          // notify that defaults are being changed.\r\n          sm2._wD(strings.mobileUA);\r\n        }\r\n        // </d>\r\n\r\n        sm2.setupOptions.useHTML5Audio = true;\r\n        sm2.setupOptions.preferFlash = false;\r\n\r\n        if (is_iDevice) {\r\n\r\n          // no flash here.\r\n          sm2.ignoreFlash = true;\r\n\r\n        } else if ((isAndroid && !ua.match(/android\\s2\\.3/i)) || !isAndroid) {\r\n\r\n          /**\r\n           * Android devices tend to work better with a single audio instance, specifically for chained playback of sounds in sequence.\r\n           * Common use case: exiting sound onfinish() -> createSound() -> play()\r\n           * Presuming similar restrictions for other mobile, non-Android, non-iOS devices.\r\n           */\r\n\r\n          // <d>\r\n          sm2._wD(strings.globalHTML5);\r\n          // </d>\r\n\r\n          useGlobalHTML5Audio = true;\r\n\r\n        }\r\n\r\n      }\r\n\r\n    }\r\n\r\n    // special case 1: \"Late setup\". SM2 loaded normally, but user didn't assign flash URL eg., setup({url:...}) before SM2 init. Treat as delayed init.\r\n\r\n    if (options) {\r\n\r\n      if (noURL && didDCLoaded && options.url !== _undefined) {\r\n        sm2.beginDelayedInit();\r\n      }\r\n\r\n      // special case 2: If lazy-loading SM2 (DOMContentLoaded has already happened) and user calls setup() with url: parameter, try to init ASAP.\r\n\r\n      if (!didDCLoaded && options.url !== _undefined && doc.readyState === 'complete') {\r\n        setTimeout(domContentLoaded, 1);\r\n      }\r\n\r\n    }\r\n\r\n    didSetup = true;\r\n\r\n    return sm2;\r\n\r\n  };\r\n\r\n  this.ok = function() {\r\n\r\n    return (needsFlash ? (didInit && !disabled) : (sm2.useHTML5Audio && sm2.hasHTML5));\r\n\r\n  };\r\n\r\n  this.supported = this.ok; // legacy\r\n\r\n  this.getMovie = function(movie_id) {\r\n\r\n    // safety net: some old browsers differ on SWF references, possibly related to ExternalInterface / flash version\r\n    return id(movie_id) || doc[movie_id] || window[movie_id];\r\n\r\n  };\r\n\r\n  /**\r\n   * Creates a SMSound sound object instance. Can also be overloaded, e.g., createSound('mySound', '/some.mp3');\r\n   *\r\n   * @param {object} oOptions Sound options (at minimum, url parameter is required.)\r\n   * @return {object} SMSound The new SMSound object.\r\n   */\r\n\r\n  this.createSound = function(oOptions, _url) {\r\n\r\n    var cs, cs_string, options, oSound = null;\r\n\r\n    // <d>\r\n    cs = sm + '.createSound(): ';\r\n    cs_string = cs + str(!didInit ? 'notReady' : 'notOK');\r\n    // </d>\r\n\r\n    if (!didInit || !sm2.ok()) {\r\n      complain(cs_string);\r\n      return false;\r\n    }\r\n\r\n    if (_url !== _undefined) {\r\n      // function overloading in JS! :) ... assume simple createSound(id, url) use case.\r\n      oOptions = {\r\n        id: oOptions,\r\n        url: _url\r\n      };\r\n    }\r\n\r\n    // inherit from defaultOptions\r\n    options = mixin(oOptions);\r\n\r\n    options.url = parseURL(options.url);\r\n\r\n    // generate an id, if needed.\r\n    if (options.id === _undefined) {\r\n      options.id = sm2.setupOptions.idPrefix + (idCounter++);\r\n    }\r\n\r\n    // <d>\r\n    if (options.id.toString().charAt(0).match(/^[0-9]$/)) {\r\n      sm2._wD(cs + str('badID', options.id), 2);\r\n    }\r\n\r\n    sm2._wD(cs + options.id + (options.url ? ' (' + options.url + ')' : ''), 1);\r\n    // </d>\r\n\r\n    if (idCheck(options.id, true)) {\r\n      sm2._wD(cs + options.id + ' exists', 1);\r\n      return sm2.sounds[options.id];\r\n    }\r\n\r\n    function make() {\r\n\r\n      options = loopFix(options);\r\n      sm2.sounds[options.id] = new SMSound(options);\r\n      sm2.soundIDs.push(options.id);\r\n      return sm2.sounds[options.id];\r\n\r\n    }\r\n\r\n    if (html5OK(options)) {\r\n\r\n      oSound = make();\r\n      // <d>\r\n      if (!sm2.html5Only) {\r\n        sm2._wD(options.id + ': Using HTML5');\r\n      }\r\n      // </d>\r\n      oSound._setup_html5(options);\r\n\r\n    } else {\r\n\r\n      if (sm2.html5Only) {\r\n        sm2._wD(options.id + ': No HTML5 support for this sound, and no Flash. Exiting.');\r\n        return make();\r\n      }\r\n\r\n      // TODO: Move HTML5/flash checks into generic URL parsing/handling function.\r\n\r\n      if (sm2.html5.usingFlash && options.url && options.url.match(/data:/i)) {\r\n        // data: URIs not supported by Flash, either.\r\n        sm2._wD(options.id + ': data: URIs not supported via Flash. Exiting.');\r\n        return make();\r\n      }\r\n\r\n      if (fV > 8) {\r\n        if (options.isMovieStar === null) {\r\n          // attempt to detect MPEG-4 formats\r\n          options.isMovieStar = !!(options.serverURL || (options.type ? options.type.match(netStreamMimeTypes) : false) || (options.url && options.url.match(netStreamPattern)));\r\n        }\r\n        // <d>\r\n        if (options.isMovieStar) {\r\n          sm2._wD(cs + 'using MovieStar handling');\r\n          if (options.loops > 1) {\r\n            _wDS('noNSLoop');\r\n          }\r\n        }\r\n        // </d>\r\n      }\r\n\r\n      options = policyFix(options, cs);\r\n      oSound = make();\r\n\r\n      if (fV === 8) {\r\n        flash._createSound(options.id, options.loops || 1, options.usePolicyFile);\r\n      } else {\r\n        flash._createSound(options.id, options.url, options.usePeakData, options.useWaveformData, options.useEQData, options.isMovieStar, (options.isMovieStar ? options.bufferTime : false), options.loops || 1, options.serverURL, options.duration || null, options.autoPlay, true, options.autoLoad, options.usePolicyFile);\r\n        if (!options.serverURL) {\r\n          // We are connected immediately\r\n          oSound.connected = true;\r\n          if (options.onconnect) {\r\n            options.onconnect.apply(oSound);\r\n          }\r\n        }\r\n      }\r\n\r\n      if (!options.serverURL && (options.autoLoad || options.autoPlay)) {\r\n        // call load for non-rtmp streams\r\n        oSound.load(options);\r\n      }\r\n\r\n    }\r\n\r\n    // rtmp will play in onconnect\r\n    if (!options.serverURL && options.autoPlay) {\r\n      oSound.play();\r\n    }\r\n\r\n    return oSound;\r\n\r\n  };\r\n\r\n  /**\r\n   * Destroys a SMSound sound object instance.\r\n   *\r\n   * @param {string} sID The ID of the sound to destroy\r\n   */\r\n\r\n  this.destroySound = function(sID, _bFromSound) {\r\n\r\n    // explicitly destroy a sound before normal page unload, etc.\r\n\r\n    if (!idCheck(sID)) return false;\r\n\r\n    var oS = sm2.sounds[sID], i;\r\n\r\n    oS.stop();\r\n\r\n    // Disable all callbacks after stop(), when the sound is being destroyed\r\n    oS._iO = {};\r\n\r\n    oS.unload();\r\n\r\n    for (i = 0; i < sm2.soundIDs.length; i++) {\r\n      if (sm2.soundIDs[i] === sID) {\r\n        sm2.soundIDs.splice(i, 1);\r\n        break;\r\n      }\r\n    }\r\n\r\n    if (!_bFromSound) {\r\n      // ignore if being called from SMSound instance\r\n      oS.destruct(true);\r\n    }\r\n\r\n    oS = null;\r\n    delete sm2.sounds[sID];\r\n\r\n    return true;\r\n\r\n  };\r\n\r\n  /**\r\n   * Calls the load() method of a SMSound object by ID.\r\n   *\r\n   * @param {string} sID The ID of the sound\r\n   * @param {object} oOptions Optional: Sound options\r\n   */\r\n\r\n  this.load = function(sID, oOptions) {\r\n\r\n    if (!idCheck(sID)) return false;\r\n\r\n    return sm2.sounds[sID].load(oOptions);\r\n\r\n  };\r\n\r\n  /**\r\n   * Calls the unload() method of a SMSound object by ID.\r\n   *\r\n   * @param {string} sID The ID of the sound\r\n   */\r\n\r\n  this.unload = function(sID) {\r\n\r\n    if (!idCheck(sID)) return false;\r\n\r\n    return sm2.sounds[sID].unload();\r\n\r\n  };\r\n\r\n  /**\r\n   * Calls the onPosition() method of a SMSound object by ID.\r\n   *\r\n   * @param {string} sID The ID of the sound\r\n   * @param {number} nPosition The position to watch for\r\n   * @param {function} oMethod The relevant callback to fire\r\n   * @param {object} oScope Optional: The scope to apply the callback to\r\n   * @return {SMSound} The SMSound object\r\n   */\r\n\r\n  this.onPosition = function(sID, nPosition, oMethod, oScope) {\r\n\r\n    if (!idCheck(sID)) return false;\r\n\r\n    return sm2.sounds[sID].onposition(nPosition, oMethod, oScope);\r\n\r\n  };\r\n\r\n  // legacy/backwards-compability: lower-case method name\r\n  this.onposition = this.onPosition;\r\n\r\n  /**\r\n   * Calls the clearOnPosition() method of a SMSound object by ID.\r\n   *\r\n   * @param {string} sID The ID of the sound\r\n   * @param {number} nPosition The position to watch for\r\n   * @param {function} oMethod Optional: The relevant callback to fire\r\n   * @return {SMSound} The SMSound object\r\n   */\r\n\r\n  this.clearOnPosition = function(sID, nPosition, oMethod) {\r\n\r\n    if (!idCheck(sID)) return false;\r\n\r\n    return sm2.sounds[sID].clearOnPosition(nPosition, oMethod);\r\n\r\n  };\r\n\r\n  /**\r\n   * Calls the play() method of a SMSound object by ID.\r\n   *\r\n   * @param {string} sID The ID of the sound\r\n   * @param {object} oOptions Optional: Sound options\r\n   * @return {SMSound} The SMSound object\r\n   */\r\n\r\n  this.play = function(sID, oOptions) {\r\n\r\n    var result = null,\r\n        // legacy function-overloading use case: play('mySound', '/path/to/some.mp3');\r\n        overloaded = (oOptions && !(oOptions instanceof Object));\r\n\r\n    if (!didInit || !sm2.ok()) {\r\n      complain(sm + '.play(): ' + str(!didInit ? 'notReady' : 'notOK'));\r\n      return false;\r\n    }\r\n\r\n    if (!idCheck(sID, overloaded)) {\r\n\r\n      // no sound found for the given ID. Bail.\r\n      if (!overloaded) return false;\r\n\r\n      if (overloaded) {\r\n        oOptions = {\r\n          url: oOptions\r\n        };\r\n      }\r\n\r\n      if (oOptions && oOptions.url) {\r\n        // overloading use case, create+play: .play('someID', {url:'/path/to.mp3'});\r\n        sm2._wD(sm + '.play(): Attempting to create \"' + sID + '\"', 1);\r\n        oOptions.id = sID;\r\n        result = sm2.createSound(oOptions).play();\r\n      }\r\n\r\n    } else if (overloaded) {\r\n\r\n      // existing sound object case\r\n      oOptions = {\r\n        url: oOptions\r\n      };\r\n\r\n    }\r\n\r\n    if (result === null) {\r\n      // default case\r\n      result = sm2.sounds[sID].play(oOptions);\r\n    }\r\n\r\n    return result;\r\n\r\n  };\r\n\r\n  // just for convenience\r\n  this.start = this.play;\r\n\r\n  /**\r\n   * Calls the setPlaybackRate() method of a SMSound object by ID.\r\n   *\r\n   * @param {string} sID The ID of the sound\r\n   * @return {SMSound} The SMSound object\r\n   */\r\n\r\n  this.setPlaybackRate = function(sID, rate, allowOverride) {\r\n\r\n    if (!idCheck(sID)) return false;\r\n\r\n    return sm2.sounds[sID].setPlaybackRate(rate, allowOverride);\r\n\r\n  };\r\n\r\n  /**\r\n   * Calls the setPosition() method of a SMSound object by ID.\r\n   *\r\n   * @param {string} sID The ID of the sound\r\n   * @param {number} nMsecOffset Position (milliseconds)\r\n   * @return {SMSound} The SMSound object\r\n   */\r\n\r\n  this.setPosition = function(sID, nMsecOffset) {\r\n\r\n    if (!idCheck(sID)) return false;\r\n\r\n    return sm2.sounds[sID].setPosition(nMsecOffset);\r\n\r\n  };\r\n\r\n  /**\r\n   * Calls the stop() method of a SMSound object by ID.\r\n   *\r\n   * @param {string} sID The ID of the sound\r\n   * @return {SMSound} The SMSound object\r\n   */\r\n\r\n  this.stop = function(sID) {\r\n\r\n    if (!idCheck(sID)) return false;\r\n\r\n    sm2._wD(sm + '.stop(' + sID + ')', 1);\r\n\r\n    return sm2.sounds[sID].stop();\r\n\r\n  };\r\n\r\n  /**\r\n   * Stops all currently-playing sounds.\r\n   */\r\n\r\n  this.stopAll = function() {\r\n\r\n    var oSound;\r\n    sm2._wD(sm + '.stopAll()', 1);\r\n\r\n    for (oSound in sm2.sounds) {\r\n      if (sm2.sounds.hasOwnProperty(oSound)) {\r\n        // apply only to sound objects\r\n        sm2.sounds[oSound].stop();\r\n      }\r\n    }\r\n\r\n  };\r\n\r\n  /**\r\n   * Calls the pause() method of a SMSound object by ID.\r\n   *\r\n   * @param {string} sID The ID of the sound\r\n   * @return {SMSound} The SMSound object\r\n   */\r\n\r\n  this.pause = function(sID) {\r\n\r\n    if (!idCheck(sID)) return false;\r\n\r\n    return sm2.sounds[sID].pause();\r\n\r\n  };\r\n\r\n  /**\r\n   * Pauses all currently-playing sounds.\r\n   */\r\n\r\n  this.pauseAll = function() {\r\n\r\n    var i;\r\n    for (i = sm2.soundIDs.length - 1; i >= 0; i--) {\r\n      sm2.sounds[sm2.soundIDs[i]].pause();\r\n    }\r\n\r\n  };\r\n\r\n  /**\r\n   * Calls the resume() method of a SMSound object by ID.\r\n   *\r\n   * @param {string} sID The ID of the sound\r\n   * @return {SMSound} The SMSound object\r\n   */\r\n\r\n  this.resume = function(sID) {\r\n\r\n    if (!idCheck(sID)) return false;\r\n\r\n    return sm2.sounds[sID].resume();\r\n\r\n  };\r\n\r\n  /**\r\n   * Resumes all currently-paused sounds.\r\n   */\r\n\r\n  this.resumeAll = function() {\r\n\r\n    var i;\r\n    for (i = sm2.soundIDs.length - 1; i >= 0; i--) {\r\n      sm2.sounds[sm2.soundIDs[i]].resume();\r\n    }\r\n\r\n  };\r\n\r\n  /**\r\n   * Calls the togglePause() method of a SMSound object by ID.\r\n   *\r\n   * @param {string} sID The ID of the sound\r\n   * @return {SMSound} The SMSound object\r\n   */\r\n\r\n  this.togglePause = function(sID) {\r\n\r\n    if (!idCheck(sID)) return false;\r\n\r\n    return sm2.sounds[sID].togglePause();\r\n\r\n  };\r\n\r\n  /**\r\n   * Calls the setPan() method of a SMSound object by ID.\r\n   *\r\n   * @param {string} sID The ID of the sound\r\n   * @param {number} nPan The pan value (-100 to 100)\r\n   * @return {SMSound} The SMSound object\r\n   */\r\n\r\n  this.setPan = function(sID, nPan) {\r\n\r\n    if (!idCheck(sID)) return false;\r\n\r\n    return sm2.sounds[sID].setPan(nPan);\r\n\r\n  };\r\n\r\n  /**\r\n   * Calls the setVolume() method of a SMSound object by ID\r\n   * Overloaded case: pass only volume argument eg., setVolume(50) to apply to all sounds.\r\n   *\r\n   * @param {string} sID The ID of the sound\r\n   * @param {number} nVol The volume value (0 to 100)\r\n   * @return {SMSound} The SMSound object\r\n   */\r\n\r\n  this.setVolume = function(sID, nVol) {\r\n\r\n    // setVolume(50) function overloading case - apply to all sounds\r\n\r\n    var i, j;\r\n\r\n    if (sID !== _undefined && !isNaN(sID) && nVol === _undefined) {\r\n      for (i = 0, j = sm2.soundIDs.length; i < j; i++) {\r\n        sm2.sounds[sm2.soundIDs[i]].setVolume(sID);\r\n      }\r\n      return false;\r\n    }\r\n\r\n    // setVolume('mySound', 50) case\r\n\r\n    if (!idCheck(sID)) return false;\r\n\r\n    return sm2.sounds[sID].setVolume(nVol);\r\n\r\n  };\r\n\r\n  /**\r\n   * Calls the mute() method of either a single SMSound object by ID, or all sound objects.\r\n   *\r\n   * @param {string} sID Optional: The ID of the sound (if omitted, all sounds will be used.)\r\n   */\r\n\r\n  this.mute = function(sID) {\r\n\r\n    var i = 0;\r\n\r\n    if (sID instanceof String) {\r\n      sID = null;\r\n    }\r\n\r\n    if (!sID) {\r\n\r\n      sm2._wD(sm + '.mute(): Muting all sounds');\r\n      for (i = sm2.soundIDs.length - 1; i >= 0; i--) {\r\n        sm2.sounds[sm2.soundIDs[i]].mute();\r\n      }\r\n      sm2.muted = true;\r\n\r\n    } else {\r\n\r\n      if (!idCheck(sID)) return false;\r\n\r\n      sm2._wD(sm + '.mute(): Muting \"' + sID + '\"');\r\n      return sm2.sounds[sID].mute();\r\n\r\n    }\r\n\r\n    return true;\r\n\r\n  };\r\n\r\n  /**\r\n   * Mutes all sounds.\r\n   */\r\n\r\n  this.muteAll = function() {\r\n\r\n    sm2.mute();\r\n\r\n  };\r\n\r\n  /**\r\n   * Calls the unmute() method of either a single SMSound object by ID, or all sound objects.\r\n   *\r\n   * @param {string} sID Optional: The ID of the sound (if omitted, all sounds will be used.)\r\n   */\r\n\r\n  this.unmute = function(sID) {\r\n\r\n    var i;\r\n\r\n    if (sID instanceof String) {\r\n      sID = null;\r\n    }\r\n\r\n    if (!sID) {\r\n\r\n      sm2._wD(sm + '.unmute(): Unmuting all sounds');\r\n      for (i = sm2.soundIDs.length - 1; i >= 0; i--) {\r\n        sm2.sounds[sm2.soundIDs[i]].unmute();\r\n      }\r\n      sm2.muted = false;\r\n\r\n    } else {\r\n\r\n      if (!idCheck(sID)) return false;\r\n\r\n      sm2._wD(sm + '.unmute(): Unmuting \"' + sID + '\"');\r\n\r\n      return sm2.sounds[sID].unmute();\r\n\r\n    }\r\n\r\n    return true;\r\n\r\n  };\r\n\r\n  /**\r\n   * Unmutes all sounds.\r\n   */\r\n\r\n  this.unmuteAll = function() {\r\n\r\n    sm2.unmute();\r\n\r\n  };\r\n\r\n  /**\r\n   * Calls the toggleMute() method of a SMSound object by ID.\r\n   *\r\n   * @param {string} sID The ID of the sound\r\n   * @return {SMSound} The SMSound object\r\n   */\r\n\r\n  this.toggleMute = function(sID) {\r\n\r\n    if (!idCheck(sID)) return false;\r\n\r\n    return sm2.sounds[sID].toggleMute();\r\n\r\n  };\r\n\r\n  /**\r\n   * Retrieves the memory used by the flash plugin.\r\n   *\r\n   * @return {number} The amount of memory in use\r\n   */\r\n\r\n  this.getMemoryUse = function() {\r\n\r\n    // flash-only\r\n    var ram = 0;\r\n\r\n    if (flash && fV !== 8) {\r\n      ram = parseInt(flash._getMemoryUse(), 10);\r\n    }\r\n\r\n    return ram;\r\n\r\n  };\r\n\r\n  /**\r\n   * Undocumented: NOPs soundManager and all SMSound objects.\r\n   */\r\n\r\n  this.disable = function(bNoDisable) {\r\n\r\n    // destroy all functions\r\n    var i;\r\n\r\n    if (bNoDisable === _undefined) {\r\n      bNoDisable = false;\r\n    }\r\n\r\n    // already disabled?\r\n    if (disabled) return false;\r\n\r\n    disabled = true;\r\n\r\n    _wDS('shutdown', 1);\r\n\r\n    for (i = sm2.soundIDs.length - 1; i >= 0; i--) {\r\n      disableObject(sm2.sounds[sm2.soundIDs[i]]);\r\n    }\r\n\r\n    disableObject(sm2);\r\n\r\n    // fire \"complete\", despite fail\r\n    initComplete(bNoDisable);\r\n\r\n    event.remove(window, 'load', initUserOnload);\r\n\r\n    return true;\r\n\r\n  };\r\n\r\n  /**\r\n   * Determines playability of a MIME type, eg. 'audio/mp3'.\r\n   */\r\n\r\n  this.canPlayMIME = function(sMIME) {\r\n\r\n    var result;\r\n\r\n    if (sm2.hasHTML5) {\r\n      result = html5CanPlay({\r\n        type: sMIME\r\n      });\r\n    }\r\n\r\n    if (!result && needsFlash) {\r\n      // if flash 9, test netStream (movieStar) types as well.\r\n      result = (sMIME && sm2.ok() ? !!((fV > 8 ? sMIME.match(netStreamMimeTypes) : null) || sMIME.match(sm2.mimePattern)) : null); // TODO: make less \"weird\" (per JSLint)\r\n    }\r\n\r\n    return result;\r\n\r\n  };\r\n\r\n  /**\r\n   * Determines playability of a URL based on audio support.\r\n   *\r\n   * @param {string} sURL The URL to test\r\n   * @return {boolean} URL playability\r\n   */\r\n\r\n  this.canPlayURL = function(sURL) {\r\n\r\n    var result;\r\n\r\n    if (sm2.hasHTML5) {\r\n      result = html5CanPlay({\r\n        url: sURL\r\n      });\r\n    }\r\n\r\n    if (!result && needsFlash) {\r\n      result = (sURL && sm2.ok() ? !!(sURL.match(sm2.filePattern)) : null);\r\n    }\r\n\r\n    return result;\r\n\r\n  };\r\n\r\n  /**\r\n   * Determines playability of an HTML DOM &lt;a&gt; object (or similar object literal) based on audio support.\r\n   *\r\n   * @param {object} oLink an HTML DOM &lt;a&gt; object or object literal including href and/or type attributes\r\n   * @return {boolean} URL playability\r\n   */\r\n\r\n  this.canPlayLink = function(oLink) {\r\n\r\n    if (oLink.type !== _undefined && oLink.type && sm2.canPlayMIME(oLink.type)) return true;\r\n\r\n    return sm2.canPlayURL(oLink.href);\r\n\r\n  };\r\n\r\n  /**\r\n   * Retrieves a SMSound object by ID.\r\n   *\r\n   * @param {string} sID The ID of the sound\r\n   * @return {SMSound} The SMSound object\r\n   */\r\n\r\n  this.getSoundById = function(sID, _suppressDebug) {\r\n\r\n    if (!sID) return null;\r\n\r\n    var result = sm2.sounds[sID];\r\n\r\n    // <d>\r\n    if (!result && !_suppressDebug) {\r\n      sm2._wD(sm + '.getSoundById(): Sound \"' + sID + '\" not found.', 2);\r\n    }\r\n    // </d>\r\n\r\n    return result;\r\n\r\n  };\r\n\r\n  /**\r\n   * Queues a callback for execution when SoundManager has successfully initialized.\r\n   *\r\n   * @param {function} oMethod The callback method to fire\r\n   * @param {object} oScope Optional: The scope to apply to the callback\r\n   */\r\n\r\n  this.onready = function(oMethod, oScope) {\r\n\r\n    var sType = 'onready',\r\n        result = false;\r\n\r\n    if (typeof oMethod === 'function') {\r\n\r\n      // <d>\r\n      if (didInit) {\r\n        sm2._wD(str('queue', sType));\r\n      }\r\n      // </d>\r\n\r\n      if (!oScope) {\r\n        oScope = window;\r\n      }\r\n\r\n      addOnEvent(sType, oMethod, oScope);\r\n      processOnEvents();\r\n\r\n      result = true;\r\n\r\n    } else {\r\n\r\n      throw str('needFunction', sType);\r\n\r\n    }\r\n\r\n    return result;\r\n\r\n  };\r\n\r\n  /**\r\n   * Queues a callback for execution when SoundManager has failed to initialize.\r\n   *\r\n   * @param {function} oMethod The callback method to fire\r\n   * @param {object} oScope Optional: The scope to apply to the callback\r\n   */\r\n\r\n  this.ontimeout = function(oMethod, oScope) {\r\n\r\n    var sType = 'ontimeout',\r\n        result = false;\r\n\r\n    if (typeof oMethod === 'function') {\r\n\r\n      // <d>\r\n      if (didInit) {\r\n        sm2._wD(str('queue', sType));\r\n      }\r\n      // </d>\r\n\r\n      if (!oScope) {\r\n        oScope = window;\r\n      }\r\n\r\n      addOnEvent(sType, oMethod, oScope);\r\n      processOnEvents({ type: sType });\r\n\r\n      result = true;\r\n\r\n    } else {\r\n\r\n      throw str('needFunction', sType);\r\n\r\n    }\r\n\r\n    return result;\r\n\r\n  };\r\n\r\n  /**\r\n   * Writes console.log()-style debug output to a console or in-browser element.\r\n   * Applies when debugMode = true\r\n   *\r\n   * @param {string} sText The console message\r\n   * @param {object} nType Optional log level (number), or object. Number case: Log type/style where 0 = 'info', 1 = 'warn', 2 = 'error'. Object case: Object to be dumped.\r\n   */\r\n\r\n  this._writeDebug = function(sText, sTypeOrObject) {\r\n\r\n    // pseudo-private console.log()-style output\r\n    // <d>\r\n\r\n    var sDID = 'soundmanager-debug', o, oItem;\r\n\r\n    if (!sm2.setupOptions.debugMode) return false;\r\n\r\n    if (hasConsole && sm2.useConsole) {\r\n      if (sTypeOrObject && typeof sTypeOrObject === 'object') {\r\n        // object passed; dump to console.\r\n        console.log(sText, sTypeOrObject);\r\n      } else if (debugLevels[sTypeOrObject] !== _undefined) {\r\n        console[debugLevels[sTypeOrObject]](sText);\r\n      } else {\r\n        console.log(sText);\r\n      }\r\n      if (sm2.consoleOnly) return true;\r\n    }\r\n\r\n    o = id(sDID);\r\n\r\n    if (!o) return false;\r\n\r\n    oItem = doc.createElement('div');\r\n\r\n    if (++wdCount % 2 === 0) {\r\n      oItem.className = 'sm2-alt';\r\n    }\r\n\r\n    if (sTypeOrObject === _undefined) {\r\n      sTypeOrObject = 0;\r\n    } else {\r\n      sTypeOrObject = parseInt(sTypeOrObject, 10);\r\n    }\r\n\r\n    oItem.appendChild(doc.createTextNode(sText));\r\n\r\n    if (sTypeOrObject) {\r\n      if (sTypeOrObject >= 2) {\r\n        oItem.style.fontWeight = 'bold';\r\n      }\r\n      if (sTypeOrObject === 3) {\r\n        oItem.style.color = '#ff3333';\r\n      }\r\n    }\r\n\r\n    // top-to-bottom\r\n    // o.appendChild(oItem);\r\n\r\n    // bottom-to-top\r\n    o.insertBefore(oItem, o.firstChild);\r\n\r\n    o = null;\r\n    // </d>\r\n\r\n    return true;\r\n\r\n  };\r\n\r\n  // <d>\r\n  // last-resort debugging option\r\n  if (wl.indexOf('sm2-debug=alert') !== -1) {\r\n    this._writeDebug = function(sText) {\r\n      window.alert(sText);\r\n    };\r\n  }\r\n  // </d>\r\n\r\n  // alias\r\n  this._wD = this._writeDebug;\r\n\r\n  /**\r\n   * Provides debug / state information on all SMSound objects.\r\n   */\r\n\r\n  this._debug = function() {\r\n\r\n    // <d>\r\n    var i, j;\r\n    _wDS('currentObj', 1);\r\n\r\n    for (i = 0, j = sm2.soundIDs.length; i < j; i++) {\r\n      sm2.sounds[sm2.soundIDs[i]]._debug();\r\n    }\r\n    // </d>\r\n\r\n  };\r\n\r\n  /**\r\n   * Restarts and re-initializes the SoundManager instance.\r\n   *\r\n   * @param {boolean} resetEvents Optional: When true, removes all registered onready and ontimeout event callbacks.\r\n   * @param {boolean} excludeInit Options: When true, does not call beginDelayedInit() (which would restart SM2).\r\n   * @return {object} soundManager The soundManager instance.\r\n   */\r\n\r\n  this.reboot = function(resetEvents, excludeInit) {\r\n\r\n    // reset some (or all) state, and re-init unless otherwise specified.\r\n\r\n    // <d>\r\n    if (sm2.soundIDs.length) {\r\n      sm2._wD('Destroying ' + sm2.soundIDs.length + ' SMSound object' + (sm2.soundIDs.length !== 1 ? 's' : '') + '...');\r\n    }\r\n    // </d>\r\n\r\n    var i, j, k;\r\n\r\n    for (i = sm2.soundIDs.length - 1; i >= 0; i--) {\r\n      sm2.sounds[sm2.soundIDs[i]].destruct();\r\n    }\r\n\r\n    // trash ze flash (remove from the DOM)\r\n\r\n    if (flash) {\r\n\r\n      try {\r\n\r\n        if (isIE) {\r\n          oRemovedHTML = flash.innerHTML;\r\n        }\r\n\r\n        oRemoved = flash.parentNode.removeChild(flash);\r\n\r\n      } catch(e) {\r\n\r\n        // Remove failed? May be due to flash blockers silently removing the SWF object/embed node from the DOM. Warn and continue.\r\n\r\n        _wDS('badRemove', 2);\r\n\r\n      }\r\n\r\n    }\r\n\r\n    // actually, force recreate of movie.\r\n\r\n    oRemovedHTML = oRemoved = needsFlash = flash = null;\r\n\r\n    sm2.enabled = didDCLoaded = didInit = waitingForEI = initPending = didAppend = appendSuccess = disabled = useGlobalHTML5Audio = sm2.swfLoaded = false;\r\n\r\n    sm2.soundIDs = [];\r\n    sm2.sounds = {};\r\n\r\n    idCounter = 0;\r\n    didSetup = false;\r\n\r\n    if (!resetEvents) {\r\n      // reset callbacks for onready, ontimeout etc. so that they will fire again on re-init\r\n      for (i in on_queue) {\r\n        if (on_queue.hasOwnProperty(i)) {\r\n          for (j = 0, k = on_queue[i].length; j < k; j++) {\r\n            on_queue[i][j].fired = false;\r\n          }\r\n        }\r\n      }\r\n    } else {\r\n      // remove all callbacks entirely\r\n      on_queue = [];\r\n    }\r\n\r\n    // <d>\r\n    if (!excludeInit) {\r\n      sm2._wD(sm + ': Rebooting...');\r\n    }\r\n    // </d>\r\n\r\n    // reset HTML5 and flash canPlay test results\r\n\r\n    sm2.html5 = {\r\n      usingFlash: null\r\n    };\r\n\r\n    sm2.flash = {};\r\n\r\n    // reset device-specific HTML/flash mode switches\r\n\r\n    sm2.html5Only = false;\r\n    sm2.ignoreFlash = false;\r\n\r\n    window.setTimeout(function() {\r\n\r\n      // by default, re-init\r\n\r\n      if (!excludeInit) {\r\n        sm2.beginDelayedInit();\r\n      }\r\n\r\n    }, 20);\r\n\r\n    return sm2;\r\n\r\n  };\r\n\r\n  this.reset = function() {\r\n\r\n    /**\r\n     * Shuts down and restores the SoundManager instance to its original loaded state, without an explicit reboot. All onready/ontimeout handlers are removed.\r\n     * After this call, SM2 may be re-initialized via soundManager.beginDelayedInit().\r\n     * @return {object} soundManager The soundManager instance.\r\n     */\r\n\r\n    _wDS('reset');\r\n\r\n    return sm2.reboot(true, true);\r\n\r\n  };\r\n\r\n  /**\r\n   * Undocumented: Determines the SM2 flash movie's load progress.\r\n   *\r\n   * @return {number or null} Percent loaded, or if invalid/unsupported, null.\r\n   */\r\n\r\n  this.getMoviePercent = function() {\r\n\r\n    /**\r\n     * Interesting syntax notes...\r\n     * Flash/ExternalInterface (ActiveX/NPAPI) bridge methods are not typeof \"function\" nor instanceof Function, but are still valid.\r\n     * Furthermore, using (flash && flash.PercentLoaded) causes IE to throw \"object doesn't support this property or method\".\r\n     * Thus, 'in' syntax must be used.\r\n     */\r\n\r\n    return (flash && 'PercentLoaded' in flash ? flash.PercentLoaded() : null);\r\n\r\n  };\r\n\r\n  /**\r\n   * Additional helper for manually invoking SM2's init process after DOM Ready / window.onload().\r\n   */\r\n\r\n  this.beginDelayedInit = function() {\r\n\r\n    windowLoaded = true;\r\n    domContentLoaded();\r\n\r\n    setTimeout(function() {\r\n\r\n      if (initPending) return false;\r\n\r\n      createMovie();\r\n      initMovie();\r\n      initPending = true;\r\n\r\n      return true;\r\n\r\n    }, 20);\r\n\r\n    delayWaitForEI();\r\n\r\n  };\r\n\r\n  /**\r\n   * Destroys the SoundManager instance and all SMSound instances.\r\n   */\r\n\r\n  this.destruct = function() {\r\n\r\n    sm2._wD(sm + '.destruct()');\r\n    sm2.disable(true);\r\n\r\n  };\r\n\r\n  /**\r\n   * SMSound() (sound object) constructor\r\n   * ------------------------------------\r\n   *\r\n   * @param {object} oOptions Sound options (id and url are required attributes)\r\n   * @return {SMSound} The new SMSound object\r\n   */\r\n\r\n  SMSound = function(oOptions) {\r\n\r\n    var s = this, resetProperties, add_html5_events, remove_html5_events, stop_html5_timer, start_html5_timer, attachOnPosition, onplay_called = false, onPositionItems = [], onPositionFired = 0, detachOnPosition, applyFromTo, lastURL = null, lastHTML5State, urlOmitted;\r\n\r\n    lastHTML5State = {\r\n      // tracks duration + position (time)\r\n      duration: null,\r\n      time: null\r\n    };\r\n\r\n    this.id = oOptions.id;\r\n\r\n    // legacy\r\n    this.sID = this.id;\r\n\r\n    this.url = oOptions.url;\r\n    this.options = mixin(oOptions);\r\n\r\n    // per-play-instance-specific options\r\n    this.instanceOptions = this.options;\r\n\r\n    // short alias\r\n    this._iO = this.instanceOptions;\r\n\r\n    // assign property defaults\r\n    this.pan = this.options.pan;\r\n    this.volume = this.options.volume;\r\n\r\n    // whether or not this object is using HTML5\r\n    this.isHTML5 = false;\r\n\r\n    // internal HTML5 Audio() object reference\r\n    this._a = null;\r\n\r\n    // for flash 8 special-case createSound() without url, followed by load/play with url case\r\n    urlOmitted = (!this.url);\r\n\r\n    /**\r\n     * SMSound() public methods\r\n     * ------------------------\r\n     */\r\n\r\n    this.id3 = {};\r\n\r\n    /**\r\n     * Writes SMSound object parameters to debug console\r\n     */\r\n\r\n    this._debug = function() {\r\n\r\n      // <d>\r\n      sm2._wD(s.id + ': Merged options:', s.options);\r\n      // </d>\r\n\r\n    };\r\n\r\n    /**\r\n     * Begins loading a sound per its *url*.\r\n     *\r\n     * @param {object} options Optional: Sound options\r\n     * @return {SMSound} The SMSound object\r\n     */\r\n\r\n    this.load = function(options) {\r\n\r\n      var oSound = null, instanceOptions;\r\n\r\n      if (options !== _undefined) {\r\n        s._iO = mixin(options, s.options);\r\n      } else {\r\n        options = s.options;\r\n        s._iO = options;\r\n        if (lastURL && lastURL !== s.url) {\r\n          _wDS('manURL');\r\n          s._iO.url = s.url;\r\n          s.url = null;\r\n        }\r\n      }\r\n\r\n      if (!s._iO.url) {\r\n        s._iO.url = s.url;\r\n      }\r\n\r\n      s._iO.url = parseURL(s._iO.url);\r\n\r\n      // ensure we're in sync\r\n      s.instanceOptions = s._iO;\r\n\r\n      // local shortcut\r\n      instanceOptions = s._iO;\r\n\r\n      sm2._wD(s.id + ': load (' + instanceOptions.url + ')');\r\n\r\n      if (!instanceOptions.url && !s.url) {\r\n        sm2._wD(s.id + ': load(): url is unassigned. Exiting.', 2);\r\n        return s;\r\n      }\r\n\r\n      // <d>\r\n      if (!s.isHTML5 && fV === 8 && !s.url && !instanceOptions.autoPlay) {\r\n        // flash 8 load() -> play() won't work before onload has fired.\r\n        sm2._wD(s.id + ': Flash 8 load() limitation: Wait for onload() before calling play().', 1);\r\n      }\r\n      // </d>\r\n\r\n      if (instanceOptions.url === s.url && s.readyState !== 0 && s.readyState !== 2) {\r\n        _wDS('onURL', 1);\r\n        // if loaded and an onload() exists, fire immediately.\r\n        if (s.readyState === 3 && instanceOptions.onload) {\r\n          // assume success based on truthy duration.\r\n          wrapCallback(s, function() {\r\n            instanceOptions.onload.apply(s, [(!!s.duration)]);\r\n          });\r\n        }\r\n        return s;\r\n      }\r\n\r\n      // reset a few state properties\r\n\r\n      s.loaded = false;\r\n      s.readyState = 1;\r\n      s.playState = 0;\r\n      s.id3 = {};\r\n\r\n      // TODO: If switching from HTML5 -> flash (or vice versa), stop currently-playing audio.\r\n\r\n      if (html5OK(instanceOptions)) {\r\n\r\n        oSound = s._setup_html5(instanceOptions);\r\n\r\n        if (!oSound._called_load) {\r\n\r\n          s._html5_canplay = false;\r\n\r\n          // TODO: review called_load / html5_canplay logic\r\n\r\n          // if url provided directly to load(), assign it here.\r\n\r\n          if (s.url !== instanceOptions.url) {\r\n\r\n            sm2._wD(_wDS('manURL') + ': ' + instanceOptions.url);\r\n\r\n            s._a.src = instanceOptions.url;\r\n\r\n            // TODO: review / re-apply all relevant options (volume, loop, onposition etc.)\r\n\r\n            // reset position for new URL\r\n            s.setPosition(0);\r\n\r\n          }\r\n\r\n          // given explicit load call, try to preload.\r\n\r\n          // early HTML5 implementation (non-standard)\r\n          s._a.autobuffer = 'auto';\r\n\r\n          // standard property, values: none / metadata / auto\r\n          // reference: http://msdn.microsoft.com/en-us/library/ie/ff974759%28v=vs.85%29.aspx\r\n          s._a.preload = 'auto';\r\n\r\n          s._a._called_load = true;\r\n\r\n        } else {\r\n\r\n          sm2._wD(s.id + ': Ignoring request to load again');\r\n\r\n        }\r\n\r\n      } else {\r\n\r\n        if (sm2.html5Only) {\r\n          sm2._wD(s.id + ': No flash support. Exiting.');\r\n          return s;\r\n        }\r\n\r\n        if (s._iO.url && s._iO.url.match(/data:/i)) {\r\n          // data: URIs not supported by Flash, either.\r\n          sm2._wD(s.id + ': data: URIs not supported via Flash. Exiting.');\r\n          return s;\r\n        }\r\n\r\n        try {\r\n          s.isHTML5 = false;\r\n          s._iO = policyFix(loopFix(instanceOptions));\r\n          // if we have \"position\", disable auto-play as we'll be seeking to that position at onload().\r\n          if (s._iO.autoPlay && (s._iO.position || s._iO.from)) {\r\n            sm2._wD(s.id + ': Disabling autoPlay because of non-zero offset case');\r\n            s._iO.autoPlay = false;\r\n          }\r\n          // re-assign local shortcut\r\n          instanceOptions = s._iO;\r\n          if (fV === 8) {\r\n            flash._load(s.id, instanceOptions.url, instanceOptions.stream, instanceOptions.autoPlay, instanceOptions.usePolicyFile);\r\n          } else {\r\n            flash._load(s.id, instanceOptions.url, !!(instanceOptions.stream), !!(instanceOptions.autoPlay), instanceOptions.loops || 1, !!(instanceOptions.autoLoad), instanceOptions.usePolicyFile);\r\n          }\r\n        } catch(e) {\r\n          _wDS('smError', 2);\r\n          debugTS('onload', false);\r\n          catchError({\r\n            type: 'SMSOUND_LOAD_JS_EXCEPTION',\r\n            fatal: true\r\n          });\r\n        }\r\n\r\n      }\r\n\r\n      // after all of this, ensure sound url is up to date.\r\n      s.url = instanceOptions.url;\r\n\r\n      return s;\r\n\r\n    };\r\n\r\n    /**\r\n     * Unloads a sound, canceling any open HTTP requests.\r\n     *\r\n     * @return {SMSound} The SMSound object\r\n     */\r\n\r\n    this.unload = function() {\r\n\r\n      // Flash 8/AS2 can't \"close\" a stream - fake it by loading an empty URL\r\n      // Flash 9/AS3: Close stream, preventing further load\r\n      // HTML5: Most UAs will use empty URL\r\n\r\n      if (s.readyState !== 0) {\r\n\r\n        sm2._wD(s.id + ': unload()');\r\n\r\n        if (!s.isHTML5) {\r\n\r\n          if (fV === 8) {\r\n            flash._unload(s.id, emptyURL);\r\n          } else {\r\n            flash._unload(s.id);\r\n          }\r\n\r\n        } else {\r\n\r\n          stop_html5_timer();\r\n\r\n          if (s._a) {\r\n\r\n            s._a.pause();\r\n\r\n            // update empty URL, too\r\n            lastURL = html5Unload(s._a);\r\n\r\n          }\r\n\r\n        }\r\n\r\n        // reset load/status flags\r\n        resetProperties();\r\n\r\n      }\r\n\r\n      return s;\r\n\r\n    };\r\n\r\n    /**\r\n     * Unloads and destroys a sound.\r\n     */\r\n\r\n    this.destruct = function(_bFromSM) {\r\n\r\n      sm2._wD(s.id + ': Destruct');\r\n\r\n      if (!s.isHTML5) {\r\n\r\n        // kill sound within Flash\r\n        // Disable the onfailure handler\r\n        s._iO.onfailure = null;\r\n        flash._destroySound(s.id);\r\n\r\n      } else {\r\n\r\n        stop_html5_timer();\r\n\r\n        if (s._a) {\r\n          s._a.pause();\r\n          html5Unload(s._a);\r\n          if (!useGlobalHTML5Audio) {\r\n            remove_html5_events();\r\n          }\r\n          // break obvious circular reference\r\n          s._a._s = null;\r\n          s._a = null;\r\n        }\r\n\r\n      }\r\n\r\n      if (!_bFromSM) {\r\n        // ensure deletion from controller\r\n        sm2.destroySound(s.id, true);\r\n      }\r\n\r\n    };\r\n\r\n    /**\r\n     * Begins playing a sound.\r\n     *\r\n     * @param {object} options Optional: Sound options\r\n     * @return {SMSound} The SMSound object\r\n     */\r\n\r\n    this.play = function(options, _updatePlayState) {\r\n\r\n      var fN, allowMulti, a, onready,\r\n          audioClone, onended, oncanplay,\r\n          startOK = true;\r\n\r\n      // <d>\r\n      fN = s.id + ': play(): ';\r\n      // </d>\r\n\r\n      // default to true\r\n      _updatePlayState = (_updatePlayState === _undefined ? true : _updatePlayState);\r\n\r\n      if (!options) {\r\n        options = {};\r\n      }\r\n\r\n      // first, use local URL (if specified)\r\n      if (s.url) {\r\n        s._iO.url = s.url;\r\n      }\r\n\r\n      // mix in any options defined at createSound()\r\n      s._iO = mixin(s._iO, s.options);\r\n\r\n      // mix in any options specific to this method\r\n      s._iO = mixin(options, s._iO);\r\n\r\n      s._iO.url = parseURL(s._iO.url);\r\n\r\n      s.instanceOptions = s._iO;\r\n\r\n      // RTMP-only\r\n      if (!s.isHTML5 && s._iO.serverURL && !s.connected) {\r\n        if (!s.getAutoPlay()) {\r\n          sm2._wD(fN + ' Netstream not connected yet - setting autoPlay');\r\n          s.setAutoPlay(true);\r\n        }\r\n        // play will be called in onconnect()\r\n        return s;\r\n      }\r\n\r\n      if (html5OK(s._iO)) {\r\n        s._setup_html5(s._iO);\r\n        start_html5_timer();\r\n      }\r\n\r\n      if (s.playState === 1 && !s.paused) {\r\n\r\n        allowMulti = s._iO.multiShot;\r\n\r\n        if (!allowMulti) {\r\n\r\n          sm2._wD(fN + 'Already playing (one-shot)', 1);\r\n\r\n          if (s.isHTML5) {\r\n            // go back to original position.\r\n            s.setPosition(s._iO.position);\r\n          }\r\n\r\n          return s;\r\n\r\n        }\r\n\r\n        sm2._wD(fN + 'Already playing (multi-shot)', 1);\r\n\r\n      }\r\n\r\n      // edge case: play() with explicit URL parameter\r\n      if (options.url && options.url !== s.url) {\r\n\r\n        // special case for createSound() followed by load() / play() with url; avoid double-load case.\r\n        if (!s.readyState && !s.isHTML5 && fV === 8 && urlOmitted) {\r\n\r\n          urlOmitted = false;\r\n\r\n        } else {\r\n\r\n          // load using merged options\r\n          s.load(s._iO);\r\n\r\n        }\r\n\r\n      }\r\n\r\n      if (!s.loaded) {\r\n\r\n        if (s.readyState === 0) {\r\n\r\n          sm2._wD(fN + 'Attempting to load');\r\n\r\n          // try to get this sound playing ASAP\r\n          if (!s.isHTML5 && !sm2.html5Only) {\r\n\r\n            // flash: assign directly because setAutoPlay() increments the instanceCount\r\n            s._iO.autoPlay = true;\r\n            s.load(s._iO);\r\n\r\n          } else if (s.isHTML5) {\r\n\r\n            // iOS needs this when recycling sounds, loading a new URL on an existing object.\r\n            s.load(s._iO);\r\n\r\n          } else {\r\n\r\n            sm2._wD(fN + 'Unsupported type. Exiting.');\r\n\r\n            return s;\r\n\r\n          }\r\n\r\n          // HTML5 hack - re-set instanceOptions?\r\n          s.instanceOptions = s._iO;\r\n\r\n        } else if (s.readyState === 2) {\r\n\r\n          sm2._wD(fN + 'Could not load - exiting', 2);\r\n\r\n          return s;\r\n\r\n        } else {\r\n\r\n          sm2._wD(fN + 'Loading - attempting to play...');\r\n\r\n        }\r\n\r\n      } else {\r\n\r\n        // \"play()\"\r\n        sm2._wD(fN.substr(0, fN.lastIndexOf(':')));\r\n\r\n      }\r\n\r\n      if (!s.isHTML5 && fV === 9 && s.position > 0 && s.position === s.duration) {\r\n        // flash 9 needs a position reset if play() is called while at the end of a sound.\r\n        sm2._wD(fN + 'Sound at end, resetting to position: 0');\r\n        options.position = 0;\r\n      }\r\n\r\n      /**\r\n       * Streams will pause when their buffer is full if they are being loaded.\r\n       * In this case paused is true, but the song hasn't started playing yet.\r\n       * If we just call resume() the onplay() callback will never be called.\r\n       * So only call resume() if the position is > 0.\r\n       * Another reason is because options like volume won't have been applied yet.\r\n       * For normal sounds, just resume.\r\n       */\r\n\r\n      if (s.paused && s.position >= 0 && (!s._iO.serverURL || s.position > 0)) {\r\n\r\n        // https://gist.github.com/37b17df75cc4d7a90bf6\r\n        sm2._wD(fN + 'Resuming from paused state', 1);\r\n        s.resume();\r\n\r\n      } else {\r\n\r\n        s._iO = mixin(options, s._iO);\r\n\r\n        /**\r\n         * Preload in the event of play() with position under Flash,\r\n         * or from/to parameters and non-RTMP case\r\n         */\r\n        if (((!s.isHTML5 && s._iO.position !== null && s._iO.position > 0) || (s._iO.from !== null && s._iO.from > 0) || s._iO.to !== null) && s.instanceCount === 0 && s.playState === 0 && !s._iO.serverURL) {\r\n\r\n          onready = function() {\r\n            // sound \"canplay\" or onload()\r\n            // re-apply position/from/to to instance options, and start playback\r\n            s._iO = mixin(options, s._iO);\r\n            s.play(s._iO);\r\n          };\r\n\r\n          // HTML5 needs to at least have \"canplay\" fired before seeking.\r\n          if (s.isHTML5 && !s._html5_canplay) {\r\n\r\n            // this hasn't been loaded yet. load it first, and then do this again.\r\n            sm2._wD(fN + 'Beginning load for non-zero offset case');\r\n\r\n            s.load({\r\n              // note: custom HTML5-only event added for from/to implementation.\r\n              _oncanplay: onready\r\n            });\r\n\r\n          } else if (!s.isHTML5 && !s.loaded && (!s.readyState || s.readyState !== 2)) {\r\n\r\n            // to be safe, preload the whole thing in Flash.\r\n\r\n            sm2._wD(fN + 'Preloading for non-zero offset case');\r\n\r\n            s.load({\r\n              onload: onready\r\n            });\r\n\r\n          }\r\n\r\n          // otherwise, we're ready to go. re-apply local options, and continue\r\n\r\n          s._iO = applyFromTo();\r\n\r\n        }\r\n\r\n        // sm2._wD(fN + 'Starting to play');\r\n\r\n        // increment instance counter, where enabled + supported\r\n        if (!s.instanceCount || s._iO.multiShotEvents || (s.isHTML5 && s._iO.multiShot && !useGlobalHTML5Audio) || (!s.isHTML5 && fV > 8 && !s.getAutoPlay())) {\r\n          s.instanceCount++;\r\n        }\r\n\r\n        // if first play and onposition parameters exist, apply them now\r\n        if (s._iO.onposition && s.playState === 0) {\r\n          attachOnPosition(s);\r\n        }\r\n\r\n        s.playState = 1;\r\n        s.paused = false;\r\n\r\n        s.position = (s._iO.position !== _undefined && !isNaN(s._iO.position) ? s._iO.position : 0);\r\n\r\n        if (!s.isHTML5) {\r\n          s._iO = policyFix(loopFix(s._iO));\r\n        }\r\n\r\n        if (s._iO.onplay && _updatePlayState) {\r\n          s._iO.onplay.apply(s);\r\n          onplay_called = true;\r\n        }\r\n\r\n        s.setVolume(s._iO.volume, true);\r\n        s.setPan(s._iO.pan, true);\r\n\r\n        if (s._iO.playbackRate !== 1) {\r\n          s.setPlaybackRate(s._iO.playbackRate);\r\n        }\r\n\r\n        if (!s.isHTML5) {\r\n\r\n          startOK = flash._start(s.id, s._iO.loops || 1, (fV === 9 ? s.position : s.position / msecScale), s._iO.multiShot || false);\r\n\r\n          if (fV === 9 && !startOK) {\r\n            // edge case: no sound hardware, or 32-channel flash ceiling hit.\r\n            // applies only to Flash 9, non-NetStream/MovieStar sounds.\r\n            // http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/media/Sound.html#play%28%29\r\n            sm2._wD(fN + 'No sound hardware, or 32-sound ceiling hit', 2);\r\n            if (s._iO.onplayerror) {\r\n              s._iO.onplayerror.apply(s);\r\n            }\r\n\r\n          }\r\n\r\n        } else if (s.instanceCount < 2) {\r\n\r\n            // HTML5 single-instance case\r\n\r\n            start_html5_timer();\r\n\r\n            a = s._setup_html5();\r\n\r\n            s.setPosition(s._iO.position);\r\n\r\n            a.play();\r\n\r\n          } else {\r\n\r\n            // HTML5 multi-shot case\r\n\r\n            sm2._wD(s.id + ': Cloning Audio() for instance #' + s.instanceCount + '...');\r\n\r\n            audioClone = new Audio(s._iO.url);\r\n\r\n            onended = function() {\r\n              event.remove(audioClone, 'ended', onended);\r\n              s._onfinish(s);\r\n              // cleanup\r\n              html5Unload(audioClone);\r\n              audioClone = null;\r\n            };\r\n\r\n            oncanplay = function() {\r\n              event.remove(audioClone, 'canplay', oncanplay);\r\n              try {\r\n                audioClone.currentTime = s._iO.position / msecScale;\r\n              } catch(err) {\r\n                complain(s.id + ': multiShot play() failed to apply position of ' + (s._iO.position / msecScale));\r\n              }\r\n              audioClone.play();\r\n            };\r\n\r\n            event.add(audioClone, 'ended', onended);\r\n\r\n            // apply volume to clones, too\r\n            if (s._iO.volume !== _undefined) {\r\n              audioClone.volume = Math.max(0, Math.min(1, s._iO.volume / 100));\r\n            }\r\n\r\n            // playing multiple muted sounds? if you do this, you're weird ;) - but let's cover it.\r\n            if (s.muted) {\r\n              audioClone.muted = true;\r\n            }\r\n\r\n            if (s._iO.position) {\r\n              // HTML5 audio can't seek before onplay() event has fired.\r\n              // wait for canplay, then seek to position and start playback.\r\n              event.add(audioClone, 'canplay', oncanplay);\r\n            } else {\r\n              // begin playback at currentTime: 0\r\n              audioClone.play();\r\n            }\r\n\r\n          }\r\n\r\n      }\r\n\r\n      return s;\r\n\r\n    };\r\n\r\n    // just for convenience\r\n    this.start = this.play;\r\n\r\n    /**\r\n     * Stops playing a sound (and optionally, all sounds)\r\n     *\r\n     * @param {boolean} bAll Optional: Whether to stop all sounds\r\n     * @return {SMSound} The SMSound object\r\n     */\r\n\r\n    this.stop = function(bAll) {\r\n\r\n      var instanceOptions = s._iO,\r\n          originalPosition;\r\n\r\n      if (s.playState === 1) {\r\n\r\n        sm2._wD(s.id + ': stop()');\r\n\r\n        s._onbufferchange(0);\r\n        s._resetOnPosition(0);\r\n        s.paused = false;\r\n\r\n        if (!s.isHTML5) {\r\n          s.playState = 0;\r\n        }\r\n\r\n        // remove onPosition listeners, if any\r\n        detachOnPosition();\r\n\r\n        // and \"to\" position, if set\r\n        if (instanceOptions.to) {\r\n          s.clearOnPosition(instanceOptions.to);\r\n        }\r\n\r\n        if (!s.isHTML5) {\r\n\r\n          flash._stop(s.id, bAll);\r\n\r\n          // hack for netStream: just unload\r\n          if (instanceOptions.serverURL) {\r\n            s.unload();\r\n          }\r\n\r\n        } else if (s._a) {\r\n\r\n            originalPosition = s.position;\r\n\r\n            // act like Flash, though\r\n            s.setPosition(0);\r\n\r\n            // hack: reflect old position for onstop() (also like Flash)\r\n            s.position = originalPosition;\r\n\r\n            // html5 has no stop()\r\n            // NOTE: pausing means iOS requires interaction to resume.\r\n            s._a.pause();\r\n\r\n            s.playState = 0;\r\n\r\n            // and update UI\r\n            s._onTimer();\r\n\r\n            stop_html5_timer();\r\n\r\n          }\r\n\r\n        s.instanceCount = 0;\r\n        s._iO = {};\r\n\r\n        if (instanceOptions.onstop) {\r\n          instanceOptions.onstop.apply(s);\r\n        }\r\n\r\n      }\r\n\r\n      return s;\r\n\r\n    };\r\n\r\n    /**\r\n     * Undocumented/internal: Sets autoPlay for RTMP.\r\n     *\r\n     * @param {boolean} autoPlay state\r\n     */\r\n\r\n    this.setAutoPlay = function(autoPlay) {\r\n\r\n      sm2._wD(s.id + ': Autoplay turned ' + (autoPlay ? 'on' : 'off'));\r\n      s._iO.autoPlay = autoPlay;\r\n\r\n      if (!s.isHTML5) {\r\n        flash._setAutoPlay(s.id, autoPlay);\r\n        if (autoPlay) {\r\n          // only increment the instanceCount if the sound isn't loaded (TODO: verify RTMP)\r\n          if (!s.instanceCount && s.readyState === 1) {\r\n            s.instanceCount++;\r\n            sm2._wD(s.id + ': Incremented instance count to ' + s.instanceCount);\r\n          }\r\n        }\r\n      }\r\n\r\n    };\r\n\r\n    /**\r\n     * Undocumented/internal: Returns the autoPlay boolean.\r\n     *\r\n     * @return {boolean} The current autoPlay value\r\n     */\r\n\r\n    this.getAutoPlay = function() {\r\n\r\n      return s._iO.autoPlay;\r\n\r\n    };\r\n\r\n    /**\r\n     * Sets the playback rate of a sound (HTML5-only.)\r\n     *\r\n     * @param {number} playbackRate (+/-)\r\n     * @return {SMSound} The SMSound object\r\n     */\r\n\r\n    this.setPlaybackRate = function(playbackRate) {\r\n\r\n      // Per Mozilla, limit acceptable values to prevent playback from stopping (unless allowOverride is truthy.)\r\n      // https://developer.mozilla.org/en-US/Apps/Build/Audio_and_video_delivery/WebAudio_playbackRate_explained\r\n      var normalizedRate = Math.max(0.5, Math.min(4, playbackRate));\r\n\r\n      // <d>\r\n      if (normalizedRate !== playbackRate) {\r\n        sm2._wD(s.id + ': setPlaybackRate(' + playbackRate + '): limiting rate to ' + normalizedRate, 2);\r\n      }\r\n      // </d>\r\n\r\n      if (s.isHTML5) {\r\n        try {\r\n          s._iO.playbackRate = normalizedRate;\r\n          s._a.playbackRate = normalizedRate;\r\n        } catch(e) {\r\n          sm2._wD(s.id + ': setPlaybackRate(' + normalizedRate + ') failed: ' + e.message, 2);\r\n        }\r\n      }\r\n\r\n      return s;\r\n\r\n    };\r\n\r\n    /**\r\n     * Sets the position of a sound.\r\n     *\r\n     * @param {number} nMsecOffset Position (milliseconds)\r\n     * @return {SMSound} The SMSound object\r\n     */\r\n\r\n    this.setPosition = function(nMsecOffset) {\r\n\r\n      if (nMsecOffset === _undefined) {\r\n        nMsecOffset = 0;\r\n      }\r\n\r\n      var position, position1K,\r\n          // Use the duration from the instance options, if we don't have a track duration yet.\r\n          // position >= 0 and <= current available (loaded) duration\r\n          offset = (s.isHTML5 ? Math.max(nMsecOffset, 0) : Math.min(s.duration || s._iO.duration, Math.max(nMsecOffset, 0)));\r\n\r\n      s.position = offset;\r\n      position1K = s.position / msecScale;\r\n      s._resetOnPosition(s.position);\r\n      s._iO.position = offset;\r\n\r\n      if (!s.isHTML5) {\r\n\r\n        position = (fV === 9 ? s.position : position1K);\r\n\r\n        if (s.readyState && s.readyState !== 2) {\r\n          // if paused or not playing, will not resume (by playing)\r\n          flash._setPosition(s.id, position, (s.paused || !s.playState), s._iO.multiShot);\r\n        }\r\n\r\n      } else if (s._a) {\r\n\r\n        // Set the position in the canplay handler if the sound is not ready yet\r\n        if (s._html5_canplay) {\r\n\r\n          if (s._a.currentTime.toFixed(3) !== position1K.toFixed(3)) {\r\n\r\n            /**\r\n             * DOM/JS errors/exceptions to watch out for:\r\n             * if seek is beyond (loaded?) position, \"DOM exception 11\"\r\n             * \"INDEX_SIZE_ERR\": DOM exception 1\r\n             */\r\n            sm2._wD(s.id + ': setPosition(' + position1K + ')');\r\n\r\n            try {\r\n              s._a.currentTime = position1K;\r\n              if (s.playState === 0 || s.paused) {\r\n                // allow seek without auto-play/resume\r\n                s._a.pause();\r\n              }\r\n            } catch(e) {\r\n              sm2._wD(s.id + ': setPosition(' + position1K + ') failed: ' + e.message, 2);\r\n            }\r\n\r\n          }\r\n\r\n        } else if (position1K) {\r\n\r\n          // warn on non-zero seek attempts\r\n          sm2._wD(s.id + ': setPosition(' + position1K + '): Cannot seek yet, sound not ready', 2);\r\n          return s;\r\n\r\n        }\r\n\r\n        if (s.paused) {\r\n\r\n          // if paused, refresh UI right away by forcing update\r\n          s._onTimer(true);\r\n\r\n        }\r\n\r\n      }\r\n\r\n      return s;\r\n\r\n    };\r\n\r\n    /**\r\n     * Pauses sound playback.\r\n     *\r\n     * @return {SMSound} The SMSound object\r\n     */\r\n\r\n    this.pause = function(_bCallFlash) {\r\n\r\n      if (s.paused || (s.playState === 0 && s.readyState !== 1)) return s;\r\n\r\n      sm2._wD(s.id + ': pause()');\r\n      s.paused = true;\r\n\r\n      if (!s.isHTML5) {\r\n        if (_bCallFlash || _bCallFlash === _undefined) {\r\n          flash._pause(s.id, s._iO.multiShot);\r\n        }\r\n      } else {\r\n        s._setup_html5().pause();\r\n        stop_html5_timer();\r\n      }\r\n\r\n      if (s._iO.onpause) {\r\n        s._iO.onpause.apply(s);\r\n      }\r\n\r\n      return s;\r\n\r\n    };\r\n\r\n    /**\r\n     * Resumes sound playback.\r\n     *\r\n     * @return {SMSound} The SMSound object\r\n     */\r\n\r\n    /**\r\n     * When auto-loaded streams pause on buffer full they have a playState of 0.\r\n     * We need to make sure that the playState is set to 1 when these streams \"resume\".\r\n     * When a paused stream is resumed, we need to trigger the onplay() callback if it\r\n     * hasn't been called already. In this case since the sound is being played for the\r\n     * first time, I think it's more appropriate to call onplay() rather than onresume().\r\n     */\r\n\r\n    this.resume = function() {\r\n\r\n      var instanceOptions = s._iO;\r\n\r\n      if (!s.paused) return s;\r\n\r\n      sm2._wD(s.id + ': resume()');\r\n      s.paused = false;\r\n      s.playState = 1;\r\n\r\n      if (!s.isHTML5) {\r\n\r\n        if (instanceOptions.isMovieStar && !instanceOptions.serverURL) {\r\n          // Bizarre Webkit bug (Chrome reported via 8tracks.com dudes): AAC content paused for 30+ seconds(?) will not resume without a reposition.\r\n          s.setPosition(s.position);\r\n        }\r\n\r\n        // flash method is toggle-based (pause/resume)\r\n        flash._pause(s.id, instanceOptions.multiShot);\r\n\r\n      } else {\r\n\r\n        s._setup_html5().play();\r\n        start_html5_timer();\r\n\r\n      }\r\n\r\n      if (!onplay_called && instanceOptions.onplay) {\r\n\r\n        instanceOptions.onplay.apply(s);\r\n        onplay_called = true;\r\n\r\n      } else if (instanceOptions.onresume) {\r\n\r\n        instanceOptions.onresume.apply(s);\r\n\r\n      }\r\n\r\n      return s;\r\n\r\n    };\r\n\r\n    /**\r\n     * Toggles sound playback.\r\n     *\r\n     * @return {SMSound} The SMSound object\r\n     */\r\n\r\n    this.togglePause = function() {\r\n\r\n      sm2._wD(s.id + ': togglePause()');\r\n\r\n      if (s.playState === 0) {\r\n        s.play({\r\n          position: (fV === 9 && !s.isHTML5 ? s.position : s.position / msecScale)\r\n        });\r\n        return s;\r\n      }\r\n\r\n      if (s.paused) {\r\n        s.resume();\r\n      } else {\r\n        s.pause();\r\n      }\r\n\r\n      return s;\r\n\r\n    };\r\n\r\n    /**\r\n     * Sets the panning (L-R) effect.\r\n     *\r\n     * @param {number} nPan The pan value (-100 to 100)\r\n     * @return {SMSound} The SMSound object\r\n     */\r\n\r\n    this.setPan = function(nPan, bInstanceOnly) {\r\n\r\n      if (nPan === _undefined) {\r\n        nPan = 0;\r\n      }\r\n\r\n      if (bInstanceOnly === _undefined) {\r\n        bInstanceOnly = false;\r\n      }\r\n\r\n      if (!s.isHTML5) {\r\n        flash._setPan(s.id, nPan);\r\n      } // else { no HTML5 pan? }\r\n\r\n      s._iO.pan = nPan;\r\n\r\n      if (!bInstanceOnly) {\r\n        s.pan = nPan;\r\n        s.options.pan = nPan;\r\n      }\r\n\r\n      return s;\r\n\r\n    };\r\n\r\n    /**\r\n     * Sets the volume.\r\n     *\r\n     * @param {number} nVol The volume value (0 to 100)\r\n     * @return {SMSound} The SMSound object\r\n     */\r\n\r\n    this.setVolume = function(nVol, _bInstanceOnly) {\r\n\r\n      /**\r\n       * Note: Setting volume has no effect on iOS \"special snowflake\" devices.\r\n       * Hardware volume control overrides software, and volume\r\n       * will always return 1 per Apple docs. (iOS 4 + 5.)\r\n       * http://developer.apple.com/library/safari/documentation/AudioVideo/Conceptual/HTML-canvas-guide/AddingSoundtoCanvasAnimations/AddingSoundtoCanvasAnimations.html\r\n       */\r\n\r\n      if (nVol === _undefined) {\r\n        nVol = 100;\r\n      }\r\n\r\n      if (_bInstanceOnly === _undefined) {\r\n        _bInstanceOnly = false;\r\n      }\r\n\r\n      if (!s.isHTML5) {\r\n\r\n        flash._setVolume(s.id, (sm2.muted && !s.muted) || s.muted ? 0 : nVol);\r\n\r\n      } else if (s._a) {\r\n\r\n        if (sm2.muted && !s.muted) {\r\n          s.muted = true;\r\n          s._a.muted = true;\r\n        }\r\n\r\n        // valid range for native HTML5 Audio(): 0-1\r\n        s._a.volume = Math.max(0, Math.min(1, nVol / 100));\r\n\r\n      }\r\n\r\n      s._iO.volume = nVol;\r\n\r\n      if (!_bInstanceOnly) {\r\n        s.volume = nVol;\r\n        s.options.volume = nVol;\r\n      }\r\n\r\n      return s;\r\n\r\n    };\r\n\r\n    /**\r\n     * Mutes the sound.\r\n     *\r\n     * @return {SMSound} The SMSound object\r\n     */\r\n\r\n    this.mute = function() {\r\n\r\n      s.muted = true;\r\n\r\n      if (!s.isHTML5) {\r\n        flash._setVolume(s.id, 0);\r\n      } else if (s._a) {\r\n        s._a.muted = true;\r\n      }\r\n\r\n      return s;\r\n\r\n    };\r\n\r\n    /**\r\n     * Unmutes the sound.\r\n     *\r\n     * @return {SMSound} The SMSound object\r\n     */\r\n\r\n    this.unmute = function() {\r\n\r\n      s.muted = false;\r\n      var hasIO = (s._iO.volume !== _undefined);\r\n\r\n      if (!s.isHTML5) {\r\n        flash._setVolume(s.id, hasIO ? s._iO.volume : s.options.volume);\r\n      } else if (s._a) {\r\n        s._a.muted = false;\r\n      }\r\n\r\n      return s;\r\n\r\n    };\r\n\r\n    /**\r\n     * Toggles the muted state of a sound.\r\n     *\r\n     * @return {SMSound} The SMSound object\r\n     */\r\n\r\n    this.toggleMute = function() {\r\n\r\n      return (s.muted ? s.unmute() : s.mute());\r\n\r\n    };\r\n\r\n    /**\r\n     * Registers a callback to be fired when a sound reaches a given position during playback.\r\n     *\r\n     * @param {number} nPosition The position to watch for\r\n     * @param {function} oMethod The relevant callback to fire\r\n     * @param {object} oScope Optional: The scope to apply the callback to\r\n     * @return {SMSound} The SMSound object\r\n     */\r\n\r\n    this.onPosition = function(nPosition, oMethod, oScope) {\r\n\r\n      // TODO: basic dupe checking?\r\n\r\n      onPositionItems.push({\r\n        position: parseInt(nPosition, 10),\r\n        method: oMethod,\r\n        scope: (oScope !== _undefined ? oScope : s),\r\n        fired: false\r\n      });\r\n\r\n      return s;\r\n\r\n    };\r\n\r\n    // legacy/backwards-compability: lower-case method name\r\n    this.onposition = this.onPosition;\r\n\r\n    /**\r\n     * Removes registered callback(s) from a sound, by position and/or callback.\r\n     *\r\n     * @param {number} nPosition The position to clear callback(s) for\r\n     * @param {function} oMethod Optional: Identify one callback to be removed when multiple listeners exist for one position\r\n     * @return {SMSound} The SMSound object\r\n     */\r\n\r\n    this.clearOnPosition = function(nPosition, oMethod) {\r\n\r\n      var i;\r\n\r\n      nPosition = parseInt(nPosition, 10);\r\n\r\n      if (isNaN(nPosition)) {\r\n        // safety check\r\n        return;\r\n      }\r\n\r\n      for (i = 0; i < onPositionItems.length; i++) {\r\n\r\n        if (nPosition === onPositionItems[i].position) {\r\n          // remove this item if no method was specified, or, if the method matches\r\n\r\n          if (!oMethod || (oMethod === onPositionItems[i].method)) {\r\n\r\n            if (onPositionItems[i].fired) {\r\n              // decrement \"fired\" counter, too\r\n              onPositionFired--;\r\n            }\r\n\r\n            onPositionItems.splice(i, 1);\r\n\r\n          }\r\n\r\n        }\r\n\r\n      }\r\n\r\n    };\r\n\r\n    this._processOnPosition = function() {\r\n\r\n      var i, item, j = onPositionItems.length;\r\n\r\n      if (!j || !s.playState || onPositionFired >= j) return false;\r\n\r\n      for (i = j - 1; i >= 0; i--) {\r\n\r\n        item = onPositionItems[i];\r\n\r\n        if (!item.fired && s.position >= item.position) {\r\n\r\n          item.fired = true;\r\n          onPositionFired++;\r\n          item.method.apply(item.scope, [item.position]);\r\n\r\n          //  reset j -- onPositionItems.length can be changed in the item callback above... occasionally breaking the loop.\r\n          j = onPositionItems.length;\r\n\r\n        }\r\n\r\n      }\r\n\r\n      return true;\r\n\r\n    };\r\n\r\n    this._resetOnPosition = function(nPosition) {\r\n\r\n      // reset \"fired\" for items interested in this position\r\n      var i, item, j = onPositionItems.length;\r\n\r\n      if (!j) return false;\r\n\r\n      for (i = j - 1; i >= 0; i--) {\r\n\r\n        item = onPositionItems[i];\r\n\r\n        if (item.fired && nPosition <= item.position) {\r\n          item.fired = false;\r\n          onPositionFired--;\r\n        }\r\n\r\n      }\r\n\r\n      return true;\r\n\r\n    };\r\n\r\n    /**\r\n     * SMSound() private internals\r\n     * --------------------------------\r\n     */\r\n\r\n    applyFromTo = function() {\r\n\r\n      var instanceOptions = s._iO,\r\n          f = instanceOptions.from,\r\n          t = instanceOptions.to,\r\n          start, end;\r\n\r\n      end = function() {\r\n\r\n        // end has been reached.\r\n        sm2._wD(s.id + ': \"To\" time of ' + t + ' reached.');\r\n\r\n        // detach listener\r\n        s.clearOnPosition(t, end);\r\n\r\n        // stop should clear this, too\r\n        s.stop();\r\n\r\n      };\r\n\r\n      start = function() {\r\n\r\n        sm2._wD(s.id + ': Playing \"from\" ' + f);\r\n\r\n        // add listener for end\r\n        if (t !== null && !isNaN(t)) {\r\n          s.onPosition(t, end);\r\n        }\r\n\r\n      };\r\n\r\n      if (f !== null && !isNaN(f)) {\r\n\r\n        // apply to instance options, guaranteeing correct start position.\r\n        instanceOptions.position = f;\r\n\r\n        // multiShot timing can't be tracked, so prevent that.\r\n        instanceOptions.multiShot = false;\r\n\r\n        start();\r\n\r\n      }\r\n\r\n      // return updated instanceOptions including starting position\r\n      return instanceOptions;\r\n\r\n    };\r\n\r\n    attachOnPosition = function() {\r\n\r\n      var item,\r\n          op = s._iO.onposition;\r\n\r\n      // attach onposition things, if any, now.\r\n\r\n      if (op) {\r\n\r\n        for (item in op) {\r\n          if (op.hasOwnProperty(item)) {\r\n            s.onPosition(parseInt(item, 10), op[item]);\r\n          }\r\n        }\r\n\r\n      }\r\n\r\n    };\r\n\r\n    detachOnPosition = function() {\r\n\r\n      var item,\r\n          op = s._iO.onposition;\r\n\r\n      // detach any onposition()-style listeners.\r\n\r\n      if (op) {\r\n\r\n        for (item in op) {\r\n          if (op.hasOwnProperty(item)) {\r\n            s.clearOnPosition(parseInt(item, 10));\r\n          }\r\n        }\r\n\r\n      }\r\n\r\n    };\r\n\r\n    start_html5_timer = function() {\r\n\r\n      if (s.isHTML5) {\r\n        startTimer(s);\r\n      }\r\n\r\n    };\r\n\r\n    stop_html5_timer = function() {\r\n\r\n      if (s.isHTML5) {\r\n        stopTimer(s);\r\n      }\r\n\r\n    };\r\n\r\n    resetProperties = function(retainPosition) {\r\n\r\n      if (!retainPosition) {\r\n        onPositionItems = [];\r\n        onPositionFired = 0;\r\n      }\r\n\r\n      onplay_called = false;\r\n\r\n      s._hasTimer = null;\r\n      s._a = null;\r\n      s._html5_canplay = false;\r\n      s.bytesLoaded = null;\r\n      s.bytesTotal = null;\r\n      s.duration = (s._iO && s._iO.duration ? s._iO.duration : null);\r\n      s.durationEstimate = null;\r\n      s.buffered = [];\r\n\r\n      // legacy: 1D array\r\n      s.eqData = [];\r\n\r\n      s.eqData.left = [];\r\n      s.eqData.right = [];\r\n\r\n      s.failures = 0;\r\n      s.isBuffering = false;\r\n      s.instanceOptions = {};\r\n      s.instanceCount = 0;\r\n      s.loaded = false;\r\n      s.metadata = {};\r\n\r\n      // 0 = uninitialised, 1 = loading, 2 = failed/error, 3 = loaded/success\r\n      s.readyState = 0;\r\n\r\n      s.muted = false;\r\n      s.paused = false;\r\n\r\n      s.peakData = {\r\n        left: 0,\r\n        right: 0\r\n      };\r\n\r\n      s.waveformData = {\r\n        left: [],\r\n        right: []\r\n      };\r\n\r\n      s.playState = 0;\r\n      s.position = null;\r\n\r\n      s.id3 = {};\r\n\r\n    };\r\n\r\n    resetProperties();\r\n\r\n    /**\r\n     * Pseudo-private SMSound internals\r\n     * --------------------------------\r\n     */\r\n\r\n    this._onTimer = function(bForce) {\r\n\r\n      /**\r\n       * HTML5-only _whileplaying() etc.\r\n       * called from both HTML5 native events, and polling/interval-based timers\r\n       * mimics flash and fires only when time/duration change, so as to be polling-friendly\r\n       */\r\n\r\n      var duration, isNew = false, time, x = {};\r\n\r\n      if (s._hasTimer || bForce) {\r\n\r\n        // TODO: May not need to track readyState (1 = loading)\r\n\r\n        if (s._a && (bForce || ((s.playState > 0 || s.readyState === 1) && !s.paused))) {\r\n\r\n          duration = s._get_html5_duration();\r\n\r\n          if (duration !== lastHTML5State.duration) {\r\n\r\n            lastHTML5State.duration = duration;\r\n            s.duration = duration;\r\n            isNew = true;\r\n\r\n          }\r\n\r\n          // TODO: investigate why this goes wack if not set/re-set each time.\r\n          s.durationEstimate = s.duration;\r\n\r\n          time = (s._a.currentTime * msecScale || 0);\r\n\r\n          if (time !== lastHTML5State.time) {\r\n\r\n            lastHTML5State.time = time;\r\n            isNew = true;\r\n\r\n          }\r\n\r\n          if (isNew || bForce) {\r\n\r\n            s._whileplaying(time, x, x, x, x);\r\n\r\n          }\r\n\r\n        }/* else {\r\n\r\n          // sm2._wD('_onTimer: Warn for \"'+s.id+'\": '+(!s._a?'Could not find element. ':'')+(s.playState === 0?'playState bad, 0?':'playState = '+s.playState+', OK'));\r\n\r\n          return false;\r\n\r\n        }*/\r\n\r\n      }\r\n\r\n      return isNew;\r\n\r\n    };\r\n\r\n    this._get_html5_duration = function() {\r\n\r\n      var instanceOptions = s._iO,\r\n          // if audio object exists, use its duration - else, instance option duration (if provided - it's a hack, really, and should be retired) OR null\r\n          d = (s._a && s._a.duration ? s._a.duration * msecScale : (instanceOptions && instanceOptions.duration ? instanceOptions.duration : null)),\r\n          result = (d && !isNaN(d) && d !== Infinity ? d : null);\r\n\r\n      return result;\r\n\r\n    };\r\n\r\n    this._apply_loop = function(a, nLoops) {\r\n\r\n      /**\r\n       * boolean instead of \"loop\", for webkit? - spec says string. http://www.w3.org/TR/html-markup/audio.html#audio.attrs.loop\r\n       * note that loop is either off or infinite under HTML5, unlike Flash which allows arbitrary loop counts to be specified.\r\n       */\r\n\r\n      // <d>\r\n      if (!a.loop && nLoops > 1) {\r\n        sm2._wD('Note: Native HTML5 looping is infinite.', 1);\r\n      }\r\n      // </d>\r\n\r\n      a.loop = (nLoops > 1 ? 'loop' : '');\r\n\r\n    };\r\n\r\n    this._setup_html5 = function(options) {\r\n\r\n      var instanceOptions = mixin(s._iO, options),\r\n          a = useGlobalHTML5Audio ? globalHTML5Audio : s._a,\r\n          dURL = decodeURI(instanceOptions.url),\r\n          sameURL;\r\n\r\n      /**\r\n       * \"First things first, I, Poppa...\" (reset the previous state of the old sound, if playing)\r\n       * Fixes case with devices that can only play one sound at a time\r\n       * Otherwise, other sounds in mid-play will be terminated without warning and in a stuck state\r\n       */\r\n\r\n      if (useGlobalHTML5Audio) {\r\n\r\n        if (dURL === decodeURI(lastGlobalHTML5URL)) {\r\n          // global HTML5 audio: re-use of URL\r\n          sameURL = true;\r\n        }\r\n\r\n      } else if (dURL === decodeURI(lastURL)) {\r\n\r\n        // options URL is the same as the \"last\" URL, and we used (loaded) it\r\n        sameURL = true;\r\n\r\n      }\r\n\r\n      if (a) {\r\n\r\n        if (a._s) {\r\n\r\n          if (useGlobalHTML5Audio) {\r\n\r\n            if (a._s && a._s.playState && !sameURL) {\r\n\r\n              // global HTML5 audio case, and loading a new URL. stop the currently-playing one.\r\n              a._s.stop();\r\n\r\n            }\r\n\r\n          } else if (!useGlobalHTML5Audio && dURL === decodeURI(lastURL)) {\r\n\r\n            // non-global HTML5 reuse case: same url, ignore request\r\n            s._apply_loop(a, instanceOptions.loops);\r\n\r\n            return a;\r\n\r\n          }\r\n\r\n        }\r\n\r\n        if (!sameURL) {\r\n\r\n          // don't retain onPosition() stuff with new URLs.\r\n\r\n          if (lastURL) {\r\n            resetProperties(false);\r\n          }\r\n\r\n          // assign new HTML5 URL\r\n\r\n          a.src = instanceOptions.url;\r\n\r\n          s.url = instanceOptions.url;\r\n\r\n          lastURL = instanceOptions.url;\r\n\r\n          lastGlobalHTML5URL = instanceOptions.url;\r\n\r\n          a._called_load = false;\r\n\r\n        }\r\n\r\n      } else {\r\n\r\n        if (instanceOptions.autoLoad || instanceOptions.autoPlay) {\r\n\r\n          s._a = new Audio(instanceOptions.url);\r\n          s._a.load();\r\n\r\n        } else {\r\n\r\n          // null for stupid Opera 9.64 case\r\n          s._a = (isOpera && opera.version() < 10 ? new Audio(null) : new Audio());\r\n\r\n        }\r\n\r\n        // assign local reference\r\n        a = s._a;\r\n\r\n        a._called_load = false;\r\n\r\n        if (useGlobalHTML5Audio) {\r\n\r\n          globalHTML5Audio = a;\r\n\r\n        }\r\n\r\n      }\r\n\r\n      s.isHTML5 = true;\r\n\r\n      // store a ref on the track\r\n      s._a = a;\r\n\r\n      // store a ref on the audio\r\n      a._s = s;\r\n\r\n      add_html5_events();\r\n\r\n      s._apply_loop(a, instanceOptions.loops);\r\n\r\n      if (instanceOptions.autoLoad || instanceOptions.autoPlay) {\r\n\r\n        s.load();\r\n\r\n      } else {\r\n\r\n        // early HTML5 implementation (non-standard)\r\n        a.autobuffer = false;\r\n\r\n        // standard ('none' is also an option.)\r\n        a.preload = 'auto';\r\n\r\n      }\r\n\r\n      return a;\r\n\r\n    };\r\n\r\n    add_html5_events = function() {\r\n\r\n      if (s._a._added_events) return false;\r\n\r\n      var f;\r\n\r\n      function add(oEvt, oFn, bCapture) {\r\n        return s._a ? s._a.addEventListener(oEvt, oFn, bCapture || false) : null;\r\n      }\r\n\r\n      s._a._added_events = true;\r\n\r\n      for (f in html5_events) {\r\n        if (html5_events.hasOwnProperty(f)) {\r\n          add(f, html5_events[f]);\r\n        }\r\n      }\r\n\r\n      return true;\r\n\r\n    };\r\n\r\n    remove_html5_events = function() {\r\n\r\n      // Remove event listeners\r\n\r\n      var f;\r\n\r\n      function remove(oEvt, oFn, bCapture) {\r\n        return (s._a ? s._a.removeEventListener(oEvt, oFn, bCapture || false) : null);\r\n      }\r\n\r\n      sm2._wD(s.id + ': Removing event listeners');\r\n      s._a._added_events = false;\r\n\r\n      for (f in html5_events) {\r\n        if (html5_events.hasOwnProperty(f)) {\r\n          remove(f, html5_events[f]);\r\n        }\r\n      }\r\n\r\n    };\r\n\r\n    /**\r\n     * Pseudo-private event internals\r\n     * ------------------------------\r\n     */\r\n\r\n    this._onload = function(nSuccess) {\r\n\r\n      var fN,\r\n          // check for duration to prevent false positives from flash 8 when loading from cache.\r\n          loadOK = !!nSuccess || (!s.isHTML5 && fV === 8 && s.duration);\r\n\r\n      // <d>\r\n      fN = s.id + ': ';\r\n      sm2._wD(fN + (loadOK ? 'onload()' : 'Failed to load / invalid sound?' + (!s.duration ? ' Zero-length duration reported.' : ' -') + ' (' + s.url + ')'), (loadOK ? 1 : 2));\r\n\r\n      if (!loadOK && !s.isHTML5) {\r\n        if (sm2.sandbox.noRemote === true) {\r\n          sm2._wD(fN + str('noNet'), 1);\r\n        }\r\n        if (sm2.sandbox.noLocal === true) {\r\n          sm2._wD(fN + str('noLocal'), 1);\r\n        }\r\n      }\r\n      // </d>\r\n\r\n      s.loaded = loadOK;\r\n      s.readyState = (loadOK ? 3 : 2);\r\n      s._onbufferchange(0);\r\n\r\n      if (!loadOK && !s.isHTML5) {\r\n        // note: no error code from Flash.\r\n        s._onerror();\r\n      }\r\n\r\n      if (s._iO.onload) {\r\n        wrapCallback(s, function() {\r\n          s._iO.onload.apply(s, [loadOK]);\r\n        });\r\n      }\r\n\r\n      return true;\r\n\r\n    };\r\n\r\n    this._onerror = function(errorCode, description) {\r\n\r\n      // https://html.spec.whatwg.org/multipage/embedded-content.html#error-codes\r\n      if (s._iO.onerror) {\r\n        wrapCallback(s, function() {\r\n          s._iO.onerror.apply(s, [errorCode, description]);\r\n        });\r\n      }\r\n\r\n    };\r\n\r\n    this._onbufferchange = function(nIsBuffering) {\r\n\r\n      // ignore if not playing\r\n      if (s.playState === 0) return false;\r\n\r\n      if ((nIsBuffering && s.isBuffering) || (!nIsBuffering && !s.isBuffering)) return false;\r\n\r\n      s.isBuffering = (nIsBuffering === 1);\r\n\r\n      if (s._iO.onbufferchange) {\r\n        sm2._wD(s.id + ': Buffer state change: ' + nIsBuffering);\r\n        s._iO.onbufferchange.apply(s, [nIsBuffering]);\r\n      }\r\n\r\n      return true;\r\n\r\n    };\r\n\r\n    /**\r\n     * Playback may have stopped due to buffering, or related reason.\r\n     * This state can be encountered on iOS < 6 when auto-play is blocked.\r\n     */\r\n\r\n    this._onsuspend = function() {\r\n\r\n      if (s._iO.onsuspend) {\r\n        sm2._wD(s.id + ': Playback suspended');\r\n        s._iO.onsuspend.apply(s);\r\n      }\r\n\r\n      return true;\r\n\r\n    };\r\n\r\n    /**\r\n     * flash 9/movieStar + RTMP-only method, should fire only once at most\r\n     * at this point we just recreate failed sounds rather than trying to reconnect\r\n     */\r\n\r\n    this._onfailure = function(msg, level, code) {\r\n\r\n      s.failures++;\r\n      sm2._wD(s.id + ': Failure (' + s.failures + '): ' + msg);\r\n\r\n      if (s._iO.onfailure && s.failures === 1) {\r\n        s._iO.onfailure(msg, level, code);\r\n      } else {\r\n        sm2._wD(s.id + ': Ignoring failure');\r\n      }\r\n\r\n    };\r\n\r\n    /**\r\n     * flash 9/movieStar + RTMP-only method for unhandled warnings/exceptions from Flash\r\n     * e.g., RTMP \"method missing\" warning (non-fatal) for getStreamLength on server\r\n     */\r\n\r\n    this._onwarning = function(msg, level, code) {\r\n\r\n      if (s._iO.onwarning) {\r\n        s._iO.onwarning(msg, level, code);\r\n      }\r\n\r\n    };\r\n\r\n    this._onfinish = function() {\r\n\r\n      // store local copy before it gets trashed...\r\n      var io_onfinish = s._iO.onfinish;\r\n\r\n      s._onbufferchange(0);\r\n      s._resetOnPosition(0);\r\n\r\n      // reset some state items\r\n      if (s.instanceCount) {\r\n\r\n        s.instanceCount--;\r\n\r\n        if (!s.instanceCount) {\r\n\r\n          // remove onPosition listeners, if any\r\n          detachOnPosition();\r\n\r\n          // reset instance options\r\n          s.playState = 0;\r\n          s.paused = false;\r\n          s.instanceCount = 0;\r\n          s.instanceOptions = {};\r\n          s._iO = {};\r\n          stop_html5_timer();\r\n\r\n          // reset position, too\r\n          if (s.isHTML5) {\r\n            s.position = 0;\r\n          }\r\n\r\n        }\r\n\r\n        if (!s.instanceCount || s._iO.multiShotEvents) {\r\n          // fire onfinish for last, or every instance\r\n          if (io_onfinish) {\r\n            sm2._wD(s.id + ': onfinish()');\r\n            wrapCallback(s, function() {\r\n              io_onfinish.apply(s);\r\n            });\r\n          }\r\n        }\r\n\r\n      }\r\n\r\n    };\r\n\r\n    this._whileloading = function(nBytesLoaded, nBytesTotal, nDuration, nBufferLength) {\r\n\r\n      var instanceOptions = s._iO;\r\n\r\n      s.bytesLoaded = nBytesLoaded;\r\n      s.bytesTotal = nBytesTotal;\r\n      s.duration = Math.floor(nDuration);\r\n      s.bufferLength = nBufferLength;\r\n\r\n      if (!s.isHTML5 && !instanceOptions.isMovieStar) {\r\n\r\n        if (instanceOptions.duration) {\r\n          // use duration from options, if specified and larger. nobody should be specifying duration in options, actually, and it should be retired.\r\n          s.durationEstimate = (s.duration > instanceOptions.duration) ? s.duration : instanceOptions.duration;\r\n        } else {\r\n          s.durationEstimate = parseInt((s.bytesTotal / s.bytesLoaded) * s.duration, 10);\r\n        }\r\n\r\n      } else {\r\n\r\n        s.durationEstimate = s.duration;\r\n\r\n      }\r\n\r\n      // for flash, reflect sequential-load-style buffering\r\n      if (!s.isHTML5) {\r\n        s.buffered = [{\r\n          start: 0,\r\n          end: s.duration\r\n        }];\r\n      }\r\n\r\n      // allow whileloading to fire even if \"load\" fired under HTML5, due to HTTP range/partials\r\n      if ((s.readyState !== 3 || s.isHTML5) && instanceOptions.whileloading) {\r\n        instanceOptions.whileloading.apply(s);\r\n      }\r\n\r\n    };\r\n\r\n    this._whileplaying = function(nPosition, oPeakData, oWaveformDataLeft, oWaveformDataRight, oEQData) {\r\n\r\n      var instanceOptions = s._iO,\r\n          eqLeft;\r\n\r\n      // flash safety net\r\n      if (isNaN(nPosition) || nPosition === null) return false;\r\n\r\n      // Safari HTML5 play() may return small -ve values when starting from position: 0, eg. -50.120396875. Unexpected/invalid per W3, I think. Normalize to 0.\r\n      s.position = Math.max(0, nPosition);\r\n\r\n      s._processOnPosition();\r\n\r\n      if (!s.isHTML5 && fV > 8) {\r\n\r\n        if (instanceOptions.usePeakData && oPeakData !== _undefined && oPeakData) {\r\n          s.peakData = {\r\n            left: oPeakData.leftPeak,\r\n            right: oPeakData.rightPeak\r\n          };\r\n        }\r\n\r\n        if (instanceOptions.useWaveformData && oWaveformDataLeft !== _undefined && oWaveformDataLeft) {\r\n          s.waveformData = {\r\n            left: oWaveformDataLeft.split(','),\r\n            right: oWaveformDataRight.split(',')\r\n          };\r\n        }\r\n\r\n        if (instanceOptions.useEQData) {\r\n          if (oEQData !== _undefined && oEQData && oEQData.leftEQ) {\r\n            eqLeft = oEQData.leftEQ.split(',');\r\n            s.eqData = eqLeft;\r\n            s.eqData.left = eqLeft;\r\n            if (oEQData.rightEQ !== _undefined && oEQData.rightEQ) {\r\n              s.eqData.right = oEQData.rightEQ.split(',');\r\n            }\r\n          }\r\n        }\r\n\r\n      }\r\n\r\n      if (s.playState === 1) {\r\n\r\n        // special case/hack: ensure buffering is false if loading from cache (and not yet started)\r\n        if (!s.isHTML5 && fV === 8 && !s.position && s.isBuffering) {\r\n          s._onbufferchange(0);\r\n        }\r\n\r\n        if (instanceOptions.whileplaying) {\r\n          // flash may call after actual finish\r\n          instanceOptions.whileplaying.apply(s);\r\n        }\r\n\r\n      }\r\n\r\n      return true;\r\n\r\n    };\r\n\r\n    this._oncaptiondata = function(oData) {\r\n\r\n      /**\r\n       * internal: flash 9 + NetStream (MovieStar/RTMP-only) feature\r\n       *\r\n       * @param {object} oData\r\n       */\r\n\r\n      sm2._wD(s.id + ': Caption data received.');\r\n\r\n      s.captiondata = oData;\r\n\r\n      if (s._iO.oncaptiondata) {\r\n        s._iO.oncaptiondata.apply(s, [oData]);\r\n      }\r\n\r\n    };\r\n\r\n    this._onmetadata = function(oMDProps, oMDData) {\r\n\r\n      /**\r\n       * internal: flash 9 + NetStream (MovieStar/RTMP-only) feature\r\n       * RTMP may include song title, MovieStar content may include encoding info\r\n       *\r\n       * @param {array} oMDProps (names)\r\n       * @param {array} oMDData (values)\r\n       */\r\n\r\n      sm2._wD(s.id + ': Metadata received.');\r\n\r\n      var oData = {}, i, j;\r\n\r\n      for (i = 0, j = oMDProps.length; i < j; i++) {\r\n        oData[oMDProps[i]] = oMDData[i];\r\n      }\r\n\r\n      s.metadata = oData;\r\n\r\n      if (s._iO.onmetadata) {\r\n        s._iO.onmetadata.call(s, s.metadata);\r\n      }\r\n\r\n    };\r\n\r\n    this._onid3 = function(oID3Props, oID3Data) {\r\n\r\n      /**\r\n       * internal: flash 8 + flash 9 ID3 feature\r\n       * may include artist, song title etc.\r\n       *\r\n       * @param {array} oID3Props (names)\r\n       * @param {array} oID3Data (values)\r\n       */\r\n\r\n      sm2._wD(s.id + ': ID3 data received.');\r\n\r\n      var oData = [], i, j;\r\n\r\n      for (i = 0, j = oID3Props.length; i < j; i++) {\r\n        oData[oID3Props[i]] = oID3Data[i];\r\n      }\r\n\r\n      s.id3 = mixin(s.id3, oData);\r\n\r\n      if (s._iO.onid3) {\r\n        s._iO.onid3.apply(s);\r\n      }\r\n\r\n    };\r\n\r\n    // flash/RTMP-only\r\n\r\n    this._onconnect = function(bSuccess) {\r\n\r\n      bSuccess = (bSuccess === 1);\r\n      sm2._wD(s.id + ': ' + (bSuccess ? 'Connected.' : 'Failed to connect? - ' + s.url), (bSuccess ? 1 : 2));\r\n      s.connected = bSuccess;\r\n\r\n      if (bSuccess) {\r\n\r\n        s.failures = 0;\r\n\r\n        if (idCheck(s.id)) {\r\n          if (s.getAutoPlay()) {\r\n            // only update the play state if auto playing\r\n            s.play(_undefined, s.getAutoPlay());\r\n          } else if (s._iO.autoLoad) {\r\n            s.load();\r\n          }\r\n        }\r\n\r\n        if (s._iO.onconnect) {\r\n          s._iO.onconnect.apply(s, [bSuccess]);\r\n        }\r\n\r\n      }\r\n\r\n    };\r\n\r\n    this._ondataerror = function(sError) {\r\n\r\n      // flash 9 wave/eq data handler\r\n      // hack: called at start, and end from flash at/after onfinish()\r\n      if (s.playState > 0) {\r\n        sm2._wD(s.id + ': Data error: ' + sError);\r\n        if (s._iO.ondataerror) {\r\n          s._iO.ondataerror.apply(s);\r\n        }\r\n      }\r\n\r\n    };\r\n\r\n    // <d>\r\n    this._debug();\r\n    // </d>\r\n\r\n  }; // SMSound()\r\n\r\n  /**\r\n   * Private SoundManager internals\r\n   * ------------------------------\r\n   */\r\n\r\n  getDocument = function() {\r\n\r\n    return (doc.body || doc.getElementsByTagName('div')[0]);\r\n\r\n  };\r\n\r\n  id = function(sID) {\r\n\r\n    return doc.getElementById(sID);\r\n\r\n  };\r\n\r\n  mixin = function(oMain, oAdd) {\r\n\r\n    // non-destructive merge\r\n    var o1 = (oMain || {}), o2, o;\r\n\r\n    // if unspecified, o2 is the default options object\r\n    o2 = (oAdd === _undefined ? sm2.defaultOptions : oAdd);\r\n\r\n    for (o in o2) {\r\n\r\n      if (o2.hasOwnProperty(o) && o1[o] === _undefined) {\r\n\r\n        if (typeof o2[o] !== 'object' || o2[o] === null) {\r\n\r\n          // assign directly\r\n          o1[o] = o2[o];\r\n\r\n        } else {\r\n\r\n          // recurse through o2\r\n          o1[o] = mixin(o1[o], o2[o]);\r\n\r\n        }\r\n\r\n      }\r\n\r\n    }\r\n\r\n    return o1;\r\n\r\n  };\r\n\r\n  wrapCallback = function(oSound, callback) {\r\n\r\n    /**\r\n     * 03/03/2013: Fix for Flash Player 11.6.602.171 + Flash 8 (flashVersion = 8) SWF issue\r\n     * setTimeout() fix for certain SMSound callbacks like onload() and onfinish(), where subsequent calls like play() and load() fail when Flash Player 11.6.602.171 is installed, and using soundManager with flashVersion = 8 (which is the default).\r\n     * Not sure of exact cause. Suspect race condition and/or invalid (NaN-style) position argument trickling down to the next JS -> Flash _start() call, in the play() case.\r\n     * Fix: setTimeout() to yield, plus safer null / NaN checking on position argument provided to Flash.\r\n     * https://getsatisfaction.com/schillmania/topics/recent_chrome_update_seems_to_have_broken_my_sm2_audio_player\r\n     */\r\n    if (!oSound.isHTML5 && fV === 8) {\r\n      window.setTimeout(callback, 0);\r\n    } else {\r\n      callback();\r\n    }\r\n\r\n  };\r\n\r\n  // additional soundManager properties that soundManager.setup() will accept\r\n\r\n  extraOptions = {\r\n    onready: 1,\r\n    ontimeout: 1,\r\n    defaultOptions: 1,\r\n    flash9Options: 1,\r\n    movieStarOptions: 1\r\n  };\r\n\r\n  assign = function(o, oParent) {\r\n\r\n    /**\r\n     * recursive assignment of properties, soundManager.setup() helper\r\n     * allows property assignment based on whitelist\r\n     */\r\n\r\n    var i,\r\n        result = true,\r\n        hasParent = (oParent !== _undefined),\r\n        setupOptions = sm2.setupOptions,\r\n        bonusOptions = extraOptions;\r\n\r\n    // <d>\r\n\r\n    // if soundManager.setup() called, show accepted parameters.\r\n\r\n    if (o === _undefined) {\r\n\r\n      result = [];\r\n\r\n      for (i in setupOptions) {\r\n\r\n        if (setupOptions.hasOwnProperty(i)) {\r\n          result.push(i);\r\n        }\r\n\r\n      }\r\n\r\n      for (i in bonusOptions) {\r\n\r\n        if (bonusOptions.hasOwnProperty(i)) {\r\n\r\n          if (typeof sm2[i] === 'object') {\r\n            result.push(i + ': {...}');\r\n          } else if (sm2[i] instanceof Function) {\r\n            result.push(i + ': function() {...}');\r\n          } else {\r\n            result.push(i);\r\n          }\r\n\r\n        }\r\n\r\n      }\r\n\r\n      sm2._wD(str('setup', result.join(', ')));\r\n\r\n      return false;\r\n\r\n    }\r\n\r\n    // </d>\r\n\r\n    for (i in o) {\r\n\r\n      if (o.hasOwnProperty(i)) {\r\n\r\n        // if not an {object} we want to recurse through...\r\n\r\n        if (typeof o[i] !== 'object' || o[i] === null || o[i] instanceof Array || o[i] instanceof RegExp) {\r\n\r\n          // check \"allowed\" options\r\n\r\n          if (hasParent && bonusOptions[oParent] !== _undefined) {\r\n\r\n            // valid recursive / nested object option, eg., { defaultOptions: { volume: 50 } }\r\n            sm2[oParent][i] = o[i];\r\n\r\n          } else if (setupOptions[i] !== _undefined) {\r\n\r\n            // special case: assign to setupOptions object, which soundManager property references\r\n            sm2.setupOptions[i] = o[i];\r\n\r\n            // assign directly to soundManager, too\r\n            sm2[i] = o[i];\r\n\r\n          } else if (bonusOptions[i] === _undefined) {\r\n\r\n            // invalid or disallowed parameter. complain.\r\n            complain(str((sm2[i] === _undefined ? 'setupUndef' : 'setupError'), i), 2);\r\n\r\n            result = false;\r\n\r\n          } else if (sm2[i] instanceof Function) {\r\n\r\n            /**\r\n             * valid extraOptions (bonusOptions) parameter.\r\n             * is it a method, like onready/ontimeout? call it.\r\n             * multiple parameters should be in an array, eg. soundManager.setup({onready: [myHandler, myScope]});\r\n             */\r\n            sm2[i].apply(sm2, (o[i] instanceof Array ? o[i] : [o[i]]));\r\n\r\n          } else {\r\n\r\n            // good old-fashioned direct assignment\r\n            sm2[i] = o[i];\r\n\r\n          }\r\n\r\n        } else if (bonusOptions[i] === _undefined) {\r\n\r\n          // recursion case, eg., { defaultOptions: { ... } }\r\n\r\n          // invalid or disallowed parameter. complain.\r\n          complain(str((sm2[i] === _undefined ? 'setupUndef' : 'setupError'), i), 2);\r\n\r\n          result = false;\r\n\r\n        } else {\r\n\r\n          // recurse through object\r\n          return assign(o[i], i);\r\n\r\n        }\r\n\r\n      }\r\n\r\n    }\r\n\r\n    return result;\r\n\r\n  };\r\n\r\n  function preferFlashCheck(kind) {\r\n\r\n    // whether flash should play a given type\r\n    return (sm2.preferFlash && hasFlash && !sm2.ignoreFlash && (sm2.flash[kind] !== _undefined && sm2.flash[kind]));\r\n\r\n  }\r\n\r\n  /**\r\n   * Internal DOM2-level event helpers\r\n   * ---------------------------------\r\n   */\r\n\r\n  event = (function() {\r\n\r\n    // normalize event methods\r\n    var old = (window.attachEvent),\r\n    evt = {\r\n      add: (old ? 'attachEvent' : 'addEventListener'),\r\n      remove: (old ? 'detachEvent' : 'removeEventListener')\r\n    };\r\n\r\n    // normalize \"on\" event prefix, optional capture argument\r\n    function getArgs(oArgs) {\r\n\r\n      var args = slice.call(oArgs),\r\n          len = args.length;\r\n\r\n      if (old) {\r\n        // prefix\r\n        args[1] = 'on' + args[1];\r\n        if (len > 3) {\r\n          // no capture\r\n          args.pop();\r\n        }\r\n      } else if (len === 3) {\r\n        args.push(false);\r\n      }\r\n\r\n      return args;\r\n\r\n    }\r\n\r\n    function apply(args, sType) {\r\n\r\n      // normalize and call the event method, with the proper arguments\r\n      var element = args.shift(),\r\n          method = [evt[sType]];\r\n\r\n      if (old) {\r\n        // old IE can't do apply().\r\n        element[method](args[0], args[1]);\r\n      } else {\r\n        element[method].apply(element, args);\r\n      }\r\n\r\n    }\r\n\r\n    function add() {\r\n      apply(getArgs(arguments), 'add');\r\n    }\r\n\r\n    function remove() {\r\n      apply(getArgs(arguments), 'remove');\r\n    }\r\n\r\n    return {\r\n      add: add,\r\n      remove: remove\r\n    };\r\n\r\n  }());\r\n\r\n  /**\r\n   * Internal HTML5 event handling\r\n   * -----------------------------\r\n   */\r\n\r\n  function html5_event(oFn) {\r\n\r\n    // wrap html5 event handlers so we don't call them on destroyed and/or unloaded sounds\r\n\r\n    return function(e) {\r\n\r\n      var s = this._s,\r\n          result;\r\n\r\n      if (!s || !s._a) {\r\n        // <d>\r\n        if (s && s.id) {\r\n          sm2._wD(s.id + ': Ignoring ' + e.type);\r\n        } else {\r\n          sm2._wD(h5 + 'Ignoring ' + e.type);\r\n        }\r\n        // </d>\r\n        result = null;\r\n      } else {\r\n        result = oFn.call(this, e);\r\n      }\r\n\r\n      return result;\r\n\r\n    };\r\n\r\n  }\r\n\r\n  html5_events = {\r\n\r\n    // HTML5 event-name-to-handler map\r\n\r\n    abort: html5_event(function() {\r\n\r\n      sm2._wD(this._s.id + ': abort');\r\n\r\n    }),\r\n\r\n    // enough has loaded to play\r\n\r\n    canplay: html5_event(function() {\r\n\r\n      var s = this._s,\r\n          position1K;\r\n\r\n      if (s._html5_canplay) {\r\n        // this event has already fired. ignore.\r\n        return;\r\n      }\r\n\r\n      s._html5_canplay = true;\r\n      sm2._wD(s.id + ': canplay');\r\n      s._onbufferchange(0);\r\n\r\n      // position according to instance options\r\n      position1K = (s._iO.position !== _undefined && !isNaN(s._iO.position) ? s._iO.position / msecScale : null);\r\n\r\n      // set the position if position was provided before the sound loaded\r\n      if (this.currentTime !== position1K) {\r\n        sm2._wD(s.id + ': canplay: Setting position to ' + position1K);\r\n        try {\r\n          this.currentTime = position1K;\r\n        } catch(ee) {\r\n          sm2._wD(s.id + ': canplay: Setting position of ' + position1K + ' failed: ' + ee.message, 2);\r\n        }\r\n      }\r\n\r\n      // hack for HTML5 from/to case\r\n      if (s._iO._oncanplay) {\r\n        s._iO._oncanplay();\r\n      }\r\n\r\n    }),\r\n\r\n    canplaythrough: html5_event(function() {\r\n\r\n      var s = this._s;\r\n\r\n      if (!s.loaded) {\r\n        s._onbufferchange(0);\r\n        s._whileloading(s.bytesLoaded, s.bytesTotal, s._get_html5_duration());\r\n        s._onload(true);\r\n      }\r\n\r\n    }),\r\n\r\n    durationchange: html5_event(function() {\r\n\r\n      // durationchange may fire at various times, probably the safest way to capture accurate/final duration.\r\n\r\n      var s = this._s,\r\n          duration;\r\n\r\n      duration = s._get_html5_duration();\r\n\r\n      if (!isNaN(duration) && duration !== s.duration) {\r\n\r\n        sm2._wD(this._s.id + ': durationchange (' + duration + ')' + (s.duration ? ', previously ' + s.duration : ''));\r\n\r\n        s.durationEstimate = s.duration = duration;\r\n\r\n      }\r\n\r\n    }),\r\n\r\n    // TODO: Reserved for potential use\r\n    /*\r\n    emptied: html5_event(function() {\r\n\r\n      sm2._wD(this._s.id + ': emptied');\r\n\r\n    }),\r\n    */\r\n\r\n    ended: html5_event(function() {\r\n\r\n      var s = this._s;\r\n\r\n      sm2._wD(s.id + ': ended');\r\n\r\n      s._onfinish();\r\n\r\n    }),\r\n\r\n    error: html5_event(function() {\r\n\r\n      var description = (html5ErrorCodes[this.error.code] || null);\r\n      sm2._wD(this._s.id + ': HTML5 error, code ' + this.error.code + (description ? ' (' + description + ')' : ''));\r\n      this._s._onload(false);\r\n      this._s._onerror(this.error.code, description);\r\n\r\n    }),\r\n\r\n    loadeddata: html5_event(function() {\r\n\r\n      var s = this._s;\r\n\r\n      sm2._wD(s.id + ': loadeddata');\r\n\r\n      // safari seems to nicely report progress events, eventually totalling 100%\r\n      if (!s._loaded && !isSafari) {\r\n        s.duration = s._get_html5_duration();\r\n      }\r\n\r\n    }),\r\n\r\n    loadedmetadata: html5_event(function() {\r\n\r\n      sm2._wD(this._s.id + ': loadedmetadata');\r\n\r\n    }),\r\n\r\n    loadstart: html5_event(function() {\r\n\r\n      sm2._wD(this._s.id + ': loadstart');\r\n      // assume buffering at first\r\n      this._s._onbufferchange(1);\r\n\r\n    }),\r\n\r\n    play: html5_event(function() {\r\n\r\n      // sm2._wD(this._s.id + ': play()');\r\n      // once play starts, no buffering\r\n      this._s._onbufferchange(0);\r\n\r\n    }),\r\n\r\n    playing: html5_event(function() {\r\n\r\n      sm2._wD(this._s.id + ': playing ' + String.fromCharCode(9835));\r\n      // once play starts, no buffering\r\n      this._s._onbufferchange(0);\r\n\r\n    }),\r\n\r\n    progress: html5_event(function(e) {\r\n\r\n      // note: can fire repeatedly after \"loaded\" event, due to use of HTTP range/partials\r\n\r\n      var s = this._s,\r\n          i, j, progStr, buffered = 0,\r\n          isProgress = (e.type === 'progress'),\r\n          ranges = e.target.buffered,\r\n          // firefox 3.6 implements e.loaded/total (bytes)\r\n          loaded = (e.loaded || 0),\r\n          total = (e.total || 1);\r\n\r\n      // reset the \"buffered\" (loaded byte ranges) array\r\n      s.buffered = [];\r\n\r\n      if (ranges && ranges.length) {\r\n\r\n        // if loaded is 0, try TimeRanges implementation as % of load\r\n        // https://developer.mozilla.org/en/DOM/TimeRanges\r\n\r\n        // re-build \"buffered\" array\r\n        // HTML5 returns seconds. SM2 API uses msec for setPosition() etc., whether Flash or HTML5.\r\n        for (i = 0, j = ranges.length; i < j; i++) {\r\n          s.buffered.push({\r\n            start: ranges.start(i) * msecScale,\r\n            end: ranges.end(i) * msecScale\r\n          });\r\n        }\r\n\r\n        // use the last value locally\r\n        buffered = (ranges.end(0) - ranges.start(0)) * msecScale;\r\n\r\n        // linear case, buffer sum; does not account for seeking and HTTP partials / byte ranges\r\n        loaded = Math.min(1, buffered / (e.target.duration * msecScale));\r\n\r\n        // <d>\r\n        if (isProgress && ranges.length > 1) {\r\n          progStr = [];\r\n          j = ranges.length;\r\n          for (i = 0; i < j; i++) {\r\n            progStr.push((e.target.buffered.start(i) * msecScale) + '-' + (e.target.buffered.end(i) * msecScale));\r\n          }\r\n          sm2._wD(this._s.id + ': progress, timeRanges: ' + progStr.join(', '));\r\n        }\r\n\r\n        if (isProgress && !isNaN(loaded)) {\r\n          sm2._wD(this._s.id + ': progress, ' + Math.floor(loaded * 100) + '% loaded');\r\n        }\r\n        // </d>\r\n\r\n      }\r\n\r\n      if (!isNaN(loaded)) {\r\n\r\n        // TODO: prevent calls with duplicate values.\r\n        s._whileloading(loaded, total, s._get_html5_duration());\r\n        if (loaded && total && loaded === total) {\r\n          // in case \"onload\" doesn't fire (eg. gecko 1.9.2)\r\n          html5_events.canplaythrough.call(this, e);\r\n        }\r\n\r\n      }\r\n\r\n    }),\r\n\r\n    ratechange: html5_event(function() {\r\n\r\n      sm2._wD(this._s.id + ': ratechange');\r\n\r\n    }),\r\n\r\n    suspend: html5_event(function(e) {\r\n\r\n      // download paused/stopped, may have finished (eg. onload)\r\n      var s = this._s;\r\n\r\n      sm2._wD(this._s.id + ': suspend');\r\n      html5_events.progress.call(this, e);\r\n      s._onsuspend();\r\n\r\n    }),\r\n\r\n    stalled: html5_event(function() {\r\n\r\n      sm2._wD(this._s.id + ': stalled');\r\n\r\n    }),\r\n\r\n    timeupdate: html5_event(function() {\r\n\r\n      this._s._onTimer();\r\n\r\n    }),\r\n\r\n    waiting: html5_event(function() {\r\n\r\n      var s = this._s;\r\n\r\n      // see also: seeking\r\n      sm2._wD(this._s.id + ': waiting');\r\n\r\n      // playback faster than download rate, etc.\r\n      s._onbufferchange(1);\r\n\r\n    })\r\n\r\n  };\r\n\r\n  html5OK = function(iO) {\r\n\r\n    // playability test based on URL or MIME type\r\n\r\n    var result;\r\n\r\n    if (!iO || (!iO.type && !iO.url && !iO.serverURL)) {\r\n\r\n      // nothing to check\r\n      result = false;\r\n\r\n    } else if (iO.serverURL || (iO.type && preferFlashCheck(iO.type))) {\r\n\r\n      // RTMP, or preferring flash\r\n      result = false;\r\n\r\n    } else {\r\n\r\n      // Use type, if specified. Pass data: URIs to HTML5. If HTML5-only mode, no other options, so just give 'er\r\n      result = ((iO.type ? html5CanPlay({ type: iO.type }) : html5CanPlay({ url: iO.url }) || sm2.html5Only || iO.url.match(/data:/i)));\r\n\r\n    }\r\n\r\n    return result;\r\n\r\n  };\r\n\r\n  html5Unload = function(oAudio) {\r\n\r\n    /**\r\n     * Internal method: Unload media, and cancel any current/pending network requests.\r\n     * Firefox can load an empty URL, which allegedly destroys the decoder and stops the download.\r\n     * https://developer.mozilla.org/En/Using_audio_and_video_in_Firefox#Stopping_the_download_of_media\r\n     * However, Firefox has been seen loading a relative URL from '' and thus requesting the hosting page on unload.\r\n     * Other UA behaviour is unclear, so everyone else gets an about:blank-style URL.\r\n     */\r\n\r\n    var url;\r\n\r\n    if (oAudio) {\r\n\r\n      // Firefox and Chrome accept short WAVe data: URIs. Chome dislikes audio/wav, but accepts audio/wav for data: MIME.\r\n      // Desktop Safari complains / fails on data: URI, so it gets about:blank.\r\n      url = (isSafari ? emptyURL : (sm2.html5.canPlayType('audio/wav') ? emptyWAV : emptyURL));\r\n\r\n      oAudio.src = url;\r\n\r\n      // reset some state, too\r\n      if (oAudio._called_unload !== _undefined) {\r\n        oAudio._called_load = false;\r\n      }\r\n\r\n    }\r\n\r\n    if (useGlobalHTML5Audio) {\r\n\r\n      // ensure URL state is trashed, also\r\n      lastGlobalHTML5URL = null;\r\n\r\n    }\r\n\r\n    return url;\r\n\r\n  };\r\n\r\n  html5CanPlay = function(o) {\r\n\r\n    /**\r\n     * Try to find MIME, test and return truthiness\r\n     * o = {\r\n     *  url: '/path/to/an.mp3',\r\n     *  type: 'audio/mp3'\r\n     * }\r\n     */\r\n\r\n    if (!sm2.useHTML5Audio || !sm2.hasHTML5) return false;\r\n\r\n    var url = (o.url || null),\r\n        mime = (o.type || null),\r\n        aF = sm2.audioFormats,\r\n        result,\r\n        offset,\r\n        fileExt,\r\n        item;\r\n\r\n    // account for known cases like audio/mp3\r\n\r\n    if (mime && sm2.html5[mime] !== _undefined) return (sm2.html5[mime] && !preferFlashCheck(mime));\r\n\r\n    if (!html5Ext) {\r\n\r\n      html5Ext = [];\r\n\r\n      for (item in aF) {\r\n\r\n        if (aF.hasOwnProperty(item)) {\r\n\r\n          html5Ext.push(item);\r\n\r\n          if (aF[item].related) {\r\n            html5Ext = html5Ext.concat(aF[item].related);\r\n          }\r\n\r\n        }\r\n\r\n      }\r\n\r\n      html5Ext = new RegExp('\\\\.(' + html5Ext.join('|') + ')(\\\\?.*)?$', 'i');\r\n\r\n    }\r\n\r\n    // TODO: Strip URL queries, etc.\r\n    fileExt = (url ? url.toLowerCase().match(html5Ext) : null);\r\n\r\n    if (!fileExt || !fileExt.length) {\r\n\r\n      if (!mime) {\r\n\r\n        result = false;\r\n\r\n      } else {\r\n\r\n        // audio/mp3 -> mp3, result should be known\r\n        offset = mime.indexOf(';');\r\n\r\n        // strip \"audio/X; codecs...\"\r\n        fileExt = (offset !== -1 ? mime.substr(0, offset) : mime).substr(6);\r\n\r\n      }\r\n\r\n    } else {\r\n\r\n      // match the raw extension name - \"mp3\", for example\r\n      fileExt = fileExt[1];\r\n\r\n    }\r\n\r\n    if (fileExt && sm2.html5[fileExt] !== _undefined) {\r\n\r\n      // result known\r\n      result = (sm2.html5[fileExt] && !preferFlashCheck(fileExt));\r\n\r\n    } else {\r\n\r\n      mime = 'audio/' + fileExt;\r\n      result = sm2.html5.canPlayType({ type: mime });\r\n\r\n      sm2.html5[fileExt] = result;\r\n\r\n      // sm2._wD('canPlayType, found result: ' + result);\r\n      result = (result && sm2.html5[mime] && !preferFlashCheck(mime));\r\n    }\r\n\r\n    return result;\r\n\r\n  };\r\n\r\n  testHTML5 = function() {\r\n\r\n    /**\r\n     * Internal: Iterates over audioFormats, determining support eg. audio/mp3, audio/mpeg and so on\r\n     * assigns results to html5[] and flash[].\r\n     */\r\n\r\n    if (!sm2.useHTML5Audio || !sm2.hasHTML5) {\r\n\r\n      // without HTML5, we need Flash.\r\n      sm2.html5.usingFlash = true;\r\n      needsFlash = true;\r\n\r\n      return false;\r\n\r\n    }\r\n\r\n    // double-whammy: Opera 9.64 throws WRONG_ARGUMENTS_ERR if no parameter passed to Audio(), and Webkit + iOS happily tries to load \"null\" as a URL. :/\r\n    var a = (Audio !== _undefined ? (isOpera && opera.version() < 10 ? new Audio(null) : new Audio()) : null),\r\n        item, lookup, support = {}, aF, i;\r\n\r\n    function cp(m) {\r\n\r\n      var canPlay, j,\r\n          result = false,\r\n          isOK = false;\r\n\r\n      if (!a || typeof a.canPlayType !== 'function') return result;\r\n\r\n      if (m instanceof Array) {\r\n\r\n        // iterate through all mime types, return any successes\r\n\r\n        for (i = 0, j = m.length; i < j; i++) {\r\n\r\n          if (sm2.html5[m[i]] || a.canPlayType(m[i]).match(sm2.html5Test)) {\r\n\r\n            isOK = true;\r\n            sm2.html5[m[i]] = true;\r\n\r\n            // note flash support, too\r\n            sm2.flash[m[i]] = !!(m[i].match(flashMIME));\r\n\r\n          }\r\n\r\n        }\r\n\r\n        result = isOK;\r\n\r\n      } else {\r\n\r\n        canPlay = (a && typeof a.canPlayType === 'function' ? a.canPlayType(m) : false);\r\n        result = !!(canPlay && (canPlay.match(sm2.html5Test)));\r\n\r\n      }\r\n\r\n      return result;\r\n\r\n    }\r\n\r\n    // test all registered formats + codecs\r\n\r\n    aF = sm2.audioFormats;\r\n\r\n    for (item in aF) {\r\n\r\n      if (aF.hasOwnProperty(item)) {\r\n\r\n        lookup = 'audio/' + item;\r\n\r\n        support[item] = cp(aF[item].type);\r\n\r\n        // write back generic type too, eg. audio/mp3\r\n        support[lookup] = support[item];\r\n\r\n        // assign flash\r\n        if (item.match(flashMIME)) {\r\n\r\n          sm2.flash[item] = true;\r\n          sm2.flash[lookup] = true;\r\n\r\n        } else {\r\n\r\n          sm2.flash[item] = false;\r\n          sm2.flash[lookup] = false;\r\n\r\n        }\r\n\r\n        // assign result to related formats, too\r\n\r\n        if (aF[item] && aF[item].related) {\r\n\r\n          for (i = aF[item].related.length - 1; i >= 0; i--) {\r\n\r\n            // eg. audio/m4a\r\n            support['audio/' + aF[item].related[i]] = support[item];\r\n            sm2.html5[aF[item].related[i]] = support[item];\r\n            sm2.flash[aF[item].related[i]] = support[item];\r\n\r\n          }\r\n\r\n        }\r\n\r\n      }\r\n\r\n    }\r\n\r\n    support.canPlayType = (a ? cp : null);\r\n    sm2.html5 = mixin(sm2.html5, support);\r\n\r\n    sm2.html5.usingFlash = featureCheck();\r\n    needsFlash = sm2.html5.usingFlash;\r\n\r\n    return true;\r\n\r\n  };\r\n\r\n  strings = {\r\n\r\n    // <d>\r\n    notReady: 'Unavailable - wait until onready() has fired.',\r\n    notOK: 'Audio support is not available.',\r\n    domError: sm + 'exception caught while appending SWF to DOM.',\r\n    spcWmode: 'Removing wmode, preventing known SWF loading issue(s)',\r\n    swf404: smc + 'Verify that %s is a valid path.',\r\n    tryDebug: 'Try ' + sm + '.debugFlash = true for more security details (output goes to SWF.)',\r\n    checkSWF: 'See SWF output for more debug info.',\r\n    localFail: smc + 'Non-HTTP page (' + doc.location.protocol + ' URL?) Review Flash player security settings for this special case:\\nhttp://www.macromedia.com/support/documentation/en/flashplayer/help/settings_manager04.html\\nMay need to add/allow path, eg. c:/sm2/ or /users/me/sm2/',\r\n    waitFocus: smc + 'Special case: Waiting for SWF to load with window focus...',\r\n    waitForever: smc + 'Waiting indefinitely for Flash (will recover if unblocked)...',\r\n    waitSWF: smc + 'Waiting for 100% SWF load...',\r\n    needFunction: smc + 'Function object expected for %s',\r\n    badID: 'Sound ID \"%s\" should be a string, starting with a non-numeric character',\r\n    currentObj: smc + '_debug(): Current sound objects',\r\n    waitOnload: smc + 'Waiting for window.onload()',\r\n    docLoaded: smc + 'Document already loaded',\r\n    onload: smc + 'initComplete(): calling soundManager.onload()',\r\n    onloadOK: sm + '.onload() complete',\r\n    didInit: smc + 'init(): Already called?',\r\n    secNote: 'Flash security note: Network/internet URLs will not load due to security restrictions. Access can be configured via Flash Player Global Security Settings Page: http://www.macromedia.com/support/documentation/en/flashplayer/help/settings_manager04.html',\r\n    badRemove: smc + 'Failed to remove Flash node.',\r\n    shutdown: sm + '.disable(): Shutting down',\r\n    queue: smc + 'Queueing %s handler',\r\n    smError: 'SMSound.load(): Exception: JS-Flash communication failed, or JS error.',\r\n    fbTimeout: 'No flash response, applying .' + swfCSS.swfTimedout + ' CSS...',\r\n    fbLoaded: 'Flash loaded',\r\n    fbHandler: smc + 'flashBlockHandler()',\r\n    manURL: 'SMSound.load(): Using manually-assigned URL',\r\n    onURL: sm + '.load(): current URL already assigned.',\r\n    badFV: sm + '.flashVersion must be 8 or 9. \"%s\" is invalid. Reverting to %s.',\r\n    as2loop: 'Note: Setting stream:false so looping can work (flash 8 limitation)',\r\n    noNSLoop: 'Note: Looping not implemented for MovieStar formats',\r\n    needfl9: 'Note: Switching to flash 9, required for MP4 formats.',\r\n    mfTimeout: 'Setting flashLoadTimeout = 0 (infinite) for off-screen, mobile flash case',\r\n    needFlash: smc + 'Fatal error: Flash is needed to play some required formats, but is not available.',\r\n    gotFocus: smc + 'Got window focus.',\r\n    policy: 'Enabling usePolicyFile for data access',\r\n    setup: sm + '.setup(): allowed parameters: %s',\r\n    setupError: sm + '.setup(): \"%s\" cannot be assigned with this method.',\r\n    setupUndef: sm + '.setup(): Could not find option \"%s\"',\r\n    setupLate: sm + '.setup(): url, flashVersion and html5Test property changes will not take effect until reboot().',\r\n    noURL: smc + 'Flash URL required. Call soundManager.setup({url:...}) to get started.',\r\n    sm2Loaded: 'SoundManager 2: Ready. ' + String.fromCharCode(10003),\r\n    reset: sm + '.reset(): Removing event callbacks',\r\n    mobileUA: 'Mobile UA detected, preferring HTML5 by default.',\r\n    globalHTML5: 'Using singleton HTML5 Audio() pattern for this device.',\r\n    ignoreMobile: 'Ignoring mobile restrictions for this device.'\r\n    // </d>\r\n\r\n  };\r\n\r\n  str = function() {\r\n\r\n    // internal string replace helper.\r\n    // arguments: o [,items to replace]\r\n    // <d>\r\n\r\n    var args,\r\n        i, j, o,\r\n        sstr;\r\n\r\n    // real array, please\r\n    args = slice.call(arguments);\r\n\r\n    // first argument\r\n    o = args.shift();\r\n\r\n    sstr = (strings && strings[o] ? strings[o] : '');\r\n\r\n    if (sstr && args && args.length) {\r\n      for (i = 0, j = args.length; i < j; i++) {\r\n        sstr = sstr.replace('%s', args[i]);\r\n      }\r\n    }\r\n\r\n    return sstr;\r\n    // </d>\r\n\r\n  };\r\n\r\n  loopFix = function(sOpt) {\r\n\r\n    // flash 8 requires stream = false for looping to work\r\n    if (fV === 8 && sOpt.loops > 1 && sOpt.stream) {\r\n      _wDS('as2loop');\r\n      sOpt.stream = false;\r\n    }\r\n\r\n    return sOpt;\r\n\r\n  };\r\n\r\n  policyFix = function(sOpt, sPre) {\r\n\r\n    if (sOpt && !sOpt.usePolicyFile && (sOpt.onid3 || sOpt.usePeakData || sOpt.useWaveformData || sOpt.useEQData)) {\r\n      sm2._wD((sPre || '') + str('policy'));\r\n      sOpt.usePolicyFile = true;\r\n    }\r\n\r\n    return sOpt;\r\n\r\n  };\r\n\r\n  complain = function(sMsg) {\r\n\r\n    // <d>\r\n    if (hasConsole && console.warn !== _undefined) {\r\n      console.warn(sMsg);\r\n    } else {\r\n      sm2._wD(sMsg);\r\n    }\r\n    // </d>\r\n\r\n  };\r\n\r\n  doNothing = function() {\r\n\r\n    return false;\r\n\r\n  };\r\n\r\n  disableObject = function(o) {\r\n\r\n    var oProp;\r\n\r\n    for (oProp in o) {\r\n      if (o.hasOwnProperty(oProp) && typeof o[oProp] === 'function') {\r\n        o[oProp] = doNothing;\r\n      }\r\n    }\r\n\r\n    oProp = null;\r\n\r\n  };\r\n\r\n  failSafely = function(bNoDisable) {\r\n\r\n    // general failure exception handler\r\n\r\n    if (bNoDisable === _undefined) {\r\n      bNoDisable = false;\r\n    }\r\n\r\n    if (disabled || bNoDisable) {\r\n      sm2.disable(bNoDisable);\r\n    }\r\n\r\n  };\r\n\r\n  normalizeMovieURL = function(movieURL) {\r\n\r\n    var urlParams = null, url;\r\n\r\n    if (movieURL) {\r\n\r\n      if (movieURL.match(/\\.swf(\\?.*)?$/i)) {\r\n\r\n        urlParams = movieURL.substr(movieURL.toLowerCase().lastIndexOf('.swf?') + 4);\r\n\r\n        // assume user knows what they're doing\r\n        if (urlParams) return movieURL;\r\n\r\n      } else if (movieURL.lastIndexOf('/') !== movieURL.length - 1) {\r\n\r\n        // append trailing slash, if needed\r\n        movieURL += '/';\r\n\r\n      }\r\n\r\n    }\r\n\r\n    url = (movieURL && movieURL.lastIndexOf('/') !== -1 ? movieURL.substr(0, movieURL.lastIndexOf('/') + 1) : './') + sm2.movieURL;\r\n\r\n    if (sm2.noSWFCache) {\r\n      url += ('?ts=' + new Date().getTime());\r\n    }\r\n\r\n    return url;\r\n\r\n  };\r\n\r\n  setVersionInfo = function() {\r\n\r\n    // short-hand for internal use\r\n\r\n    fV = parseInt(sm2.flashVersion, 10);\r\n\r\n    if (fV !== 8 && fV !== 9) {\r\n      sm2._wD(str('badFV', fV, defaultFlashVersion));\r\n      sm2.flashVersion = fV = defaultFlashVersion;\r\n    }\r\n\r\n    // debug flash movie, if applicable\r\n\r\n    var isDebug = (sm2.debugMode || sm2.debugFlash ? '_debug.swf' : '.swf');\r\n\r\n    if (sm2.useHTML5Audio && !sm2.html5Only && sm2.audioFormats.mp4.required && fV < 9) {\r\n      sm2._wD(str('needfl9'));\r\n      sm2.flashVersion = fV = 9;\r\n    }\r\n\r\n    sm2.version = sm2.versionNumber + (sm2.html5Only ? ' (HTML5-only mode)' : (fV === 9 ? ' (AS3/Flash 9)' : ' (AS2/Flash 8)'));\r\n\r\n    // set up default options\r\n    if (fV > 8) {\r\n\r\n      // +flash 9 base options\r\n      sm2.defaultOptions = mixin(sm2.defaultOptions, sm2.flash9Options);\r\n      sm2.features.buffering = true;\r\n\r\n      // +moviestar support\r\n      sm2.defaultOptions = mixin(sm2.defaultOptions, sm2.movieStarOptions);\r\n      sm2.filePatterns.flash9 = new RegExp('\\\\.(mp3|' + netStreamTypes.join('|') + ')(\\\\?.*)?$', 'i');\r\n      sm2.features.movieStar = true;\r\n\r\n    } else {\r\n\r\n      sm2.features.movieStar = false;\r\n\r\n    }\r\n\r\n    // regExp for flash canPlay(), etc.\r\n    sm2.filePattern = sm2.filePatterns[(fV !== 8 ? 'flash9' : 'flash8')];\r\n\r\n    // if applicable, use _debug versions of SWFs\r\n    sm2.movieURL = (fV === 8 ? 'soundmanager2.swf' : 'soundmanager2_flash9.swf').replace('.swf', isDebug);\r\n\r\n    sm2.features.peakData = sm2.features.waveformData = sm2.features.eqData = (fV > 8);\r\n\r\n  };\r\n\r\n  setPolling = function(bPolling, bHighPerformance) {\r\n\r\n    if (!flash) {\r\n      return;\r\n    }\r\n\r\n    flash._setPolling(bPolling, bHighPerformance);\r\n\r\n  };\r\n\r\n  initDebug = function() {\r\n\r\n    // starts debug mode, creating output <div> for UAs without console object\r\n\r\n    // allow force of debug mode via URL\r\n    // <d>\r\n    if (sm2.debugURLParam.test(wl)) {\r\n      sm2.setupOptions.debugMode = sm2.debugMode = true;\r\n    }\r\n\r\n    if (id(sm2.debugID)) {\r\n      return;\r\n    }\r\n\r\n    var oD, oDebug, oTarget, oToggle, tmp;\r\n\r\n    if (sm2.debugMode && !id(sm2.debugID) && (!hasConsole || !sm2.useConsole || !sm2.consoleOnly)) {\r\n\r\n      oD = doc.createElement('div');\r\n      oD.id = sm2.debugID + '-toggle';\r\n\r\n      oToggle = {\r\n        position: 'fixed',\r\n        bottom: '0px',\r\n        right: '0px',\r\n        width: '1.2em',\r\n        height: '1.2em',\r\n        lineHeight: '1.2em',\r\n        margin: '2px',\r\n        textAlign: 'center',\r\n        border: '1px solid #999',\r\n        cursor: 'pointer',\r\n        background: '#fff',\r\n        color: '#333',\r\n        zIndex: 10001\r\n      };\r\n\r\n      oD.appendChild(doc.createTextNode('-'));\r\n      oD.onclick = toggleDebug;\r\n      oD.title = 'Toggle SM2 debug console';\r\n\r\n      if (ua.match(/msie 6/i)) {\r\n        oD.style.position = 'absolute';\r\n        oD.style.cursor = 'hand';\r\n      }\r\n\r\n      for (tmp in oToggle) {\r\n        if (oToggle.hasOwnProperty(tmp)) {\r\n          oD.style[tmp] = oToggle[tmp];\r\n        }\r\n      }\r\n\r\n      oDebug = doc.createElement('div');\r\n      oDebug.id = sm2.debugID;\r\n      oDebug.style.display = (sm2.debugMode ? 'block' : 'none');\r\n\r\n      if (sm2.debugMode && !id(oD.id)) {\r\n        try {\r\n          oTarget = getDocument();\r\n          oTarget.appendChild(oD);\r\n        } catch(e2) {\r\n          throw new Error(str('domError') + ' \\n' + e2.toString());\r\n        }\r\n        oTarget.appendChild(oDebug);\r\n      }\r\n\r\n    }\r\n\r\n    oTarget = null;\r\n    // </d>\r\n\r\n  };\r\n\r\n  idCheck = this.getSoundById;\r\n\r\n  // <d>\r\n  _wDS = function(o, errorLevel) {\r\n\r\n    return (!o ? '' : sm2._wD(str(o), errorLevel));\r\n\r\n  };\r\n\r\n  toggleDebug = function() {\r\n\r\n    var o = id(sm2.debugID),\r\n    oT = id(sm2.debugID + '-toggle');\r\n\r\n    if (!o) {\r\n      return;\r\n    }\r\n\r\n    if (debugOpen) {\r\n      // minimize\r\n      oT.innerHTML = '+';\r\n      o.style.display = 'none';\r\n    } else {\r\n      oT.innerHTML = '-';\r\n      o.style.display = 'block';\r\n    }\r\n\r\n    debugOpen = !debugOpen;\r\n\r\n  };\r\n\r\n  debugTS = function(sEventType, bSuccess, sMessage) {\r\n\r\n    // troubleshooter debug hooks\r\n\r\n    if (window.sm2Debugger !== _undefined) {\r\n      try {\r\n        sm2Debugger.handleEvent(sEventType, bSuccess, sMessage);\r\n      } catch(e) {\r\n        // oh well\r\n        return false;\r\n      }\r\n    }\r\n\r\n    return true;\r\n\r\n  };\r\n  // </d>\r\n\r\n  getSWFCSS = function() {\r\n\r\n    var css = [];\r\n\r\n    if (sm2.debugMode) {\r\n      css.push(swfCSS.sm2Debug);\r\n    }\r\n\r\n    if (sm2.debugFlash) {\r\n      css.push(swfCSS.flashDebug);\r\n    }\r\n\r\n    if (sm2.useHighPerformance) {\r\n      css.push(swfCSS.highPerf);\r\n    }\r\n\r\n    return css.join(' ');\r\n\r\n  };\r\n\r\n  flashBlockHandler = function() {\r\n\r\n    // *possible* flash block situation.\r\n\r\n    var name = str('fbHandler'),\r\n        p = sm2.getMoviePercent(),\r\n        css = swfCSS,\r\n        error = {\r\n          type: 'FLASHBLOCK'\r\n        };\r\n\r\n    if (sm2.html5Only) {\r\n      // no flash, or unused\r\n      return;\r\n    }\r\n\r\n    if (!sm2.ok()) {\r\n\r\n      if (needsFlash) {\r\n        // make the movie more visible, so user can fix\r\n        sm2.oMC.className = getSWFCSS() + ' ' + css.swfDefault + ' ' + (p === null ? css.swfTimedout : css.swfError);\r\n        sm2._wD(name + ': ' + str('fbTimeout') + (p ? ' (' + str('fbLoaded') + ')' : ''));\r\n      }\r\n\r\n      sm2.didFlashBlock = true;\r\n\r\n      // fire onready(), complain lightly\r\n      processOnEvents({\r\n        type: 'ontimeout',\r\n        ignoreInit: true,\r\n        error: error\r\n      });\r\n\r\n      catchError(error);\r\n\r\n    } else {\r\n\r\n      // SM2 loaded OK (or recovered)\r\n\r\n      // <d>\r\n      if (sm2.didFlashBlock) {\r\n        sm2._wD(name + ': Unblocked');\r\n      }\r\n      // </d>\r\n\r\n      if (sm2.oMC) {\r\n        sm2.oMC.className = [getSWFCSS(), css.swfDefault, css.swfLoaded + (sm2.didFlashBlock ? ' ' + css.swfUnblocked : '')].join(' ');\r\n      }\r\n\r\n    }\r\n\r\n  };\r\n\r\n  addOnEvent = function(sType, oMethod, oScope) {\r\n\r\n    if (on_queue[sType] === _undefined) {\r\n      on_queue[sType] = [];\r\n    }\r\n\r\n    on_queue[sType].push({\r\n      method: oMethod,\r\n      scope: (oScope || null),\r\n      fired: false\r\n    });\r\n\r\n  };\r\n\r\n  processOnEvents = function(oOptions) {\r\n\r\n    // if unspecified, assume OK/error\r\n\r\n    if (!oOptions) {\r\n      oOptions = {\r\n        type: (sm2.ok() ? 'onready' : 'ontimeout')\r\n      };\r\n    }\r\n\r\n    // not ready yet.\r\n    if (!didInit && oOptions && !oOptions.ignoreInit) return false;\r\n\r\n    // invalid case\r\n    if (oOptions.type === 'ontimeout' && (sm2.ok() || (disabled && !oOptions.ignoreInit))) return false;\r\n\r\n    var status = {\r\n          success: (oOptions && oOptions.ignoreInit ? sm2.ok() : !disabled)\r\n        },\r\n\r\n        // queue specified by type, or none\r\n        srcQueue = (oOptions && oOptions.type ? on_queue[oOptions.type] || [] : []),\r\n\r\n        queue = [], i, j,\r\n        args = [status],\r\n        canRetry = (needsFlash && !sm2.ok());\r\n\r\n    if (oOptions.error) {\r\n      args[0].error = oOptions.error;\r\n    }\r\n\r\n    for (i = 0, j = srcQueue.length; i < j; i++) {\r\n      if (srcQueue[i].fired !== true) {\r\n        queue.push(srcQueue[i]);\r\n      }\r\n    }\r\n\r\n    if (queue.length) {\r\n\r\n      // sm2._wD(sm + ': Firing ' + queue.length + ' ' + oOptions.type + '() item' + (queue.length === 1 ? '' : 's'));\r\n      for (i = 0, j = queue.length; i < j; i++) {\r\n\r\n        if (queue[i].scope) {\r\n          queue[i].method.apply(queue[i].scope, args);\r\n        } else {\r\n          queue[i].method.apply(this, args);\r\n        }\r\n\r\n        if (!canRetry) {\r\n          // useFlashBlock and SWF timeout case doesn't count here.\r\n          queue[i].fired = true;\r\n\r\n        }\r\n\r\n      }\r\n\r\n    }\r\n\r\n    return true;\r\n\r\n  };\r\n\r\n  initUserOnload = function() {\r\n\r\n    window.setTimeout(function() {\r\n\r\n      if (sm2.useFlashBlock) {\r\n        flashBlockHandler();\r\n      }\r\n\r\n      processOnEvents();\r\n\r\n      // call user-defined \"onload\", scoped to window\r\n\r\n      if (typeof sm2.onload === 'function') {\r\n        _wDS('onload', 1);\r\n        sm2.onload.apply(window);\r\n        _wDS('onloadOK', 1);\r\n      }\r\n\r\n      if (sm2.waitForWindowLoad) {\r\n        event.add(window, 'load', initUserOnload);\r\n      }\r\n\r\n    }, 1);\r\n\r\n  };\r\n\r\n  detectFlash = function() {\r\n\r\n    /**\r\n     * Hat tip: Flash Detect library (BSD, (C) 2007) by Carl \"DocYes\" S. Yestrau\r\n     * http://featureblend.com/javascript-flash-detection-library.html / http://featureblend.com/license.txt\r\n     */\r\n\r\n    // this work has already been done.\r\n    if (hasFlash !== _undefined) return hasFlash;\r\n\r\n    var hasPlugin = false, n = navigator, obj, type, types, AX = window.ActiveXObject;\r\n\r\n    // MS Edge 14 throws an \"Unspecified Error\" because n.plugins is inaccessible due to permissions\r\n    var nP;\r\n\r\n    try {\r\n      nP = n.plugins;\r\n    } catch(e) {\r\n      nP = undefined;\r\n    }\r\n\r\n    if (nP && nP.length) {\r\n\r\n      type = 'application/x-shockwave-flash';\r\n      types = n.mimeTypes;\r\n\r\n      if (types && types[type] && types[type].enabledPlugin && types[type].enabledPlugin.description) {\r\n        hasPlugin = true;\r\n      }\r\n\r\n    } else if (AX !== _undefined && !ua.match(/MSAppHost/i)) {\r\n\r\n      // Windows 8 Store Apps (MSAppHost) are weird (compatibility?) and won't complain here, but will barf if Flash/ActiveX object is appended to the DOM.\r\n      try {\r\n        obj = new AX('ShockwaveFlash.ShockwaveFlash');\r\n      } catch(e) {\r\n        // oh well\r\n        obj = null;\r\n      }\r\n\r\n      hasPlugin = (!!obj);\r\n\r\n      // cleanup, because it is ActiveX after all\r\n      obj = null;\r\n\r\n    }\r\n\r\n    hasFlash = hasPlugin;\r\n\r\n    return hasPlugin;\r\n\r\n  };\r\n\r\n  featureCheck = function() {\r\n\r\n    var flashNeeded,\r\n        item,\r\n        formats = sm2.audioFormats,\r\n        // iPhone <= 3.1 has broken HTML5 audio(), but firmware 3.2 (original iPad) + iOS4 works.\r\n        isSpecial = (is_iDevice && !!(ua.match(/os (1|2|3_0|3_1)\\s/i)));\r\n\r\n    if (isSpecial) {\r\n\r\n      // has Audio(), but is broken; let it load links directly.\r\n      sm2.hasHTML5 = false;\r\n\r\n      // ignore flash case, however\r\n      sm2.html5Only = true;\r\n\r\n      // hide the SWF, if present\r\n      if (sm2.oMC) {\r\n        sm2.oMC.style.display = 'none';\r\n      }\r\n\r\n    } else if (sm2.useHTML5Audio) {\r\n\r\n        if (!sm2.html5 || !sm2.html5.canPlayType) {\r\n          sm2._wD('SoundManager: No HTML5 Audio() support detected.');\r\n          sm2.hasHTML5 = false;\r\n        }\r\n\r\n        // <d>\r\n        if (isBadSafari) {\r\n          sm2._wD(smc + 'Note: Buggy HTML5 Audio in Safari on this OS X release, see https://bugs.webkit.org/show_bug.cgi?id=32159 - ' + (!hasFlash ? ' would use flash fallback for MP3/MP4, but none detected.' : 'will use flash fallback for MP3/MP4, if available'), 1);\r\n        }\r\n        // </d>\r\n\r\n      }\r\n\r\n    if (sm2.useHTML5Audio && sm2.hasHTML5) {\r\n\r\n      // sort out whether flash is optional, required or can be ignored.\r\n\r\n      // innocent until proven guilty.\r\n      canIgnoreFlash = true;\r\n\r\n      for (item in formats) {\r\n\r\n        if (formats.hasOwnProperty(item)) {\r\n\r\n          if (formats[item].required) {\r\n\r\n            if (!sm2.html5.canPlayType(formats[item].type)) {\r\n\r\n              // 100% HTML5 mode is not possible.\r\n              canIgnoreFlash = false;\r\n              flashNeeded = true;\r\n\r\n            } else if (sm2.preferFlash && (sm2.flash[item] || sm2.flash[formats[item].type])) {\r\n\r\n              // flash may be required, or preferred for this format.\r\n              flashNeeded = true;\r\n\r\n            }\r\n\r\n          }\r\n\r\n        }\r\n\r\n      }\r\n\r\n    }\r\n\r\n    // sanity check...\r\n    if (sm2.ignoreFlash) {\r\n      flashNeeded = false;\r\n      canIgnoreFlash = true;\r\n    }\r\n\r\n    sm2.html5Only = (sm2.hasHTML5 && sm2.useHTML5Audio && !flashNeeded);\r\n\r\n    return (!sm2.html5Only);\r\n\r\n  };\r\n\r\n  parseURL = function(url) {\r\n\r\n    /**\r\n     * Internal: Finds and returns the first playable URL (or failing that, the first URL.)\r\n     * @param {string or array} url A single URL string, OR, an array of URL strings or {url:'/path/to/resource', type:'audio/mp3'} objects.\r\n     */\r\n\r\n    var i, j, urlResult = 0, result;\r\n\r\n    if (url instanceof Array) {\r\n\r\n      // find the first good one\r\n      for (i = 0, j = url.length; i < j; i++) {\r\n\r\n        if (url[i] instanceof Object) {\r\n\r\n          // MIME check\r\n          if (sm2.canPlayMIME(url[i].type)) {\r\n            urlResult = i;\r\n            break;\r\n          }\r\n\r\n        } else if (sm2.canPlayURL(url[i])) {\r\n\r\n          // URL string check\r\n          urlResult = i;\r\n          break;\r\n\r\n        }\r\n\r\n      }\r\n\r\n      // normalize to string\r\n      if (url[urlResult].url) {\r\n        url[urlResult] = url[urlResult].url;\r\n      }\r\n\r\n      result = url[urlResult];\r\n\r\n    } else {\r\n\r\n      // single URL case\r\n      result = url;\r\n\r\n    }\r\n\r\n    return result;\r\n\r\n  };\r\n\r\n\r\n  startTimer = function(oSound) {\r\n\r\n    /**\r\n     * attach a timer to this sound, and start an interval if needed\r\n     */\r\n\r\n    if (!oSound._hasTimer) {\r\n\r\n      oSound._hasTimer = true;\r\n\r\n      if (!mobileHTML5 && sm2.html5PollingInterval) {\r\n\r\n        if (h5IntervalTimer === null && h5TimerCount === 0) {\r\n\r\n          h5IntervalTimer = setInterval(timerExecute, sm2.html5PollingInterval);\r\n\r\n        }\r\n\r\n        h5TimerCount++;\r\n\r\n      }\r\n\r\n    }\r\n\r\n  };\r\n\r\n  stopTimer = function(oSound) {\r\n\r\n    /**\r\n     * detach a timer\r\n     */\r\n\r\n    if (oSound._hasTimer) {\r\n\r\n      oSound._hasTimer = false;\r\n\r\n      if (!mobileHTML5 && sm2.html5PollingInterval) {\r\n\r\n        // interval will stop itself at next execution.\r\n\r\n        h5TimerCount--;\r\n\r\n      }\r\n\r\n    }\r\n\r\n  };\r\n\r\n  timerExecute = function() {\r\n\r\n    /**\r\n     * manual polling for HTML5 progress events, ie., whileplaying()\r\n     * (can achieve greater precision than conservative default HTML5 interval)\r\n     */\r\n\r\n    var i;\r\n\r\n    if (h5IntervalTimer !== null && !h5TimerCount) {\r\n\r\n      // no active timers, stop polling interval.\r\n\r\n      clearInterval(h5IntervalTimer);\r\n\r\n      h5IntervalTimer = null;\r\n\r\n      return;\r\n\r\n    }\r\n\r\n    // check all HTML5 sounds with timers\r\n\r\n    for (i = sm2.soundIDs.length - 1; i >= 0; i--) {\r\n\r\n      if (sm2.sounds[sm2.soundIDs[i]].isHTML5 && sm2.sounds[sm2.soundIDs[i]]._hasTimer) {\r\n        sm2.sounds[sm2.soundIDs[i]]._onTimer();\r\n      }\r\n\r\n    }\r\n\r\n  };\r\n\r\n  catchError = function(options) {\r\n\r\n    options = (options !== _undefined ? options : {});\r\n\r\n    if (typeof sm2.onerror === 'function') {\r\n      sm2.onerror.apply(window, [{\r\n        type: (options.type !== _undefined ? options.type : null)\r\n      }]);\r\n    }\r\n\r\n    if (options.fatal !== _undefined && options.fatal) {\r\n      sm2.disable();\r\n    }\r\n\r\n  };\r\n\r\n  badSafariFix = function() {\r\n\r\n    // special case: \"bad\" Safari (OS X 10.3 - 10.7) must fall back to flash for MP3/MP4\r\n    if (!isBadSafari || !detectFlash()) {\r\n      // doesn't apply\r\n      return;\r\n    }\r\n\r\n    var aF = sm2.audioFormats, i, item;\r\n\r\n    for (item in aF) {\r\n\r\n      if (aF.hasOwnProperty(item)) {\r\n\r\n        if (item === 'mp3' || item === 'mp4') {\r\n\r\n          sm2._wD(sm + ': Using flash fallback for ' + item + ' format');\r\n          sm2.html5[item] = false;\r\n\r\n          // assign result to related formats, too\r\n          if (aF[item] && aF[item].related) {\r\n            for (i = aF[item].related.length - 1; i >= 0; i--) {\r\n              sm2.html5[aF[item].related[i]] = false;\r\n            }\r\n          }\r\n\r\n        }\r\n\r\n      }\r\n\r\n    }\r\n\r\n  };\r\n\r\n  /**\r\n   * Pseudo-private flash/ExternalInterface methods\r\n   * ----------------------------------------------\r\n   */\r\n\r\n  this._setSandboxType = function(sandboxType) {\r\n\r\n    // <d>\r\n    // Security sandbox according to Flash plugin\r\n    var sb = sm2.sandbox;\r\n\r\n    sb.type = sandboxType;\r\n    sb.description = sb.types[(sb.types[sandboxType] !== _undefined ? sandboxType : 'unknown')];\r\n\r\n    if (sb.type === 'localWithFile') {\r\n\r\n      sb.noRemote = true;\r\n      sb.noLocal = false;\r\n      _wDS('secNote', 2);\r\n\r\n    } else if (sb.type === 'localWithNetwork') {\r\n\r\n      sb.noRemote = false;\r\n      sb.noLocal = true;\r\n\r\n    } else if (sb.type === 'localTrusted') {\r\n\r\n      sb.noRemote = false;\r\n      sb.noLocal = false;\r\n\r\n    }\r\n    // </d>\r\n\r\n  };\r\n\r\n  this._externalInterfaceOK = function(swfVersion) {\r\n\r\n    // flash callback confirming flash loaded, EI working etc.\r\n    // swfVersion: SWF build string\r\n\r\n    if (sm2.swfLoaded) {\r\n      return;\r\n    }\r\n\r\n    var e;\r\n\r\n    debugTS('swf', true);\r\n    debugTS('flashtojs', true);\r\n    sm2.swfLoaded = true;\r\n    tryInitOnFocus = false;\r\n\r\n    if (isBadSafari) {\r\n      badSafariFix();\r\n    }\r\n\r\n    // complain if JS + SWF build/version strings don't match, excluding +DEV builds\r\n    // <d>\r\n    if (!swfVersion || swfVersion.replace(/\\+dev/i, '') !== sm2.versionNumber.replace(/\\+dev/i, '')) {\r\n\r\n      e = sm + ': Fatal: JavaScript file build \"' + sm2.versionNumber + '\" does not match Flash SWF build \"' + swfVersion + '\" at ' + sm2.url + '. Ensure both are up-to-date.';\r\n\r\n      // escape flash -> JS stack so this error fires in window.\r\n      setTimeout(function() {\r\n        throw new Error(e);\r\n      }, 0);\r\n\r\n      // exit, init will fail with timeout\r\n      return;\r\n\r\n    }\r\n    // </d>\r\n\r\n    // IE needs a larger timeout\r\n    setTimeout(init, isIE ? 100 : 1);\r\n\r\n  };\r\n\r\n  /**\r\n   * Private initialization helpers\r\n   * ------------------------------\r\n   */\r\n\r\n  createMovie = function(movieID, movieURL) {\r\n\r\n    // ignore if already connected\r\n    if (didAppend && appendSuccess) return false;\r\n\r\n    function initMsg() {\r\n\r\n      // <d>\r\n\r\n      var options = [],\r\n          title,\r\n          msg = [],\r\n          delimiter = ' + ';\r\n\r\n      title = 'SoundManager ' + sm2.version + (!sm2.html5Only && sm2.useHTML5Audio ? (sm2.hasHTML5 ? ' + HTML5 audio' : ', no HTML5 audio support') : '');\r\n\r\n      if (!sm2.html5Only) {\r\n\r\n        if (sm2.preferFlash) {\r\n          options.push('preferFlash');\r\n        }\r\n\r\n        if (sm2.useHighPerformance) {\r\n          options.push('useHighPerformance');\r\n        }\r\n\r\n        if (sm2.flashPollingInterval) {\r\n          options.push('flashPollingInterval (' + sm2.flashPollingInterval + 'ms)');\r\n        }\r\n\r\n        if (sm2.html5PollingInterval) {\r\n          options.push('html5PollingInterval (' + sm2.html5PollingInterval + 'ms)');\r\n        }\r\n\r\n        if (sm2.wmode) {\r\n          options.push('wmode (' + sm2.wmode + ')');\r\n        }\r\n\r\n        if (sm2.debugFlash) {\r\n          options.push('debugFlash');\r\n        }\r\n\r\n        if (sm2.useFlashBlock) {\r\n          options.push('flashBlock');\r\n        }\r\n\r\n      } else if (sm2.html5PollingInterval) {\r\n          options.push('html5PollingInterval (' + sm2.html5PollingInterval + 'ms)');\r\n        }\r\n\r\n      if (options.length) {\r\n        msg = msg.concat([options.join(delimiter)]);\r\n      }\r\n\r\n      sm2._wD(title + (msg.length ? delimiter + msg.join(', ') : ''), 1);\r\n\r\n      showSupport();\r\n\r\n      // </d>\r\n\r\n    }\r\n\r\n    if (sm2.html5Only) {\r\n\r\n      // 100% HTML5 mode\r\n      setVersionInfo();\r\n\r\n      initMsg();\r\n      sm2.oMC = id(sm2.movieID);\r\n      init();\r\n\r\n      // prevent multiple init attempts\r\n      didAppend = true;\r\n\r\n      appendSuccess = true;\r\n\r\n      return false;\r\n\r\n    }\r\n\r\n    // flash path\r\n    var remoteURL = (movieURL || sm2.url),\r\n    localURL = (sm2.altURL || remoteURL),\r\n    swfTitle = 'JS/Flash audio component (SoundManager 2)',\r\n    oTarget = getDocument(),\r\n    extraClass = getSWFCSS(),\r\n    isRTL = null,\r\n    html = doc.getElementsByTagName('html')[0],\r\n    oEmbed, oMovie, tmp, movieHTML, oEl, s, x, sClass;\r\n\r\n    isRTL = (html && html.dir && html.dir.match(/rtl/i));\r\n    movieID = (movieID === _undefined ? sm2.id : movieID);\r\n\r\n    function param(name, value) {\r\n      return '<param name=\"' + name + '\" value=\"' + value + '\" />';\r\n    }\r\n\r\n    // safety check for legacy (change to Flash 9 URL)\r\n    setVersionInfo();\r\n    sm2.url = normalizeMovieURL(overHTTP ? remoteURL : localURL);\r\n    movieURL = sm2.url;\r\n\r\n    sm2.wmode = (!sm2.wmode && sm2.useHighPerformance ? 'transparent' : sm2.wmode);\r\n\r\n    if (sm2.wmode !== null && (ua.match(/msie 8/i) || (!isIE && !sm2.useHighPerformance)) && navigator.platform.match(/win32|win64/i)) {\r\n      /**\r\n       * extra-special case: movie doesn't load until scrolled into view when using wmode = anything but 'window' here\r\n       * does not apply when using high performance (position:fixed means on-screen), OR infinite flash load timeout\r\n       * wmode breaks IE 8 on Vista + Win7 too in some cases, as of January 2011 (?)\r\n       */\r\n      messages.push(strings.spcWmode);\r\n      sm2.wmode = null;\r\n    }\r\n\r\n    oEmbed = {\r\n      name: movieID,\r\n      id: movieID,\r\n      src: movieURL,\r\n      quality: 'high',\r\n      allowScriptAccess: sm2.allowScriptAccess,\r\n      bgcolor: sm2.bgColor,\r\n      pluginspage: http + 'www.macromedia.com/go/getflashplayer',\r\n      title: swfTitle,\r\n      type: 'application/x-shockwave-flash',\r\n      wmode: sm2.wmode,\r\n      // http://help.adobe.com/en_US/as3/mobile/WS4bebcd66a74275c36cfb8137124318eebc6-7ffd.html\r\n      hasPriority: 'true'\r\n    };\r\n\r\n    if (sm2.debugFlash) {\r\n      oEmbed.FlashVars = 'debug=1';\r\n    }\r\n\r\n    if (!sm2.wmode) {\r\n      // don't write empty attribute\r\n      delete oEmbed.wmode;\r\n    }\r\n\r\n    if (isIE) {\r\n\r\n      // IE is \"special\".\r\n      oMovie = doc.createElement('div');\r\n      movieHTML = [\r\n        '<object id=\"' + movieID + '\" data=\"' + movieURL + '\" type=\"' + oEmbed.type + '\" title=\"' + oEmbed.title + '\" classid=\"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000\" codebase=\"http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=6,0,40,0\">',\r\n        param('movie', movieURL),\r\n        param('AllowScriptAccess', sm2.allowScriptAccess),\r\n        param('quality', oEmbed.quality),\r\n        (sm2.wmode ? param('wmode', sm2.wmode) : ''),\r\n        param('bgcolor', sm2.bgColor),\r\n        param('hasPriority', 'true'),\r\n        (sm2.debugFlash ? param('FlashVars', oEmbed.FlashVars) : ''),\r\n        '</object>'\r\n      ].join('');\r\n\r\n    } else {\r\n\r\n      oMovie = doc.createElement('embed');\r\n      for (tmp in oEmbed) {\r\n        if (oEmbed.hasOwnProperty(tmp)) {\r\n          oMovie.setAttribute(tmp, oEmbed[tmp]);\r\n        }\r\n      }\r\n\r\n    }\r\n\r\n    initDebug();\r\n    extraClass = getSWFCSS();\r\n    oTarget = getDocument();\r\n\r\n    if (oTarget) {\r\n\r\n      sm2.oMC = (id(sm2.movieID) || doc.createElement('div'));\r\n\r\n      if (!sm2.oMC.id) {\r\n\r\n        sm2.oMC.id = sm2.movieID;\r\n        sm2.oMC.className = swfCSS.swfDefault + ' ' + extraClass;\r\n        s = null;\r\n        oEl = null;\r\n\r\n        if (!sm2.useFlashBlock) {\r\n          if (sm2.useHighPerformance) {\r\n            // on-screen at all times\r\n            s = {\r\n              position: 'fixed',\r\n              width: '8px',\r\n              height: '8px',\r\n              // >= 6px for flash to run fast, >= 8px to start up under Firefox/win32 in some cases. odd? yes.\r\n              bottom: '0px',\r\n              left: '0px',\r\n              overflow: 'hidden'\r\n            };\r\n          } else {\r\n            // hide off-screen, lower priority\r\n            s = {\r\n              position: 'absolute',\r\n              width: '6px',\r\n              height: '6px',\r\n              top: '-9999px',\r\n              left: '-9999px'\r\n            };\r\n            if (isRTL) {\r\n              s.left = Math.abs(parseInt(s.left, 10)) + 'px';\r\n            }\r\n          }\r\n        }\r\n\r\n        if (isWebkit) {\r\n          // soundcloud-reported render/crash fix, safari 5\r\n          sm2.oMC.style.zIndex = 10000;\r\n        }\r\n\r\n        if (!sm2.debugFlash) {\r\n          for (x in s) {\r\n            if (s.hasOwnProperty(x)) {\r\n              sm2.oMC.style[x] = s[x];\r\n            }\r\n          }\r\n        }\r\n\r\n        try {\r\n\r\n          if (!isIE) {\r\n            sm2.oMC.appendChild(oMovie);\r\n          }\r\n\r\n          oTarget.appendChild(sm2.oMC);\r\n\r\n          if (isIE) {\r\n            oEl = sm2.oMC.appendChild(doc.createElement('div'));\r\n            oEl.className = swfCSS.swfBox;\r\n            oEl.innerHTML = movieHTML;\r\n          }\r\n\r\n          appendSuccess = true;\r\n\r\n        } catch(e) {\r\n\r\n          throw new Error(str('domError') + ' \\n' + e.toString());\r\n\r\n        }\r\n\r\n      } else {\r\n\r\n        // SM2 container is already in the document (eg. flashblock use case)\r\n        sClass = sm2.oMC.className;\r\n        sm2.oMC.className = (sClass ? sClass + ' ' : swfCSS.swfDefault) + (extraClass ? ' ' + extraClass : '');\r\n        sm2.oMC.appendChild(oMovie);\r\n\r\n        if (isIE) {\r\n          oEl = sm2.oMC.appendChild(doc.createElement('div'));\r\n          oEl.className = swfCSS.swfBox;\r\n          oEl.innerHTML = movieHTML;\r\n        }\r\n\r\n        appendSuccess = true;\r\n\r\n      }\r\n\r\n    }\r\n\r\n    didAppend = true;\r\n\r\n    initMsg();\r\n\r\n    // sm2._wD(sm + ': Trying to load ' + movieURL + (!overHTTP && sm2.altURL ? ' (alternate URL)' : ''), 1);\r\n\r\n    return true;\r\n\r\n  };\r\n\r\n  initMovie = function() {\r\n\r\n    if (sm2.html5Only) {\r\n      createMovie();\r\n      return false;\r\n    }\r\n\r\n    // attempt to get, or create, movie (may already exist)\r\n    if (flash) return false;\r\n\r\n    if (!sm2.url) {\r\n\r\n      /**\r\n       * Something isn't right - we've reached init, but the soundManager url property has not been set.\r\n       * User has not called setup({url: ...}), or has not set soundManager.url (legacy use case) directly before init time.\r\n       * Notify and exit. If user calls setup() with a url: property, init will be restarted as in the deferred loading case.\r\n       */\r\n\r\n       _wDS('noURL');\r\n       return false;\r\n\r\n    }\r\n\r\n    // inline markup case\r\n    flash = sm2.getMovie(sm2.id);\r\n\r\n    if (!flash) {\r\n\r\n      if (!oRemoved) {\r\n\r\n        // try to create\r\n        createMovie(sm2.id, sm2.url);\r\n\r\n      } else {\r\n\r\n        // try to re-append removed movie after reboot()\r\n        if (!isIE) {\r\n          sm2.oMC.appendChild(oRemoved);\r\n        } else {\r\n          sm2.oMC.innerHTML = oRemovedHTML;\r\n        }\r\n\r\n        oRemoved = null;\r\n        didAppend = true;\r\n\r\n      }\r\n\r\n      flash = sm2.getMovie(sm2.id);\r\n\r\n    }\r\n\r\n    if (typeof sm2.oninitmovie === 'function') {\r\n      setTimeout(sm2.oninitmovie, 1);\r\n    }\r\n\r\n    // <d>\r\n    flushMessages();\r\n    // </d>\r\n\r\n    return true;\r\n\r\n  };\r\n\r\n  delayWaitForEI = function() {\r\n\r\n    setTimeout(waitForEI, 1000);\r\n\r\n  };\r\n\r\n  rebootIntoHTML5 = function() {\r\n\r\n    // special case: try for a reboot with preferFlash: false, if 100% HTML5 mode is possible and useFlashBlock is not enabled.\r\n\r\n    window.setTimeout(function() {\r\n\r\n      complain(smc + 'useFlashBlock is false, 100% HTML5 mode is possible. Rebooting with preferFlash: false...');\r\n\r\n      sm2.setup({\r\n        preferFlash: false\r\n      }).reboot();\r\n\r\n      // if for some reason you want to detect this case, use an ontimeout() callback and look for html5Only and didFlashBlock == true.\r\n      sm2.didFlashBlock = true;\r\n\r\n      sm2.beginDelayedInit();\r\n\r\n    }, 1);\r\n\r\n  };\r\n\r\n  waitForEI = function() {\r\n\r\n    var p,\r\n        loadIncomplete = false;\r\n\r\n    if (!sm2.url) {\r\n      // No SWF url to load (noURL case) - exit for now. Will be retried when url is set.\r\n      return;\r\n    }\r\n\r\n    if (waitingForEI) {\r\n      return;\r\n    }\r\n\r\n    waitingForEI = true;\r\n    event.remove(window, 'load', delayWaitForEI);\r\n\r\n    if (hasFlash && tryInitOnFocus && !isFocused) {\r\n      // Safari won't load flash in background tabs, only when focused.\r\n      _wDS('waitFocus');\r\n      return;\r\n    }\r\n\r\n    if (!didInit) {\r\n      p = sm2.getMoviePercent();\r\n      if (p > 0 && p < 100) {\r\n        loadIncomplete = true;\r\n      }\r\n    }\r\n\r\n    setTimeout(function() {\r\n\r\n      p = sm2.getMoviePercent();\r\n\r\n      if (loadIncomplete) {\r\n        // special case: if movie *partially* loaded, retry until it's 100% before assuming failure.\r\n        waitingForEI = false;\r\n        sm2._wD(str('waitSWF'));\r\n        window.setTimeout(delayWaitForEI, 1);\r\n        return;\r\n      }\r\n\r\n      // <d>\r\n      if (!didInit) {\r\n\r\n        sm2._wD(sm + ': No Flash response within expected time. Likely causes: ' + (p === 0 ? 'SWF load failed, ' : '') + 'Flash blocked or JS-Flash security error.' + (sm2.debugFlash ? ' ' + str('checkSWF') : ''), 2);\r\n\r\n        if (!overHTTP && p) {\r\n\r\n          _wDS('localFail', 2);\r\n\r\n          if (!sm2.debugFlash) {\r\n            _wDS('tryDebug', 2);\r\n          }\r\n\r\n        }\r\n\r\n        if (p === 0) {\r\n\r\n          // if 0 (not null), probably a 404.\r\n          sm2._wD(str('swf404', sm2.url), 1);\r\n\r\n        }\r\n\r\n        debugTS('flashtojs', false, ': Timed out' + (overHTTP ? ' (Check flash security or flash blockers)' : ' (No plugin/missing SWF?)'));\r\n\r\n      }\r\n      // </d>\r\n\r\n      // give up / time-out, depending\r\n\r\n      if (!didInit && okToDisable) {\r\n\r\n        if (p === null) {\r\n\r\n          // SWF failed to report load progress. Possibly blocked.\r\n\r\n          if (sm2.useFlashBlock || sm2.flashLoadTimeout === 0) {\r\n\r\n            if (sm2.useFlashBlock) {\r\n\r\n              flashBlockHandler();\r\n\r\n            }\r\n\r\n            _wDS('waitForever');\r\n\r\n          } else if (!sm2.useFlashBlock && canIgnoreFlash) {\r\n\r\n            // no custom flash block handling, but SWF has timed out. Will recover if user unblocks / allows SWF load.\r\n            rebootIntoHTML5();\r\n\r\n          } else {\r\n\r\n            _wDS('waitForever');\r\n\r\n            // fire any regular registered ontimeout() listeners.\r\n            processOnEvents({\r\n              type: 'ontimeout',\r\n              ignoreInit: true,\r\n              error: {\r\n                type: 'INIT_FLASHBLOCK'\r\n              }\r\n            });\r\n\r\n          }\r\n\r\n        } else if (sm2.flashLoadTimeout === 0) {\r\n\r\n          // SWF loaded? Shouldn't be a blocking issue, then.\r\n\r\n          _wDS('waitForever');\r\n\r\n        } else if (!sm2.useFlashBlock && canIgnoreFlash) {\r\n\r\n          rebootIntoHTML5();\r\n\r\n        } else {\r\n\r\n          failSafely(true);\r\n\r\n        }\r\n\r\n      }\r\n\r\n    }, sm2.flashLoadTimeout);\r\n\r\n  };\r\n\r\n  handleFocus = function() {\r\n\r\n    function cleanup() {\r\n      event.remove(window, 'focus', handleFocus);\r\n    }\r\n\r\n    if (isFocused || !tryInitOnFocus) {\r\n      // already focused, or not special Safari background tab case\r\n      cleanup();\r\n      return true;\r\n    }\r\n\r\n    okToDisable = true;\r\n    isFocused = true;\r\n    _wDS('gotFocus');\r\n\r\n    // allow init to restart\r\n    waitingForEI = false;\r\n\r\n    // kick off ExternalInterface timeout, now that the SWF has started\r\n    delayWaitForEI();\r\n\r\n    cleanup();\r\n    return true;\r\n\r\n  };\r\n\r\n  flushMessages = function() {\r\n\r\n    // <d>\r\n\r\n    // SM2 pre-init debug messages\r\n    if (messages.length) {\r\n      sm2._wD('SoundManager 2: ' + messages.join(' '), 1);\r\n      messages = [];\r\n    }\r\n\r\n    // </d>\r\n\r\n  };\r\n\r\n  showSupport = function() {\r\n\r\n    // <d>\r\n\r\n    flushMessages();\r\n\r\n    var item, tests = [];\r\n\r\n    if (sm2.useHTML5Audio && sm2.hasHTML5) {\r\n      for (item in sm2.audioFormats) {\r\n        if (sm2.audioFormats.hasOwnProperty(item)) {\r\n          tests.push(item + ' = ' + sm2.html5[item] + (!sm2.html5[item] && needsFlash && sm2.flash[item] ? ' (using flash)' : (sm2.preferFlash && sm2.flash[item] && needsFlash ? ' (preferring flash)' : (!sm2.html5[item] ? ' (' + (sm2.audioFormats[item].required ? 'required, ' : '') + 'and no flash support)' : ''))));\r\n        }\r\n      }\r\n      sm2._wD('SoundManager 2 HTML5 support: ' + tests.join(', '), 1);\r\n    }\r\n\r\n    // </d>\r\n\r\n  };\r\n\r\n  initComplete = function(bNoDisable) {\r\n\r\n    if (didInit) return false;\r\n\r\n    if (sm2.html5Only) {\r\n      // all good.\r\n      _wDS('sm2Loaded', 1);\r\n      didInit = true;\r\n      initUserOnload();\r\n      debugTS('onload', true);\r\n      return true;\r\n    }\r\n\r\n    var wasTimeout = (sm2.useFlashBlock && sm2.flashLoadTimeout && !sm2.getMoviePercent()),\r\n        result = true,\r\n        error;\r\n\r\n    if (!wasTimeout) {\r\n      didInit = true;\r\n    }\r\n\r\n    error = {\r\n      type: (!hasFlash && needsFlash ? 'NO_FLASH' : 'INIT_TIMEOUT')\r\n    };\r\n\r\n    sm2._wD('SoundManager 2 ' + (disabled ? 'failed to load' : 'loaded') + ' (' + (disabled ? 'Flash security/load error' : 'OK') + ') ' + String.fromCharCode(disabled ? 10006 : 10003), disabled ? 2 : 1);\r\n\r\n    if (disabled || bNoDisable) {\r\n\r\n      if (sm2.useFlashBlock && sm2.oMC) {\r\n        sm2.oMC.className = getSWFCSS() + ' ' + (sm2.getMoviePercent() === null ? swfCSS.swfTimedout : swfCSS.swfError);\r\n      }\r\n\r\n      processOnEvents({\r\n        type: 'ontimeout',\r\n        error: error,\r\n        ignoreInit: true\r\n      });\r\n\r\n      debugTS('onload', false);\r\n      catchError(error);\r\n\r\n      result = false;\r\n\r\n    } else {\r\n\r\n      debugTS('onload', true);\r\n\r\n    }\r\n\r\n    if (!disabled) {\r\n\r\n      if (sm2.waitForWindowLoad && !windowLoaded) {\r\n\r\n        _wDS('waitOnload');\r\n        event.add(window, 'load', initUserOnload);\r\n\r\n      } else {\r\n\r\n        // <d>\r\n        if (sm2.waitForWindowLoad && windowLoaded) {\r\n          _wDS('docLoaded');\r\n        }\r\n        // </d>\r\n\r\n        initUserOnload();\r\n\r\n      }\r\n\r\n    }\r\n\r\n    return result;\r\n\r\n  };\r\n\r\n  /**\r\n   * apply top-level setupOptions object as local properties, eg., this.setupOptions.flashVersion -> this.flashVersion (soundManager.flashVersion)\r\n   * this maintains backward compatibility, and allows properties to be defined separately for use by soundManager.setup().\r\n   */\r\n\r\n  setProperties = function() {\r\n\r\n    var i,\r\n        o = sm2.setupOptions;\r\n\r\n    for (i in o) {\r\n\r\n      if (o.hasOwnProperty(i)) {\r\n\r\n        // assign local property if not already defined\r\n\r\n        if (sm2[i] === _undefined) {\r\n\r\n          sm2[i] = o[i];\r\n\r\n        } else if (sm2[i] !== o[i]) {\r\n\r\n          // legacy support: write manually-assigned property (eg., soundManager.url) back to setupOptions to keep things in sync\r\n          sm2.setupOptions[i] = sm2[i];\r\n\r\n        }\r\n\r\n      }\r\n\r\n    }\r\n\r\n  };\r\n\r\n\r\n  init = function() {\r\n\r\n    // called after onload()\r\n\r\n    if (didInit) {\r\n      _wDS('didInit');\r\n      return false;\r\n    }\r\n\r\n    function cleanup() {\r\n      event.remove(window, 'load', sm2.beginDelayedInit);\r\n    }\r\n\r\n    if (sm2.html5Only) {\r\n\r\n      if (!didInit) {\r\n        // we don't need no steenking flash!\r\n        cleanup();\r\n        sm2.enabled = true;\r\n        initComplete();\r\n      }\r\n\r\n      return true;\r\n\r\n    }\r\n\r\n    // flash path\r\n    initMovie();\r\n\r\n    try {\r\n\r\n      // attempt to talk to Flash\r\n      flash._externalInterfaceTest(false);\r\n\r\n      /**\r\n       * Apply user-specified polling interval, OR, if \"high performance\" set, faster vs. default polling\r\n       * (determines frequency of whileloading/whileplaying callbacks, effectively driving UI framerates)\r\n       */\r\n      setPolling(true, (sm2.flashPollingInterval || (sm2.useHighPerformance ? 10 : 50)));\r\n\r\n      if (!sm2.debugMode) {\r\n        // stop the SWF from making debug output calls to JS\r\n        flash._disableDebug();\r\n      }\r\n\r\n      sm2.enabled = true;\r\n      debugTS('jstoflash', true);\r\n\r\n      if (!sm2.html5Only) {\r\n        // prevent browser from showing cached page state (or rather, restoring \"suspended\" page state) via back button, because flash may be dead\r\n        // http://www.webkit.org/blog/516/webkit-page-cache-ii-the-unload-event/\r\n        event.add(window, 'unload', doNothing);\r\n      }\r\n\r\n    } catch(e) {\r\n\r\n      sm2._wD('js/flash exception: ' + e.toString());\r\n\r\n      debugTS('jstoflash', false);\r\n\r\n      catchError({\r\n        type: 'JS_TO_FLASH_EXCEPTION',\r\n        fatal: true\r\n      });\r\n\r\n      // don't disable, for reboot()\r\n      failSafely(true);\r\n\r\n      initComplete();\r\n\r\n      return false;\r\n\r\n    }\r\n\r\n    initComplete();\r\n\r\n    // disconnect events\r\n    cleanup();\r\n\r\n    return true;\r\n\r\n  };\r\n\r\n  domContentLoaded = function() {\r\n\r\n    if (didDCLoaded) return false;\r\n\r\n    didDCLoaded = true;\r\n\r\n    // assign top-level soundManager properties eg. soundManager.url\r\n    setProperties();\r\n\r\n    initDebug();\r\n\r\n    if (!hasFlash && sm2.hasHTML5) {\r\n\r\n      sm2._wD('SoundManager 2: No Flash detected' + (!sm2.useHTML5Audio ? ', enabling HTML5.' : '. Trying HTML5-only mode.'), 1);\r\n\r\n      sm2.setup({\r\n        useHTML5Audio: true,\r\n        // make sure we aren't preferring flash, either\r\n        // TODO: preferFlash should not matter if flash is not installed. Currently, stuff breaks without the below tweak.\r\n        preferFlash: false\r\n      });\r\n\r\n    }\r\n\r\n    testHTML5();\r\n\r\n    if (!hasFlash && needsFlash) {\r\n\r\n      messages.push(strings.needFlash);\r\n\r\n      // TODO: Fatal here vs. timeout approach, etc.\r\n      // hack: fail sooner.\r\n      sm2.setup({\r\n        flashLoadTimeout: 1\r\n      });\r\n\r\n    }\r\n\r\n    if (doc.removeEventListener) {\r\n      doc.removeEventListener('DOMContentLoaded', domContentLoaded, false);\r\n    }\r\n\r\n    initMovie();\r\n\r\n    return true;\r\n\r\n  };\r\n\r\n  domContentLoadedIE = function() {\r\n\r\n    if (doc.readyState === 'complete') {\r\n      domContentLoaded();\r\n      doc.detachEvent('onreadystatechange', domContentLoadedIE);\r\n    }\r\n\r\n    return true;\r\n\r\n  };\r\n\r\n  winOnLoad = function() {\r\n\r\n    // catch edge case of initComplete() firing after window.load()\r\n    windowLoaded = true;\r\n\r\n    // catch case where DOMContentLoaded has been sent, but we're still in doc.readyState = 'interactive'\r\n    domContentLoaded();\r\n\r\n    event.remove(window, 'load', winOnLoad);\r\n\r\n  };\r\n\r\n  // sniff up-front\r\n  detectFlash();\r\n\r\n  // focus and window load, init (primarily flash-driven)\r\n  event.add(window, 'focus', handleFocus);\r\n  event.add(window, 'load', delayWaitForEI);\r\n  event.add(window, 'load', winOnLoad);\r\n\r\n  if (doc.addEventListener) {\r\n\r\n    doc.addEventListener('DOMContentLoaded', domContentLoaded, false);\r\n\r\n  } else if (doc.attachEvent) {\r\n\r\n    doc.attachEvent('onreadystatechange', domContentLoadedIE);\r\n\r\n  } else {\r\n\r\n    // no add/attachevent support - safe to assume no JS -> Flash either\r\n    debugTS('onload', false);\r\n    catchError({\r\n      type: 'NO_DOM2_EVENTS',\r\n      fatal: true\r\n    });\r\n\r\n  }\r\n\r\n} // SoundManager()\r\n\r\n// SM2_DEFER details: http://www.schillmania.com/projects/soundmanager2/doc/getstarted/#lazy-loading\r\n\r\nif (window.SM2_DEFER === _undefined || !SM2_DEFER) {\r\n  soundManager = new SoundManager();\r\n}\r\n\r\n/**\r\n * SoundManager public interfaces\r\n * ------------------------------\r\n */\r\n\r\nif (typeof module === 'object' && module && typeof module.exports === 'object') {\r\n\r\n  /**\r\n   * commonJS module\r\n   */\r\n\r\n  module.exports.SoundManager = SoundManager;\r\n  module.exports.soundManager = soundManager;\r\n\r\n} else if (typeof define === 'function' && define.amd) {\r\n\r\n  /**\r\n   * AMD - requireJS\r\n   * basic usage:\r\n   * require([\"/path/to/soundmanager2.js\"], function(SoundManager) {\r\n   *   SoundManager.getInstance().setup({\r\n   *     url: '/swf/',\r\n   *     onready: function() { ... }\r\n   *   })\r\n   * });\r\n   *\r\n   * SM2_DEFER usage:\r\n   * window.SM2_DEFER = true;\r\n   * require([\"/path/to/soundmanager2.js\"], function(SoundManager) {\r\n   *   SoundManager.getInstance(function() {\r\n   *     var soundManager = new SoundManager.constructor();\r\n   *     soundManager.setup({\r\n   *       url: '/swf/',\r\n   *       ...\r\n   *     });\r\n   *     ...\r\n   *     soundManager.beginDelayedInit();\r\n   *     return soundManager;\r\n   *   })\r\n   * });\r\n   */\r\n\r\n  define(function() {\r\n    /**\r\n     * Retrieve the global instance of SoundManager.\r\n     * If a global instance does not exist it can be created using a callback.\r\n     *\r\n     * @param {Function} smBuilder Optional: Callback used to create a new SoundManager instance\r\n     * @return {SoundManager} The global SoundManager instance\r\n     */\r\n    function getInstance(smBuilder) {\r\n      if (!window.soundManager && smBuilder instanceof Function) {\r\n        var instance = smBuilder(SoundManager);\r\n        if (instance instanceof SoundManager) {\r\n          window.soundManager = instance;\r\n        }\r\n      }\r\n      return window.soundManager;\r\n    }\r\n    return {\r\n      constructor: SoundManager,\r\n      getInstance: getInstance\r\n    };\r\n  });\r\n\r\n}\r\n\r\n// standard browser case\r\n\r\n// constructor\r\nwindow.SoundManager = SoundManager;\r\n\r\n/**\r\n * note: SM2 requires a window global due to Flash, which makes calls to window.soundManager.\r\n * Flash may not always be needed, but this is not known until async init and SM2 may even \"reboot\" into Flash mode.\r\n */\r\n\r\n// public API, flash callbacks etc.\r\nwindow.soundManager = soundManager;\r\n\r\n}(window));"
	}
});